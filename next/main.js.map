{"version":3,"file":"main.js","mappings":"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","sources":["./apps/ide-ui/src/app/app.component.ts","./apps/ide-ui/src/app/app.component.html","./apps/ide-ui/src/app/app.module.ts","./apps/ide-ui/src/app/layout/layout.module.ts","./apps/ide-ui/src/app/layout/main/main.component.ts","./apps/ide-ui/src/app/layout/main/main.component.html","./apps/ide-ui/src/app/layout/menu/menu.component.ts","./apps/ide-ui/src/app/layout/menu/menu.component.html","./apps/ide-ui/src/app/routes/dev/dev.module.ts","./apps/ide-ui/src/app/routes/dev/list-changes/list-changes.component.ts","./apps/ide-ui/src/app/routes/dev/list-changes/list-changes.component.html","./apps/ide-ui/src/app/routes/editor/editor-element.ts","./apps/ide-ui/src/app/routes/editor/editor.module.ts","./apps/ide-ui/src/app/routes/editor/input-element/input-element.component.ts","./apps/ide-ui/src/app/routes/editor/input-element/input-element.component.html","./apps/ide-ui/src/app/routes/editor/main-editor/main-editor.component.ts","./apps/ide-ui/src/app/routes/editor/main-editor/main-editor.component.html","./apps/ide-ui/src/app/routes/editor/select-element/select-element.component.ts","./apps/ide-ui/src/app/routes/editor/select-element/select-element.component.html","./apps/ide-ui/src/app/routes/editor/sub-text-element/sub-text-element.component.ts","./apps/ide-ui/src/app/routes/editor/sub-text-element/sub-text-element.component.html","./apps/ide-ui/src/app/routes/editor/text-element/text-element.component.ts","./apps/ide-ui/src/app/routes/editor/text-element/text-element.component.html","./apps/ide-ui/src/app/routes/editor/text-handler/text-handler.component.ts","./apps/ide-ui/src/app/routes/editor/text-handler/text-handler.component.html","./apps/ide-ui/src/app/routes/welcome/main/welcome.component.ts","./apps/ide-ui/src/app/routes/welcome/main/welcome.component.html","./apps/ide-ui/src/app/routes/welcome/welcome.module.ts","./apps/ide-ui/src/app/shared/change/change.module.ts","./apps/ide-ui/src/app/shared/change/services/change-listen.service.ts","./apps/ide-ui/src/app/shared/change/services/change-update.service.ts","./apps/ide-ui/src/app/shared/pipes/locale-desc.pipe.ts","./apps/ide-ui/src/app/shared/pipes/locale.pipe.ts","./apps/ide-ui/src/app/shared/pipes/type-of.pipe.ts","./apps/ide-ui/src/app/shared/project/IdeProject.ts","./apps/ide-ui/src/app/shared/project/services/project.service.ts","./apps/ide-ui/src/app/shared/shared.module.ts","./apps/ide-ui/src/app/shared/text/services/locale.service.ts","./apps/ide-ui/src/app/shared/text/services/text.service.ts","./apps/ide-ui/src/app/shared/text/text.module.ts","./apps/ide-ui/src/environments/environment.next.ts","./apps/ide-ui/src/main.ts","ignored|/home/runner/work/monorepo/monorepo/common/temp/node_modules/.pnpm/all-country-data@1.0.4/node_modules/all-country-data/dist|zlib","../../libs/core/packages/core/src/lib/model/dont-code-schema-item.ts","../../libs/core/packages/core/src/lib/model/dont-code-model.ts","../../libs/core/packages/core/src/lib/model/dont-code-schema.ts","../../libs/core/packages/core/src/lib/model/dont-code-schema-manager.ts","../../libs/core/packages/core/src/lib/plugin/dont-code-plugin-manager.ts","../../libs/core/packages/core/src/lib/plugin/preview/dont-code-preview-manager.ts","../../libs/core/packages/core/src/lib/globals.ts","../../libs/core/packages/core/src/lib/store/dont-code-store-manager.ts","../../libs/core/packages/core/src/lib/change/change.ts","../../libs/core/packages/core/src/lib/action/action.ts","../../libs/core/packages/core/src/lib/model/dont-code-model-manager.ts","../../libs/core/packages/core/src/lib/change/dont-code-change-manager.ts","../../libs/core/packages/core/src/lib/dontcode.ts","../../libs/core/packages/core/src/lib/message/message.ts","../../libs/core/packages/core/src/lib/model/money-amount.ts","../../libs/core/packages/core/src/lib/plugin/action-handler.ts","../../libs/core/packages/core/src/lib/store/store-provider-helper.ts","../../libs/core/packages/core/src/lib/store/dont-code-store-provider.ts","../../libs/core/packages/core/src/lib/test/dont-code-test-manager.ts","../../libs/core/packages/core/src/lib/project/dont-code-project.ts","../../libs/ng-common/libs/common/src/lib/common-config/common-config.service.ts","../../libs/ng-common/libs/common/src/lib/common-config/common-lib-config.ts","../../libs/ng-common/libs/common/src/lib/common-dynamic/component-loader.service.ts","../../libs/ng-common/libs/common/src/lib/common-global/globals.ts","../../libs/ng-common/libs/common/src/lib/common-handler/abstract-plugin-handler.ts","../../libs/ng-common/libs/common/src/lib/common-handler/plugin-handler-helper.ts","../../libs/ng-common/libs/common/src/lib/common-storage/entity-store.service.ts","../../libs/ng-common/libs/common/src/lib/common-ui/abstract-dynamic-component.ts","../../libs/ng-common/libs/common/src/lib/common-ui/abstract-dynamic-loader-component.ts","../../libs/ng-common/libs/common/src/lib/common-ui/abstract-reference.component.ts","../../libs/ng-common/libs/common/src/lib/common-ui/abstract-reference.component.html","../../libs/ng-common/libs/common/src/lib/common-ui/dynamic-event.ts","../../libs/ng-common/libs/common/src/lib/common-ui/pipes/beautifier.pipe.ts","../../libs/ng-common/libs/common/src/lib/common-ui/plugin-base.component.ts","../../libs/ng-common/libs/common/src/lib/common-ui/template-list.ts","../../libs/ng-common/libs/common/src/lib/common-values/value.service.ts","../../libs/ng-common/libs/common/src/lib/plugin-common.module.ts","../../libs/ng-sandbox/libs/sandbox/src/lib/layout/app/LightAppComponent.ts","../../plugins/commerce/libs/commerce/src/lib/commerce.module.ts","../../plugins/commerce/libs/commerce/src/lib/declaration/commerce-plugin.ts","../../plugins/commerce/libs/commerce/src/lib/preview/price/price-compare.component.ts","../../plugins/commerce/libs/commerce/src/lib/preview/price/price-compare.component.html","../../plugins/commerce/libs/commerce/src/lib/preview/price/price.component.ts","../../plugins/commerce/libs/commerce/src/lib/preview/price/price.component.html","../../plugins/commerce/libs/commerce/src/lib/preview/shop/shop-handler.component.ts","../../plugins/commerce/libs/commerce/src/lib/preview/shop/shop-handler.component.html","../../plugins/commerce/libs/commerce/src/lib/preview/shop/shop-type-handler.component.ts","../../plugins/commerce/libs/commerce/src/lib/preview/shop/shop-type-handler.component.html","../../plugins/commerce/libs/commerce/src/lib/shared/dynamic-proxy-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/online-shop-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/scrappers/amazon-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/scrappers/boulanger-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/scrappers/cdiscount-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/scrappers/darty-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/scrappers/easy-para-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/scrappers/fnac-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/scrappers/greenweez-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/scrappers/maxicoffee-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/scrappers/new-pharma-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/scrappers/onatera-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/scrappers/web-ecologie-scrapper.ts","../../plugins/commerce/libs/commerce/src/lib/shared/services/price-finder.service.ts","../../plugins/commerce/libs/commerce/src/lib/shared/ui/product-selection.component.ts","../../plugins/commerce/libs/commerce/src/lib/shared/ui/product-selection.component.html","../../plugins/report/libs/report/src/lib/declaration/report-plugin.ts","../../plugins/report/libs/report/src/lib/preview/cross-data-transformer.ts","../../plugins/report/libs/report/src/lib/preview/graph-data-transformer.ts","../../plugins/report/libs/report/src/lib/preview/report-display/report-display.component.ts","../../plugins/report/libs/report/src/lib/preview/report-display/report-display.component.html","../../plugins/report/libs/report/src/lib/preview/report-entity/report-entity.component.ts","../../plugins/report/libs/report/src/lib/preview/report-entity/report-entity.component.html","../../plugins/report/libs/report/src/lib/preview/report-table/report-table.component.ts","../../plugins/report/libs/report/src/lib/preview/report-table/report-table.component.html","../../plugins/report/libs/report/src/lib/report.module.ts","../../plugins/rest/libs/rest/src/lib/declaration/rest-plugin.ts","../../plugins/rest/libs/rest/src/lib/preview/source/rest-store-provider.ts","../../plugins/rest/libs/rest/src/lib/preview/source/source-handler.ts","../../plugins/rest/libs/rest/src/lib/rest.module.ts","../../plugins/standard/libs/std/src/lib/basic.module.ts","../../plugins/standard/libs/std/src/lib/declaration/basic-plugin.ts","../../plugins/standard/libs/std/src/lib/declaration/fields-plugin.ts","../../plugins/standard/libs/std/src/lib/fields.module.ts","../../plugins/standard/libs/std/src/lib/preview/country/country.component.ts","../../plugins/standard/libs/std/src/lib/preview/country/country.component.html","../../plugins/standard/libs/std/src/lib/preview/currency/currency.component.ts","../../plugins/standard/libs/std/src/lib/preview/currency/currency.component.html","../../plugins/standard/libs/std/src/lib/preview/entity/basic-entity.component.ts","../../plugins/standard/libs/std/src/lib/preview/entity/basic-entity.component.html","../../plugins/standard/libs/std/src/lib/preview/entity/edit-entity.component.ts","../../plugins/standard/libs/std/src/lib/preview/entity/edit-entity.component.html","../../plugins/standard/libs/std/src/lib/preview/entity/list-entity.component.ts","../../plugins/standard/libs/std/src/lib/preview/entity/list-entity.component.html","../../plugins/standard/libs/std/src/lib/preview/fields/basic-fields.component.ts","../../plugins/standard/libs/std/src/lib/preview/fields/basic-fields.component.html","../../plugins/standard/libs/std/src/lib/preview/money/euro-dollar.component.ts","../../plugins/standard/libs/std/src/lib/preview/money/euro-dollar.component.html","../../plugins/standard/libs/std/src/lib/preview/money/money.component.ts","../../plugins/standard/libs/std/src/lib/preview/money/money.component.html","../../plugins/standard/libs/std/src/lib/preview/rating/rating.component.ts","../../plugins/standard/libs/std/src/lib/preview/rating/rating.component.html","../../plugins/standard/libs/std/src/lib/preview/time/time-fields.component.ts","../../plugins/standard/libs/std/src/lib/preview/time/time-fields.component.html","../../plugins/standard/libs/std/src/lib/preview/web/web-fields.component.ts","../../plugins/standard/libs/std/src/lib/preview/web/web-fields.component.html","../../plugins/standard/libs/std/src/lib/store/dont-code-api-store-provider.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { ChangeDetectorRef, Component, Inject, Injector } from '@angular/core';\nimport { Change, ChangeType, Core, DontCodeModel, dtcde } from '@dontcode/core';\nimport { CommonConfigService, DONT_CODE_CORE } from '@dontcode/plugin-common';\nimport { LightAppComponent } from '@dontcode/sandbox';\nimport {environment} from '../environments/environment';\nimport { ChangeUpdateService } from './shared/change/services/change-update.service';\nimport { ProjectService } from './shared/project/services/project.service';\nimport { TextService } from './shared/text/services/text.service';\nimport { SandboxRepositorySchema } from '@dontcode/sandbox';\n\n@Component({\n  selector: 'ide-ui-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent extends LightAppComponent{\n  title = 'ide-ui';\n\n  constructor (configService:CommonConfigService, protected service:TextService\n    , protected updateService:ChangeUpdateService\n    , protected projectService: ProjectService, httpClient: HttpClient, injector: Injector, ref: ChangeDetectorRef,\n    @Inject(DONT_CODE_CORE) dontCodeCore: Core\n) {\n    super (configService, httpClient, injector, ref, dontCodeCore);\n    this.defaultRepositoryUrl='assets/repositories/stable.json';\n      // Manages the different cases of loading the repository of plugins\n    this.runtimeConfig = (window as any).dontCodeConfig;\n    if ((this.runtimeConfig!=null) && (this.runtimeConfig?.repositoryUrl==null)) {\n      this.runtimeConfig.repositoryUrl=environment.repositoryUrl;\n    }\n\n  }\n  mainTab(): boolean {\n    return window.location.hash.indexOf('/newTabDev')==-1;\n  }\n\n  /**\n   * Initializa all services after all plugins and config are being loaded.\n   * @param config\n   * @param repoUrl \n   */\n  protected afterInitialization(config: SandboxRepositorySchema, repoUrl: string): Promise<void> {\n      \n    this.service.resetSchema();\n    this.service.readSchema(dtcde.getSchemaManager().getSchema());\n  //    this.service.readSchemaFormUrl('assets/core/'+DontCode.dtcde.getSchemaUri());\n    return this.updateService.pushChange(new Change(ChangeType.RESET, DontCodeModel.ROOT,null)).then (\n      () => {\n        this.projectService.newCurrentProject();\n      },\n      (reason) => {\n        console.error ('Error while resetting model after a loadSchema', reason);\n        this.projectService.newCurrentProject();\n      }\n    )\n  }\n}\n","<ide-ui-main *ngIf=\"mainTab()\"><ide-ui-main-editor></ide-ui-main-editor></ide-ui-main>\n<ng-container *ngIf=\"!mainTab()\"><router-outlet></router-outlet></ng-container>\n","import {BrowserModule} from '@angular/platform-browser';\nimport {NgModule} from '@angular/core';\n\nimport {AppComponent} from './app.component';\nimport {BrowserAnimationsModule} from '@angular/platform-browser/animations';\nimport {LayoutModule} from './layout/layout.module';\nimport {EditorModule} from './routes/editor/editor.module';\nimport {RouterModule, Routes} from '@angular/router';\nimport {MainEditorComponent} from './routes/editor/main-editor/main-editor.component';\nimport {HttpClientModule} from '@angular/common/http';\nimport {ListChangesComponent} from './routes/dev/list-changes/list-changes.component';\nimport {DevModule} from './routes/dev/dev.module';\nimport {WelcomeModule} from './routes/welcome/welcome.module';\nimport {WelcomeComponent} from \"./routes/welcome/main/welcome.component\";\nimport {BasicModule, FieldsModule} from \"@dontcode/plugin-std\";\nimport {ConfirmationService} from \"primeng/api\";\nimport { RestModule } from '@dontcode/plugin-rest';\nimport {PluginCommonModule} from \"@dontcode/plugin-common\";\nimport {ReportModule} from \"@dontcode/plugin-report\";\nimport {CommerceModule} from \"@dontcode/plugin-commerce\";\n\nconst appRoutes:Routes = [\n  { path: '', component: WelcomeComponent },\n  {path: 'editor', component: MainEditorComponent},\n  {path: 'welcome', component: WelcomeComponent},\n  {path: 'dev', component: ListChangesComponent},\n  {path: 'newTabDev', component: ListChangesComponent},\n  { path: 'project', loadChildren: () => import('./routes/project/project.module').then(m => m.ProjectModule) }]\n\n@NgModule({\n  declarations: [AppComponent],\n  imports: [BrowserModule, BrowserAnimationsModule\n    , EditorModule, LayoutModule, DevModule,\n    RouterModule.forRoot(\n      appRoutes,\n      { enableTracing: false,useHash:true } // <-- debugging purposes only\n    ),\n  HttpClientModule,\n  WelcomeModule,\n    PluginCommonModule.forRoot()\n    ,BasicModule\n    ,FieldsModule\n    ,RestModule\n    ,ReportModule\n    ,CommerceModule\n  ],\n  providers: [ConfirmationService],\n  bootstrap: [AppComponent]\n})\n\nexport class AppModule {}\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {MainComponent} from './main/main.component';\nimport {RouterModule} from '@angular/router';\nimport {MenuModule} from \"primeng/menu\";\nimport {ButtonModule} from \"primeng/button\";\nimport {ToolbarModule} from \"primeng/toolbar\";\nimport {SidebarModule} from \"primeng/sidebar\";\nimport {MenuComponent} from \"./menu/menu.component\";\nimport {TooltipModule} from \"primeng/tooltip\";\nimport {OverlayPanelModule} from \"primeng/overlaypanel\";\n\n\n@NgModule({\n  declarations: [MainComponent, MenuComponent],\n  exports: [\n    MainComponent\n  ],\n    imports: [\n        CommonModule, RouterModule, SidebarModule, ToolbarModule, ButtonModule, MenuModule, TooltipModule, OverlayPanelModule\n    ]\n})\nexport class LayoutModule { }\n","import {ChangeDetectorRef, Component, OnDestroy, OnInit} from '@angular/core';\nimport {combineLatest, Observable, Subscription} from 'rxjs';\nimport {map} from 'rxjs/operators';\nimport {TextService} from '../../shared/text/services/text.service';\nimport {ChangeUpdateService} from \"../../shared/change/services/change-update.service\";\nimport {environment} from \"../../../environments/environment\";\nimport {Change, ChangeType, DontCodeModel, dtcde} from \"@dontcode/core\";\nimport {ProjectService} from \"../../shared/project/services/project.service\";\nimport { CommonConfigService } from '@dontcode/plugin-common';\n\n\n@Component({\n  selector: 'ide-ui-main',\n  templateUrl: './main.component.html',\n  styleUrls: ['./main.component.css']\n})\nexport class MainComponent implements OnInit, OnDestroy{\n\n  protected subscriptions = new Subscription();\n\n  context$: Observable<\n    {\n      status:string,\n      sessionId:string|undefined\n    }>|null = null;\n\n  sidePanelVisible: boolean = true;\n\n  serverUrl ='';\n\n  constructor( protected service:TextService\n              , protected updateService:ChangeUpdateService\n              , protected projectService: ProjectService\n              , protected configService:CommonConfigService\n              , protected ref: ChangeDetectorRef\n              ) {\n    this.subscriptions.add (configService.getUpdates ().subscribe( {\n      next: (newConfig) => {\n        const changed = newConfig.ideWebSocketUrl!=this.serverUrl;\n        if (changed) {\n          this.serverUrl=newConfig.ideWebSocketUrl??'';\n          this.ref.markForCheck();\n          this.ref.detectChanges();\n        }\n    }}));\n  }\n\n  protected sessionId:string|undefined;\n\n  ngOnInit(): void {\n    this.sidePanelVisible = true;\n\n    this.context$ = combineLatest([this.updateService.getConnectionStatus(), this.updateService.getSessionId()])\n      .pipe(map ((status) => {\n        this.sessionId=status[1];\n        return {status:status[0], sessionId:status[1]};\n      }));\n\n//    this.loadSchema();\n    }\n\n  logoClicked() {\n    this.sidePanelVisible=true;\n  }\n\n  sidePanelVisibleChanged($event: any) {\n    //console.log($event);\n    this.sidePanelVisible=$event.target.visible;\n  }\n\n  /**\n   * User wants to re-start from scratch\n   */\n  loadSchema () {\n    this.service.resetSchema();\n    this.service.readSchema(dtcde.getSchemaManager().getSchema());\n    this.updateService.pushChange(new Change(ChangeType.RESET, DontCodeModel.ROOT,null)).then (\n      () => {\n        this.projectService.newCurrentProject();\n        this.ref.detectChanges();\n      },\n      (reason) => {\n        console.error ('Error while resetting model after a loadSchema', reason);\n        this.projectService.newCurrentProject();\n        this.ref.detectChanges();\n      }\n    )\n  }\n\n  openDevUrl() {\n    window.open('#/newTabDev', '_blank');\n  }\n\n  openPreview() {\n    if( this.sessionId==null) {\n      window.open(environment.previewUrl, '_blank');\n    }else {\n      window.open(environment.previewUrl+'?sessionId='+this.sessionId, '_blank');\n    }\n  }\n\n  connectedClass(ctx: { status: string }): string {\n    if( ctx.status!==\"connected\") {\n      return \"p-button-danger\";\n    }\n    return '';\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n\n}","<div *ngIf=\"(context$ | async) as ctx\">\n  <p-toolbar id=\"mainToolbar\">\n    <div class=\"p-toolbar-group-left\">\n      <img src=\"./assets/images/logo.png\" width=\"119\" height=\"66\"/>\n      <button pButton type=\"button\" class=\"md:hidden p-button-rounded p-button-outlined\" icon=\"pi pi-bars\" (click)=\"sidePanelVisible=!sidePanelVisible\"></button>\n    </div>\n   <h1>Dont-code Builder</h1>\n    <div class=\"p-toolbar-group-right\">\n      <button pButton type=\"button\" class=\"p-button-rounded p-button-outlined\" icon=\"pi pi-cloud-download\" pTooltip=\"New Application\" (click)=\"loadSchema()\"></button>\n      <button pButton type=\"button\" class=\"p-button-rounded p-button-outlined\" icon=\"pi pi-book\" pTooltip=\"Open Debugging Window\" (click)=\"openDevUrl()\"></button>\n      <button pButton type=\"button\" class=\"p-button-rounded p-button-outlined\" [ngClass]=\"connectedClass(ctx)\" icon=\"pi pi-external-link\" pTooltip=\"Open Previewer\" (click)=\"openPreview()\"></button>\n      <button pButton type=\"button\" class=\"p-button-rounded p-button-outlined\" [ngClass]=\"connectedClass(ctx)\" icon=\"pi pi-sort\"  (mouseenter)=\"op.show($event)\"></button>\n      <p-overlayPanel #op [showCloseIcon]=\"false\" [style]=\"{width: '500px'}\">\n        <ng-template pTemplate>\n          <div class=\"grid\">\n            <div class=\"col-2\">Server:</div>\n            <div class=\"col-10\">{{serverUrl}}</div>\n            <div class=\"col-2\">Session:</div>\n            <div class=\"col-10\">{{ctx.sessionId}}</div>\n          </div>\n        </ng-template>\n      </p-overlayPanel>\n    </div>\n  </p-toolbar>\n  <div class=\"md:hidden\">\n    <p-sidebar id=\"mainSidePanel\" [style]=\"{width:'15em'}\" [(visible)]=\"sidePanelVisible\" [modal]=\"false\" [closeOnEscape]=\"true\" [showCloseIcon]=\"true\">\n      <img src=\"./assets/images/logo.png\" width=\"119\" height=\"66\"/>\n      <ide-ui-menu></ide-ui-menu>\n    </p-sidebar>\n  </div>\n  <div class=\"grid\">\n    <div class=\"col hidden md:block md:col-2\">\n      <ide-ui-menu id=\"mainMenu\"></ide-ui-menu>\n    </div>\n    <div class=\"col md:col-10\">\n      <router-outlet> </router-outlet>\n    </div>\n  </div>\n\n</div>\n","import {ChangeDetectionStrategy, Component} from \"@angular/core\";\nimport {MenuItem} from \"primeng/api\";\n\n@Component({\n  selector: 'ide-ui-menu',\n  templateUrl: './menu.component.html',\n  styleUrls: ['./menu.component.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class MenuComponent {\n\n  menuItems =new Array<MenuItem> (\n    {label:'Main Menu', items:[\n        {label:'Welcome', icon:'pi pi-home', routerLink:['/welcome']},\n        {label:'Projects', icon:'pi pi-home', routerLink:['/project']},\n        {label:'Editor', icon:'pi pi-pencil', routerLink:['/editor']},\n      ]},\n    {label:'Debug Menu', items:[\n        {label:'Dev', icon:'pi pi-book', routerLink: ['/dev']}\n      ]}\n  );\n\n}\n\n","<p-menu [model]=\"menuItems\"></p-menu>\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {ListChangesComponent} from './list-changes/list-changes.component';\nimport {TableModule} from \"primeng/table\";\n\n\n@NgModule({\n  declarations: [ListChangesComponent],\n    imports: [\n        CommonModule,\n        TableModule\n    ]\n})\nexport class DevModule { }\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, Input, OnInit } from '@angular/core';\nimport { Change, ChangeType } from '@dontcode/core';\nimport { ChangeListenService } from '../../../shared/change/services/change-listen.service';\n\n@Component({\n  selector: 'ide-ui-list-changes',\n  templateUrl: './list-changes.component.html',\n  styleUrls: ['./list-changes.component.css'],\n  changeDetection:ChangeDetectionStrategy.OnPush\n})\nexport class ListChangesComponent implements OnInit {\n\n  // context$: Observable<any>;\n\n  @Input()\n  title: string='List of Changes';\n\n  listOfChanges:Change[]=new Array();\n\n  constructor(protected changeService:ChangeListenService,\n              private ref: ChangeDetectorRef) {\n  }\n\n  ngOnInit(): void {\n    this.listOfChanges=this.changeService.getListOfChanges();\n    this.changeService.getChangeEvents ().subscribe(value => {\n//      console.log(\"newVal\", value);\n      if (value.type===ChangeType.RESET) {\n        this.listOfChanges=this.changeService.getListOfChanges();\n      }\n        //We have to force refresh when displayed in another tab\n      this.ref.detectChanges();\n    });\n  }\n\n/*  newInit (): void {\n    this.listOfChanges=this.changeService.getListOfChanges();\n    this.context$ = combineLatest([this.changeService.getChangeEvents()])\n      .pipe(map ((change) => {\n        console.log(\"Updating...\");\n        this.ref.detectChanges();\n        return {change};\n      }));\n\n  }*/\n}\n","<h1>{{title}}</h1>\n\n<p-table [value]=\"listOfChanges\" [resizableColumns]=\"true\" styleClass=\"p-datatable-gridlines\">\n  <ng-template pTemplate=\"header\">\n    <tr>\n      <th pResizableColumn>Type</th>\n      <th pResizableColumn>Position</th>\n      <th pResizableColumn>Value</th>\n    </tr>\n  </ng-template>\n  <ng-template pTemplate=\"body\" let-change>\n    <tr>\n      <td>{{change.type}}</td>\n      <td>{{change.position}}</td>\n      <td>{{change.value | json}}</td>\n    </tr>\n  </ng-template>\n</p-table>\n","import {\n  AbstractSchemaItem,\n  DontCodeModelManager,\n  DontCodeSchemaEnum,\n  DontCodeSchemaItem,\n  DontCodeSchemaProperty,\n  DontCodeSchemaRef,\n  dtcde\n} from \"@dontcode/core\";\n\n\nexport class EditorElement {\n\n  id: string;\n  type: EditorElementType;\n  /**\n   * The position of this element in the hierarchy of elements\n   */\n  position: string;\n  /**\n   * The list of possible values (for a select box)\n   */\n  values: any[]|null=null;\n  /**\n   * The position of this element in the DontCode schema\n   */\n  schemaPosition: string;\n  /**\n   * The Schema model item represented by this element\n   */\n  schemaModel: DontCodeSchemaItem;\n\n  protected editedValue: any;\n\n  protected childrenToDisplay = new Array<EditorElement>();\n  protected allChildren = new Map<string, EditorElement> ();\n  protected forceRead = true;\n\n  protected parent: EditorElement|null=null;\n\n  /** An array of item carry the same schemamodel than the item itself, we use this to distinguish between the 2 modes\n   *\n   * @protected\n   */\n  protected asArray = false;\n\n  constructor(id:string, schemaItem:DontCodeSchemaItem, position:string, schemaPosition:string, type:EditorElementType) {\n    this.id = id;\n    this.schemaModel = schemaItem;\n    this.position=position;\n    this.schemaPosition=schemaPosition;\n\n    /**\n     * The id may not contains / as it is forbidden by html\n     */\n    if( this.id)\n      this.id=this.id.split('/').join('-');\n    this.type=type;\n  }\n\n  static createNew (position:string, schemaPosition:string, type:EditorElementType, schemaItem:DontCodeSchemaItem, listValues?:any[], initialValue?:any, asArray?:boolean) {\n    const ret = new EditorElement(position, schemaItem, position, schemaPosition, type);\n    if (listValues) {\n      ret.values=listValues;\n    }\n    if (initialValue) {\n        // Dont call setEditedValue as it would try to recalculate children\n      ret.editedValue=initialValue;\n    }\n\n    if( asArray) ret.asArray=asArray;\n    return ret;\n  }\n\n  getParent (): EditorElement|null {\n    return this.parent;\n  }\n\n  setParent (newParent:EditorElement ) {\n    this.parent = newParent;\n  }\n\n  isAsArray (): boolean {\n    return this.asArray;\n  }\n\n  isHidden (): boolean {\n    return DontCodeModelManager.isHidden (this.editedValue);\n  }\n\n  isReadonly (): boolean {\n    return DontCodeModelManager.isReadonly (this.editedValue);\n  }\n\n  /**\n   * Returns the item id of the DontCodeSchemaItem managed by this editor element if it's part of an array\n   */\n  getItemIdIfExists (): string|null {\n    if( (this.parent) && (this.parent.type===EditorElementType.array)) {\n      return this.position.substring(this.position.lastIndexOf('/') + 1);\n    }\n    return null;\n  }\n\n  getChildrenToDisplay (): Array<EditorElement> {\n    if (this.forceRead) {\n      this.childrenToDisplay.length=0;\n/*      let added=false;\n      if (this.type===EditorElementType.array) {\n        if (this.editedValue) {\n          for (const item in this.editedValue) {\n            if (this.editedValue.hasOwnProperty(item)) {\n              this.readSubSchema(this.position, this.schemaPosition, this.schemaModel, item, this.editedValue[item]);\n              added=true;\n            }\n          }\n        }\n      }\n      if(!added) {*/\n        this.readSubSchema(this.position, this.schemaPosition, this.schemaModel,undefined, this.editedValue );\n        if (this.schemaModel.isObject() || this.schemaModel.isArray())  // Object's value are stored in the children hierarchy, so we remove it from parent\n          this.editedValue=undefined;\n//      }\n      this.forceRead = false;\n    }\n    return this.childrenToDisplay;\n  }\n\n\n  /**\n   * Reads a DontCodeSchemaItem schema. Either is merges with current EditorElement\n   * @param position\n   * @param schemaPosition\n   * @param model\n   */\n  readSubSchema ( position:string, schemaPosition:string, model:DontCodeSchemaItem, mergeStartPosition?:number, values?:any): Array<EditorElement> {\n    const ret = this.childrenToDisplay;\n    let mergePosition = mergeStartPosition ? mergeStartPosition : 0;\n    const cache = this.allChildren;\n\n    const parent = model;\n    const children = new Array();\n    let initialValue = values;\n\n    if (this.asArray) {\n        // Makes sure subItems are created from the initialValues sent, if any\n        for (const itemKey in initialValue) {\n          if (initialValue.hasOwnProperty(itemKey)) {\n            children.push([itemKey, parent]);\n          }\n      }\n      if (children.length === 0) {// No initial items, so create a new empty one\n        children.push([this.getNextId(), parent]);\n      }\n    } else {\n      // Make sure all subproperties are considered\n        for (const childModel of parent.getChildren()) {\n          const propKey = childModel[0];\n          children.push([propKey, childModel[1]]);\n        }\n    }\n\n        // resolve schemareference of all children\n    children.forEach(value => {\n      if (value[1] instanceof DontCodeSchemaRef) {\n        if( !value[1].isArray() || parent === value[1]) // Only resolve ref if we are not creating the array element\n          value[1]=this.resolveRefs(value[1]);\n      }\n    });\n\n    for (const [propName, child] of children) {\n      let childPosition = position;\n      let schemaChildPosition = schemaPosition;\n      initialValue = values;\n        // Are we reading a subProperty ?\n      if (propName && propName.length>0) {\n        childPosition = childPosition + '/' + propName;\n        if( !this.asArray)\n          schemaChildPosition = schemaChildPosition + '/'+ propName;\n        if( initialValue)\n          initialValue = initialValue[propName];\n      }\n\n      let newElement:EditorElement|undefined = cache.get(propName);\n      if (!newElement) {\n        if (child.isArray() && (child!==parent) ) {\n          // A model can be an array and an object or value at the same time.\n          newElement = EditorElement.createNew(\n            childPosition, schemaChildPosition, EditorElementType.array, child, undefined, initialValue, true);\n        } else if (child.isValue()) {\n          newElement = EditorElement.createNew(\n            childPosition, schemaChildPosition, EditorElementType.input, child, undefined, initialValue);\n        } else if (child.isEnum()) {\n          const asEnum = child as DontCodeSchemaEnum;\n          newElement = EditorElement.createNew(\n            childPosition, schemaChildPosition, EditorElementType.list, child, asEnum.getValues(), initialValue);\n        } else if (child.isObject()) {\n          newElement = EditorElement.createNew(\n            childPosition, schemaChildPosition, EditorElementType.object, child, undefined, initialValue, false);\n        } /*else if (child.isReference()) {\n          this.readSubSchema(childPosition, schemaChildPosition, child, true, mergePosition, initialValue);\n        }*/ else {\n          console.error('Unknown item read from schema at position ' + position + ':', child);\n        }\n      } else if (initialValue!==undefined) {\n        newElement.setEditedValue(initialValue);\n      }\n\n      if (newElement) {\n        newElement.parent=this;\n        mergePosition = this.mergeElement(newElement, child, propName,mergePosition);\n        if (newElement.hasActiveProperties()) {\n          const toAddProps = newElement.getActiveProperties();\n          if (toAddProps) {\n              // We have to add a dynamic property, so let's create it with a possible value\n            let propValue = toAddProps.getRelativeId();\n            if ((values!=null)&&(propValue!=null)) {\n              propValue = values[propValue];\n            }else\n              propValue=undefined;\n            this.readSubSchema(position, schemaPosition, toAddProps, mergePosition, values);\n            // if the active properties are replacing the remaining elements, then remove the remaining elements and  just stop the loop here\n            if (newElement.isReplacementActive()) {\n              break;\n            }\n          }\n        }\n      }\n    }\n    return ret;\n  }\n\n  resolveRefs (entity: DontCodeSchemaItem): DontCodeSchemaItem {\n    let ret = entity;\n    if( entity.isReference()) {\n      const toFind = (entity as DontCodeSchemaRef).getReference();\n      const found= AbstractSchemaItem.goto(this.calculateRootSchema(),toFind);\n      if (found) ret=found;\n    }\n    return ret;\n  }\n\n  calculateRootSchema (): DontCodeSchemaItem {\n    let ret:DontCodeSchemaItem = this.schemaModel;\n    while (ret.getParent()) {\n      const parent =ret.getParent();\n      if (parent) ret = parent;\n    }\n    return ret;\n  }\n\n  getNextId() {\n    const childrenKeys = new Set<string>(this.allChildren.keys());\n    return DontCodeModelManager.generateNextKey(childrenKeys);\n  }\n\n  /**\n   * Creates a new sub element of an array. Usually called when the user clicks Add\n   * @param element\n   */\n  addSubElement() {\n    /**\n     * Creates the new element and adds it to the list\n     */\n    this.readSubSchema(this.position, this.schemaPosition, this.schemaModel);\n  }\n\n  removeElement( item:EditorElement, index?:number): EditorElement {\n    const parentList = this.getChildrenToDisplay();\n    if( !index){\n      index = parentList.indexOf(item);\n    }\n    const ret = parentList.splice(index,1)[0];\n    return ret;\n  }\n\n  /**\n   * Moves the item up one place and returns the immediate following item.\n   * or returns null if nothing have been moved\n   * @param item\n   * @param index\n   */\n  upElement( item: EditorElement, index: number): EditorElement|null {\n    const parentList = this.getChildrenToDisplay();\n    if( !index){\n      index = parentList.indexOf(item);\n    }\n\n    if (index>0) {\n      parentList.splice(index, 1);\n      parentList.splice(index-1,0,item);\n    } else {\n      return null;\n    }\n\n    return parentList[index];\n  }\n\n  /**\n   * Moves the item down and returns the next item if possible.\n   * Returns null if the item was already the last element (no move possible)\n   * or undefined if the moved item becomes the last element\n   * @param item\n   * @param index\n   */\n  downElement(item: EditorElement, index: number): EditorElement|null|undefined {\n    const parentList = this.getChildrenToDisplay();\n    if( !index){\n      index = parentList.indexOf(item);\n    }\n    if (index<parentList.length-1) {\n      parentList.splice(index, 1);\n      parentList.splice(index+1,0,item);\n    } else {\n      return null;\n    }\n\n    if ((index+1) === parentList.length-1) {\n      // Item becomes the last element, so no-one is after him\n      return undefined;\n    } else\n      return parentList[index+2];\n  }\n\n  getEditedValue (): any {\n    return this.editedValue;\n  }\n\n  setEditedValue (newVal:any): boolean {\n    const oldValue = this.editedValue;\n    this.editedValue = newVal;\n    const props = this.schemaModel.getProperties(this.editedValue);\n    if (props || (oldValue && (this.schemaModel.getProperties(oldValue)))) {\n      // The children properties have changed\n      //this.parent.mergeDisplayChildren(this, props);\n      if( this.parent)\n        this.parent.forceRead=true;\n      return true;\n    } else if ((this.schemaModel.isArray()) || (this.schemaModel.isObject())) {\n        // Remove all array items that are no more in values\n      for (const oldProp of this.allChildren.keys()) {\n        if( (!this.editedValue) || (this.editedValue[oldProp]===undefined)) {\n          this.allChildren.delete(oldProp);\n        }\n      }\n      this.forceRead=true;\n    }\n    return false;\n  }\n\n  protected hasActiveProperties(): boolean {\n    const props = this.schemaModel.getProperties(this.editedValue);\n    if (props)\n      return true;\n    else\n      return false;\n  }\n\n  protected getActiveProperties(): DontCodeSchemaProperty|undefined {\n    return this.schemaModel.getProperties(this.editedValue);\n  }\n\n  protected isReplacementActive(): boolean {\n    const props = this.schemaModel.getProperties(this.editedValue);\n    if (props && props.isReplace())\n      return true;\n    else\n      return false;\n  }\n\n  protected mergeElement(newElement: EditorElement, after:DontCodeSchemaItem, propName:string, mergeStartPosition: number): number {\n    const list= this.childrenToDisplay;\n    const cache = this.allChildren;\n    const key = propName??newElement.schemaModel.getRelativeId();\n    // If the element was already present, do nothing\n    if (cache.get(key)===newElement) {\n      // Returns its position\n      for (let i=0;i<list.length;i++) {\n        if (list[i]===newElement)\n          return i;\n      }\n    } else if (cache.get(key)!=null) {\n      console.error ('Setting 2 differents elements with the same property name: '+key+' for the element '+this.position);\n      throw new Error ('Setting 2 differents elements with the same property name: '+key+' for the element '+this.position);\n    }\n\n    cache.set(key, newElement);\n    if (mergeStartPosition>=list.length){\n      list.push(newElement);\n      return ++mergeStartPosition;\n    }\n\n    let foundAt=-1;\n    let alreadyThere=false;\n    for (let i=mergeStartPosition;i<list.length;i++) {\n      if (list[i].schemaModel===after) {\n        foundAt=i;\n      } else {\n        if (foundAt !== -1) {\n          // We found the insertion point, should we delete older elements or is the element already present in the list ?\n          if (list[i]===newElement) {\n            // It was already in the list !\n            alreadyThere = true;\n          }\n          break;\n        }\n      }\n    }\n\n    if (foundAt !== -1)\n      mergeStartPosition=foundAt+1;\n\n    if(!alreadyThere)\n      list.splice(mergeStartPosition, 0, newElement);\n    return mergeStartPosition;\n  }\n\n  getChild (propName:string) {\n    if (this.forceRead)\n      this.getChildrenToDisplay();\n    return this.allChildren.get(propName);\n  }\n\n  /**\n   * Retrieve the child in the hierarchy at the specified subposition.\n   * For example getChildInHierarchy ('sub/item/name') will return the name of the item who is child of sub child of the element\n   * getChildInHierarchy ('sub/table/ab/type') will return the type of the element ab of the array named table of sub child\n   * @param beforeAName\n   */\n  getChildInHierarchy(beforeAName: string): EditorElement|null {\n    const propNames=beforeAName.split('/');\n    let current:EditorElement|undefined = this;\n    //let nextIsArray= false;\n    //let arrayProp:string=null;\n    for (const propName of propNames) {\n      if( propName!==\"\") {\n        /*if( nextIsArray) {\n          current = this.getChildrenToDisplay().find(value => {\n            if (value.position.endsWith(arrayProp+'/'+propName))\n              return true;\n          });\n          arrayProp=null;\n          nextIsArray=false;\n        } else if( this.schemaModel.getChild(propName)?.isArray()) {\n          nextIsArray=true;\n          arrayProp = propName;\n        } else {*/\n        current = current.getChild(propName);\n   //     }\n        if(!current) {\n          return null;\n        }\n      }\n    }\n    return current;\n  }\n}\n\nexport enum EditorElementType {\n  array='array',\n  object='object',\n  newLine='newLine',\n  input='input',\n  list='list',\n  label='label'\n}\nenum ArrayAction {\n  DEFAULT,\n  NEW_ITEM=1,\n  ONLY_ITEM\n}\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {MainEditorComponent} from './main-editor/main-editor.component';\nimport {TextHandlerComponent} from './text-handler/text-handler.component';\nimport {TextElementComponent} from './text-element/text-element.component';\nimport {SelectElementComponent} from './select-element/select-element.component';\nimport {SharedModule} from '../../shared/shared.module';\nimport {InputElementComponent} from './input-element/input-element.component';\nimport {SubTextElementComponent} from './sub-text-element/sub-text-element.component';\nimport {AccordionModule} from \"primeng/accordion\";\nimport {ButtonModule} from \"primeng/button\";\nimport {DropdownModule} from \"primeng/dropdown\";\nimport {InputTextModule} from \"primeng/inputtext\";\nimport {FormsModule, ReactiveFormsModule} from \"@angular/forms\";\nimport {AutoCompleteModule} from \"primeng/autocomplete\";\n\n\n@NgModule({\n  declarations: [MainEditorComponent, TextHandlerComponent, TextElementComponent, SelectElementComponent, InputElementComponent, SubTextElementComponent],\n  exports: [\n    MainEditorComponent\n  ],\n    imports: [\n        CommonModule,\n        SharedModule,\n        AccordionModule,\n        ButtonModule,\n        DropdownModule,\n        InputTextModule,\n        FormsModule,\n        ReactiveFormsModule,\n        AutoCompleteModule\n    ]\n})\nexport class EditorModule { }\n","import { Component, Input, OnDestroy, OnInit } from '@angular/core';\nimport { EditorElement } from '../editor-element';\nimport { ChangeUpdateService } from '../../../shared/change/services/change-update.service';\nimport { Change, ChangeType } from '@dontcode/core';\nimport { FormControl } from '@angular/forms';\nimport { Subscriber, Subscription } from 'rxjs';\n\n@Component({\n  selector: 'ide-ui-input-element',\n  templateUrl: './input-element.component.html',\n  styleUrls: ['./input-element.component.css']\n})\nexport class InputElementComponent implements OnInit, OnDestroy {\n  @Input()\n  element!: EditorElement;\n\n  subscriptions = new Subscription ();\n  \n  control = new FormControl<string>({value:'', disabled:false}, {updateOn:'blur'});\n\n  constructor(protected changeService:ChangeUpdateService) { }\n\n  ngOnInit(): void {\n    this.updateView ();\n    this.subscriptions.add (\n      this.control.valueChanges.subscribe ({next: (value) => this.onChange(value)})\n    );\n  }\n\n  ngOnDestroy(): void {\n      this.subscriptions.unsubscribe();\n  }\n\n  updateView (): void {\n    if (this.element?.getEditedValue()==null)\n      {\n        this.control.setValue('', {emitModelToViewChange:true, emitEvent:false});\n      } else {\n        this.control.setValue(this.element.getEditedValue(), {emitModelToViewChange:true, emitEvent:false});\n      }\n    \n    /*if ((this.element!=null) && (this.element.isReadonly()==true))\n        this.control.disable({emitEvent:false});\n      else\n        this.control.enable({emitEvent:false});\n      */\n    }\n\n  onChange(newValue: string|null): void {\n    if (this.element!=null) {\n    this.element.setEditedValue(newValue);\n    this.changeService.pushChange(\n      new Change(ChangeType.UPDATE,\n        this.element.position,\n        newValue));\n\n      }\n    }\n\n}\n","<span class=\"displayable\">{{(element.schemaPosition | locale)}}</span>\n<input pInputText [id]=\"element.id\" [name]=\"element.id\" [formControl]=\"control\">\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from \"@angular/core\";\nimport { ChangeListenService } from \"../../../shared/change/services/change-listen.service\";\nimport { TextService } from \"../../../shared/text/services/text.service\";\nimport { EditorElement } from \"../editor-element\";\nimport {Subject, Subscription} from \"rxjs\";\nimport { takeUntil } from \"rxjs/operators\";\nimport { ChangeType, DontCodeModel } from \"@dontcode/core\";\n\n@Component({\n  selector: 'ide-ui-main-editor',\n  templateUrl: './main-editor.component.html',\n  styleUrls: ['./main-editor.component.css'],\n  changeDetection:ChangeDetectionStrategy.OnPush\n})\nexport class MainEditorComponent implements OnInit, OnDestroy {\n\n  rootElement:EditorElement|null=null;\n\n  unsubscriber = new Subscription();\n\n  constructor(protected ref:ChangeDetectorRef, protected changeListener: ChangeListenService, public textService:TextService) {\n    // Make sure the dev change listener is already started and listening\n\n  }\n\n  ngOnInit(): void {\n    try {\n      this.rootElement = this.textService.getRootElement();\n      console.debug('Got initial rootElement', this.rootElement.getChild('name')?.getEditedValue());\n    } catch (err) {\n      console.error('Error getting initial root element.', err);\n    }\n\n    this.unsubscriber.add(this.changeListener.getChangeEvents()\n      .subscribe(change => {\n        //console.debug('Change receive for rootElement', this.rootElement?.getChild('name')?.getEditedValue());\n        if (change.type===ChangeType.RESET) {\n          if( change.position===DontCodeModel.ROOT || change.position===\"\") {\n            try {\n            this.rootElement = this.textService.getRootElement();\n            this.rootElement.setEditedValue(change.value?.creation);\n            console.debug('Reset received, new root element', this.rootElement.getChild('name')?.getEditedValue());\n            this.ref.markForCheck();\n            this.ref.detectChanges();\n          } catch (err) {\n            console.error('Error getting the edited root element.', err);\n          }\n          }\n        }\n      })\n    );\n\n  }\n\n  ngOnDestroy(): void {\n    console.debug('Closing with rootElement', this.rootElement?.getChild('name')?.getEditedValue());\n    // unsubscribe to all observables\n    this.unsubscriber.unsubscribe();\n  }\n\n}\n","<ide-ui-text-handler *ngIf=\"rootElement\" [element]=\"rootElement\"></ide-ui-text-handler>\n","import {Component, EventEmitter, Input, OnInit, Output} from \"@angular/core\";\nimport {EditorElement} from '../editor-element';\nimport {ChangeUpdateService} from '../../../shared/change/services/change-update.service';\nimport {Change, ChangeType, DontCodeSchemaEnumValue} from '@dontcode/core';\n\n@Component({\n  selector: 'ide-ui-select-element',\n  templateUrl: './select-element.component.html',\n  styleUrls: ['./select-element.component.css']\n})\nexport class SelectElementComponent implements OnInit {\n\n  @Input()\n  element!: EditorElement;\n\n  @Output()\n  refresh = new EventEmitter<string>();\n\n  filteredElements:any[]=new Array();\n\n  constructor(protected changeService:ChangeUpdateService) {\n  }\n\n  ngOnInit(): void {\n  }\n\n  calculateOptionValue(option: string): string {\n    return option;\n  }\n\n  editedValue() {\n    if (this.element.getEditedValue())\n      return this.element.getEditedValue();\n    else\n      return '';\n  }\n\n  onChange(change:any) {\n    //console.log('Selection change', change);\n    let value = change;\n    if( typeof change !== 'string') {\n      value = change.target.value;\n    }\n    const changed:boolean = this.element.setEditedValue(value);\n\n    this.changeService.pushChange(\n      new Change(ChangeType.UPDATE,\n        this.element.position,\n        value));\n\n    if(changed) {\n      this.refresh.emit('refresh');\n    }\n  }\n\n  filterGroupedElements(event:any) {\n    const filteredGroups = [];\n    const defaultGroup:{label:string, items:Array<any>|null} = {\n      label: 'Standard',\n      items: null\n    }\n\n      // If there is only one selection left, then selects it\n    let selectItem:DontCodeSchemaEnumValue|null = null;\n    let selectedCount = 0;\n\n    event.query = event.query?.toLowerCase();\n\n    for (const optgroup of this.element.values as Array<DontCodeSchemaEnumValue>) {\n      if( !(optgroup.getChildren()) || (optgroup.getChildren().length===0)) {\n        if( optgroup.getLabel().toLowerCase().indexOf(event.query) >= 0) {\n          if (defaultGroup.items === null) {\n            defaultGroup.items = new Array();\n            filteredGroups.push(defaultGroup);\n          }\n          defaultGroup.items.push (optgroup.getLabel());\n          if((event.query?.length === optgroup.getLabel().length)) {\n            selectedCount++;\n            selectItem = optgroup;\n            }\n        }\n      } else {\n        const items = optgroup.getChildren().filter (value => value.getLabel().toLowerCase().indexOf(event.query) >=0);\n        if( items.length>0) {\n          selectedCount += items.length;\n          selectItem = items[0];\n          filteredGroups.push({\n            label: optgroup.getLabel(),\n            value: optgroup.getValue(),\n            items: items.map(value => value.getLabel())\n          });\n        }\n      }\n    }\n\n    this.filteredElements = filteredGroups;\n    if ((selectedCount===1)&&(selectItem)) {\n      if (selectItem.getLabel().length===event.query?.length) {\n        this.onChange({target: {value:selectItem.getLabel()}});\n      }\n    }\n  }\n}\n","<span class=\"displayable\">{{(element.schemaPosition | locale)}}</span>\n<p-autoComplete class=\"displayable\" [ngModel]=\"editedValue()\" [group]=\"true\" [id]=\"element.id\" [suggestions]=\"filteredElements\" (completeMethod)=\"filterGroupedElements($event)\"\n                (onSelect)=\"onChange($event)\" [dropdown]=\"true\" [readonly]=\"element.isReadonly()\">\n  <ng-template let-group pTemplate=\"group\">\n    <div class=\"p-d-flex p-ai-center\">\n      <span>{{group.label}}</span>\n    </div>\n  </ng-template>\n  <ng-template let-option pTemplate=\"item\">\n    {{(option | locale)}}\n  </ng-template>\n</p-autoComplete>\n<!-- p-dropdown class=\"displayable\" [id]=\"element.id\" [options]=\"element.values\" (onChange)=\"onChange($event)\" [ngModel]=\"element?.getEditedValue()\">\n  <ng-template let-option pTemplate=\"item\">\n    {{(option | locale)}}\n  </ng-template>\n</p-dropdown -->\n\n","import { Component, Input, OnChanges, OnInit, SimpleChanges } from \"@angular/core\";\nimport { EditorElement } from \"../editor-element\";\nimport { ChangeUpdateService } from \"../../../shared/change/services/change-update.service\";\nimport { Change, ChangeType } from \"@dontcode/core\";\n\n@Component({\n  selector: 'ide-ui-sub-text-element',\n  templateUrl: './sub-text-element.component.html',\n  styleUrls: ['./sub-text-element.component.css']\n})\nexport class SubTextElementComponent implements OnInit, OnChanges {\n  @Input()\n  element!: EditorElement;\n\n  items: EditorElement[]=new Array();\n  constructor(protected changeService:ChangeUpdateService) { }\n\n  ngOnInit(): void {\n  }\n\n  addElement() {\n    this.element.addSubElement();\n  }\n\n  removeElement(item:EditorElement, index:number) {\n    const removed = this.element.removeElement( item, index);\n    this.changeService.pushChange(\n      new Change(ChangeType.DELETE,\n        removed.position, null));\n  }\n\n  /**\n   * Moves the item up one place and returns the immediately following item, if there is one.\n   * or returns null if nothing have been moved\n   * @param item\n   * @param index\n   */\n  upElement(item:EditorElement, index:number) {\n    const oldPos = item.position; // The old position is the same as the new one in this case (only the beforeId changes)\n    const nextElement = this.element.upElement( item, index);\n    if( nextElement !== null) {\n      const nextKey= nextElement.getItemIdIfExists();\n\n      this.changeService.pushChange(\n        new Change(ChangeType.MOVE, item.position, item.getEditedValue(),undefined, nextKey?nextKey as string:undefined, oldPos)\n      );\n    }\n  }\n  downElement(item:EditorElement, index:number) {\n    const oldPos = item.position; // The old position is the same as the new one in this case (only the beforeId changes)\n    const nextElement = this.element.downElement( item, index);\n    if( nextElement!==null) {\n      let nextKey;\n      if( nextElement===undefined) {  // It is the last element\n        nextKey = undefined;\n      } else {\n        nextKey=nextElement.getItemIdIfExists();\n      }\n      this.changeService.pushChange(\n          new Change(ChangeType.MOVE, item.position, item.getEditedValue(),undefined, nextKey?nextKey as string:undefined, oldPos)\n        );\n\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this.items = this.element.getChildrenToDisplay();\n  }\n}\n","<span class=\"displayable\" >{{(element.schemaPosition | locale)}}</span>\n<p-accordion>\n  <p-accordionTab [selected]=\"true\">\n    <ng-template pTemplate=\"header\"><span class=\"displayable\" [id]=\"element.id\">{{(element.schemaPosition | localeDesc)}}</span></ng-template>\n    <ng-template pTemplate=\"content\">  <div style=\"padding-left: 10px\">\n      <ng-container *ngFor=\"let item of items; index as i\">\n        <ng-container *ngIf=\"!item.isHidden()\">\n          <ide-ui-text-handler [element]=\"item\"></ide-ui-text-handler>\n          <ng-container>\n            <button pButton type=\"button\" class=\"p-button-secondary p-button-rounded p-button-outlined\" [id]=\"item.id+'-add-button'\" icon=\"pi pi-plus\" aria-label=\"Add item\" (click)=\"addElement()\">\n            </button>\n            <button pButton type=\"button\" class=\"p-button-danger p-button-rounded p-button-outlined\" [id]=\"item.id+'-remove-button'\" icon=\"pi pi-minus\" aria-label=\"Remove item\" (click)=\"removeElement(item, i)\">\n            </button>\n            <button *ngIf=\"i>0\" pButton type=\"button\" class=\"p-button-secondary p-button-rounded p-button-outlined\" [id]=\"item.id+'-up-button'\" icon=\"pi pi-caret-up\" aria-label=\"Up\" (click)=\"upElement(item, i)\">\n            </button>\n            <button *ngIf=\"i<items.length-1\" pButton type=\"button\" [id]=\"item.id+'-down-button'\" class=\"p-button-secondary p-button-rounded p-button-outlined\"  icon=\"pi pi-caret-down\" aria-label=\"Down\" (click)=\"downElement(item, i)\">\n            </button>\n            <br />\n          </ng-container>\n        </ng-container>\n      </ng-container>\n      <ng-container *ngIf=\"items.length==0\">\n        <button pButton type=\"button\" class=\"p-button-secondary p-button-rounded p-button-outlined\" [id]=\"element.id+'-new-button'\" icon=\"pi pi-plus\" aria-label=\"Add item\" (click)=\"addElement()\">\n        </button>\n      </ng-container>\n    </div>\n    </ng-template>\n  </p-accordionTab>\n</p-accordion>\n","import { Component, Input, OnInit } from '@angular/core';\nimport { EditorElement } from '../editor-element';\n\n@Component({\n  selector: 'ide-ui-text-element',\n  templateUrl: './text-element.component.html',\n  styleUrls: ['./text-element.component.css']\n})\nexport class TextElementComponent implements OnInit {\n  @Input()\n  element!: EditorElement;\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<span class=\"displayable\" [id]=\"element.id\">{{(element.schemaPosition | locale)}}</span>\n","import { ChangeDetectorRef, Component, Input, OnChanges, OnInit, SimpleChanges } from \"@angular/core\";\nimport { TextService } from '../../../shared/text/services/text.service';\nimport { EditorElement } from '../editor-element';\n\n@Component({\n  selector: 'ide-ui-text-handler',\n  templateUrl: './text-handler.component.html',\n  styleUrls: ['./text-handler.component.css']\n})\nexport class TextHandlerComponent implements OnInit, OnChanges {\n\n  @Input()\n  element!:EditorElement;\n\n  listOfElements:EditorElement[] = [];\n\n  constructor(protected model: TextService, protected ref:ChangeDetectorRef) { }\n\n  ngOnInit(): void {\n    this.listOfElements = this.element.getChildrenToDisplay();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n//    console.log(\"text Changed\");\n    this.listOfElements = this.element.getChildrenToDisplay();\n  }\n\n  refresh() {\n    this.listOfElements = this.element.getChildrenToDisplay();\n    this.ref.detectChanges();\n  }\n}\n","<ng-container>\n  <ng-container *ngFor=\"let element of listOfElements\">\n    <ng-container *ngIf=\"!element.isHidden()\">\n      <ng-container [ngSwitch]=\"element.type\">\n        <br *ngSwitchCase=\"'newLine'\"/>\n        <ide-ui-text-element *ngSwitchCase=\"'string'\" [element]=\"element\"></ide-ui-text-element>\n        <ng-container *ngSwitchCase=\"'object'\">\n          <div><span class=\"displayable\" >{{(element.schemaPosition | locale)}}</span>\n            <ide-ui-text-handler  [element]=\"element\">\n            </ide-ui-text-handler>\n          </div>\n          <br />\n        </ng-container>\n        <ide-ui-sub-text-element *ngSwitchCase=\"'array'\" [element]=\"element\">\n        </ide-ui-sub-text-element>\n        <ide-ui-select-element *ngSwitchCase=\"'list'\" [element]=\"element\" (refresh)=\"refresh()\"></ide-ui-select-element>\n        <ide-ui-input-element *ngSwitchCase=\"'input'\" [element]=\"element\"></ide-ui-input-element>\n      </ng-container>\n    </ng-container>\n  </ng-container>\n</ng-container>\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'ide-ui-welcome',\n  templateUrl: './welcome.component.html',\n  styleUrls: ['./welcome.component.css']\n})\nexport class WelcomeComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<h2>Welcome to Dont-code !</h2>\n<p>You are running the Builder application of the Dont-code platform.</p>\n<p>Use this tool to create new applications or load and edit their behaviors.</p>\n<div class=\"grid align-items-stretch\">\n<div class=\"welcome-question col-12\">\n  <h2>Tutorials</h2>\n</div>\n<div class=\"col-12 md:col-6\">\n  <p-card header=\"Show me a demo\" subheader=\"The fastest way to see the Dont-code platform in action is to load an existing project.\">\n    <div class=\"welcome-item\"><p-badge value=\"1\"></p-badge> Open the Previewer by clicking on <button pButton type=\"button\" class=\"p-button-rounded p-button-outlined\" icon=\"pi pi-external-link\"></button> on the top bar.</div>\n    <div class=\"welcome-item\"><p-badge value=\"2\"></p-badge> Then select the menu <i class=\"pi pi-home\" style=\"font-size: 1.1rem\">&nbsp;Projects</i> on the side bar.</div>\n    <div class=\"welcome-item\"><p-badge value=\"3\"></p-badge> Load the Task Manager project <p-button icon=\"pi pi-play\" label=\"Play\"></p-button></div>\n    <div class=\"welcome-item\"><p-badge value=\"4\"></p-badge> Edit some elements in the <i class=\"pi pi-pencil\" style=\"font-size: 1.1rem\">&nbsp;Editor</i></div>\n    <div class=\"welcome-item\"><p-badge value=\"5\"></p-badge> And watch the Previewer acting accordingly <img src=\"assets/images/preview-ui-tab.png\" /></div>\n  </p-card>\n</div>\n<div class=\"col-12 md:col-6\">\n  <p-card header=\"Start from scratch\" subheader=\"Gets more insights by working from a blank project\">\n    <div class=\"welcome-item\"><p-badge value=\"1\"></p-badge> Open the Previewer by clicking on <button pButton type=\"button\" class=\"p-button-rounded p-button-outlined\" icon=\"pi pi-external-link\"></button> on the top bar.</div>\n    <div class=\"welcome-item\"><p-badge value=\"2\"></p-badge> Then Create a new application by clicking on <i class=\"pi pi-download\" style=\"font-size: 1.1rem\">&nbsp;New Application</i> icon.</div>\n    <div class=\"welcome-item\"><p-badge value=\"3\"></p-badge> Edit some elements in the <i class=\"pi pi-pencil\" style=\"font-size: 1.1rem\">&nbsp;Editor</i></div>\n    <div class=\"welcome-item\"><p-badge value=\"4\"></p-badge> And watch the Previewer acting accordingly <img src=\"assets/images/preview-ui-tab.png\" /></div>\n    <div class=\"welcome-item\"><p-badge value=\"5\"></p-badge> You can save your work by selecting <i class=\"pi pi-home\" style=\"font-size: 1.1rem\">&nbsp;Projects</i> on the side bar.</div>\n    <div class=\"welcome-item\"><p-badge value=\"6\"></p-badge> And select <p-button icon=\"pi pi-save\" label=\"Save\"></p-button> button.</div>\n  </p-card>\n</div>\n\n</div>\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {WelcomeComponent} from './main/welcome.component';\nimport {ButtonModule} from \"primeng/button\";\nimport {CardModule} from \"primeng/card\";\nimport {BadgeModule} from \"primeng/badge\";\n\n\n@NgModule({\n  declarations: [WelcomeComponent],\n    imports: [\n        CommonModule, ButtonModule, CardModule, BadgeModule\n    ]\n})\nexport class WelcomeModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n\n\n@NgModule({\n  declarations: [],\n  imports: [\n    CommonModule\n  ]\n})\nexport class ChangeModule { }\n","import { Injectable } from '@angular/core';\nimport { ChangeUpdateService } from './change-update.service';\nimport { BroadcastChannel } from 'broadcast-channel';\nimport {Change, ChangeType, DontCodeChangeManager, dtcde} from '@dontcode/core';\nimport { Observable, ReplaySubject, Subject } from 'rxjs';\n\n/**\n * List to all the changes on the edited elements from the BroadCastChannel and updates\n * a list of changes from it.\n */\n@Injectable({\n  providedIn: 'root'\n})\nexport class ChangeListenService {\n\n  protected channel: BroadcastChannel<Change>;\n  protected listOfChanges: Change[]=[];\n\n  protected changeEmitter = new Subject<Change> ();\n\n  constructor(protected changeMgr:DontCodeChangeManager) {\n    this.channel = new BroadcastChannel(ChangeUpdateService.CHANNEL_CHANGE_NAME);\n    console.log('Channel receiver created');\n    this.channel.onmessage = msg => {\n      if( msg.type===ChangeType.RESET) {\n        this.listOfChanges.length=0;\n      } else {\n        this.listOfChanges.push(msg);\n      }\n      this.changeEmitter.next(msg);\n      if (msg.type===ChangeType.RESET)\n        this.resetEmitter ();\n    };\n    this.changeEmitter.subscribe({\n      next: change => {\n        this.changeMgr.pushChange(change);\n      }\n    })\n\n\n  }\n\n  resetEmitter () {\n/*    const newReplay = new ReplaySubject<Change>();\n    newReplay.observers=this.changeEmitter.observers;\n    this.changeEmitter=newReplay;*/\n  }\n\n  getListOfChanges (): Change[] {\n    return this.listOfChanges;\n  }\n\n  getChangeEvents (): Observable<Change> {\n    return this.changeEmitter;\n  }\n\n}\n","import {Injectable} from \"@angular/core\";\nimport {Change, ChangeType, DontCodeModel, Message, MessageType} from \"@dontcode/core\";\nimport {BroadcastChannel} from \"broadcast-channel\";\nimport {webSocket, WebSocketSubject, WebSocketSubjectConfig} from \"rxjs/webSocket\";\n\nimport {Observable, ReplaySubject} from \"rxjs\";\nimport { CommonConfigService } from \"@dontcode/plugin-common\";\n\n/**\n * Updates all changes to the edited elements (what the user entered in the IDE)\n * to a broadcastchannel (for dev tab) and the websocket to the services.\n */\n@Injectable({\n  providedIn: 'root'\n})\nexport class ChangeUpdateService {\n\n  public static readonly CHANNEL_CHANGE_NAME='ide-ui-changes';\n  protected listOfChanges: Change[]=[];\n  protected channel: BroadcastChannel<Change>;\n\n  protected ideServicesWebSocket: WebSocketSubject<Message>|null=null;\n  protected connectionStatus: ReplaySubject<string>=new ReplaySubject<string>(1);\n\n  /**\n   * The Id of the session as returned by the services. This is used to tell the previewer to listen only to this session\n   * @protected\n   */\n  protected sessionIdSubject = new ReplaySubject<string|undefined>(1);\n  protected sessionId?:string;\n\n  protected currentSocketUrl: string|null =null;\n\n  constructor(protected configService:CommonConfigService) {\n    console.debug('Creating channel');\n    this.channel = new BroadcastChannel(ChangeUpdateService.CHANNEL_CHANGE_NAME);\n\n    this.configService.getUpdates().subscribe((newConfig) => {\n      const socketChanged = newConfig.ideWebSocketUrl!=this.currentSocketUrl;\n      if (socketChanged) {\n        this.currentSocketUrl=newConfig.ideWebSocketUrl??null;\n          // Close the current socket, it will be opened when needed\n        if (this.ideServicesWebSocket) {\n          if (!this.ideServicesWebSocket.closed) {\n            this.ideServicesWebSocket?.complete();\n          }\n        }\n        if( this.currentSocketUrl!=null)\n        this.pushChange(new Change(ChangeType.RESET, DontCodeModel.ROOT,null));\n\n      }\n    });\n\n    this.connectionStatus.next(\"closed\");\n    this.sessionIdSubject.next(undefined);\n\n  }\n\n  protected openWebSocket (): Promise<WebSocketSubject<Message>> {\n      // Check if there is one already opened\n    if (this.ideServicesWebSocket) {\n      if (!this.ideServicesWebSocket.closed) {\n        return Promise.resolve(this.ideServicesWebSocket);\n      }\n    }\n      // If not, then check if we can open one\n    const socketUrl=this.currentSocketUrl;\n    if (socketUrl==null) {\n      return Promise.reject(\"No Websocket Url to connect to\")\n    } else {\n      const ret = new Promise<WebSocketSubject<Message>>((resolve, reject) => {\n        const config: WebSocketSubjectConfig<any> = {\n          url: socketUrl,\n          closeObserver: {\n            next: value => {\n              console.debug(\"Close\", value);\n\n            }\n          },\n          openObserver: {\n            next: value => {\n              if (this.ideServicesWebSocket)\n                resolve(this.ideServicesWebSocket);\n              else\n                reject('No WebSocket');\n            },\n            error: err => {\n              console.error(\"error connecting socket\", err);\n              reject(err);\n            }\n          }\n        }\n\n        this.ideServicesWebSocket = webSocket(config);\n        this.connectionStatus.next(\"connected\");\n        this.sessionIdSubject.next(undefined);\n        this.ideServicesWebSocket.asObservable().subscribe({\n          next: msg => {\n\n            //console.log('message received: ' , msg);\n            const newId=msg?.sessionId;\n            if ((newId) && (newId !== this.sessionId)){\n              console.debug('Received SessionId ', newId);\n              this.sessionId=newId;\n              this.sessionIdSubject.next(newId);\n            }\n          },\n          // Called whenever there is a message from the server\n          error: err => {\n            console.error(err);\n            this.ideServicesWebSocket?.unsubscribe();\n            this.ideServicesWebSocket = null;\n            this.connectionStatus.next(\"ERROR:\" + err);\n            this.sessionIdSubject.next(undefined);\n          },\n          // Called if WebSocket API signals some kind of error\n          complete: () => {\n            console.debug('complete');\n            this.ideServicesWebSocket?.unsubscribe();\n            this.ideServicesWebSocket = null;\n            this.connectionStatus.next(\"closed\");\n            this.sessionIdSubject.next(undefined);\n          }\n          // Called when connection is closed (for whatever reason)\n        });\n      });\n      return ret;\n    }\n  }\n\n  pushChange (newChange:Change): Promise<void> {\n    //console.log('Change pushed');\n    if( newChange.type===ChangeType.RESET) {\n      this.listOfChanges.length=0;\n    } else {\n      this.listOfChanges.push(newChange);\n    }\n    return Promise.all ([\n      this.channel.postMessage(newChange),\n      this.updateSocket(new Message (MessageType.CHANGE, this.sessionId, newChange))\n      ]\n    ).then ();\n    \n  }\n\n  updateSocket (newChange:Message): Promise<void> {\n    return this.openWebSocket().then (socket => socket.next(newChange));\n  }\n\n  getListOfChanges (): Change[] {\n    return this.listOfChanges;\n  }\n\n  getConnectionStatus (): Observable<string> {\n    return this.connectionStatus;\n  }\n  getSessionId (): Observable<string|undefined> {\n    return this.sessionIdSubject;\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { LocaleService } from '../text/services/locale.service';\n\n@Pipe({\n  name: 'localeDesc'\n})\nexport class LocaleDescPipe implements PipeTransform {\n\n  constructor(protected locale:LocaleService) {\n  }\n\n  transform(value: string, ...args: unknown[]): unknown {\n    return this.locale.toText(value+'-desc');\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { LocaleService } from '../text/services/locale.service';\n\n@Pipe({\n  name: 'locale'\n})\nexport class LocalePipe implements PipeTransform {\n\n  constructor(protected locale:LocaleService) {\n  }\n\n  transform(value: string, ...args: unknown[]): unknown {\n    return this.locale.toText(value);\n  }\n\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'typeOf'\n})\nexport class TypeOfPipe implements PipeTransform {\n\n  transform(value: unknown, ...args: unknown[]): unknown {\n    if (Array.isArray(value))\n      return 'array';\n    else\n      return typeof value;\n  }\n\n}\n","import { DontCodeProject } from '@dontcode/core';\n\nexport class IdeProject extends DontCodeProject {\n  _id:any;\n  current?: boolean;\n  content: any;\n}\n","import {Injectable, OnDestroy} from '@angular/core';\nimport {firstValueFrom, Observable, of, Subscription, throwError} from \"rxjs\";\nimport {IdeProject} from \"../IdeProject\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {map} from \"rxjs/operators\";\nimport {Change, ChangeType, dtcde} from \"@dontcode/core\";\nimport {ChangeUpdateService} from \"../../change/services/change-update.service\";\nimport { CommonConfigService } from '@dontcode/plugin-common';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ProjectService implements OnDestroy{\n\n  protected subscriptions = new Subscription();\n  projects: Array<IdeProject> = [];\n\n  protected currentProject: IdeProject;\n  projectApiUrl: string|null = null;\n\n  constructor(protected http: HttpClient, protected configService: CommonConfigService) {\n    this.currentProject=new IdeProject();\n    this.currentProject.template=false;\n    this.currentProject.current = true;\n      // Receive any updates of the project urls\n    this.subscriptions.add(this.configService.getUpdates().subscribe ( {\n      next: (newConfig) => {\n        this.projectApiUrl = newConfig.projectApiUrl??null;\n      }\n    }));\n  }\n\n  loadListOfProjects () :Observable<Array<IdeProject>> {\n    if (this.projectApiUrl!=null) {\n      return this.http.get<Array<IdeProject>>(this.projectApiUrl).pipe(\n        map(newProjects => {\n          this.projects=this.placeCurrentProject(newProjects);\n          return this.projects;\n        }));\n    } else {\n      return throwError ( () => new Error (\"No API provided to load projects\"));\n    }\n  }\n\n  placeCurrentProject (projects:Array<IdeProject>) {\n    // Keep the currentProject at first place in the list\n    const found = projects.findIndex(value => {\n      return value._id === this.currentProject._id;\n    });\n    if( found === -1) {\n      projects=[this.currentProject, ...projects];\n    } else {\n      projects.splice(found, 1);\n      projects=[this.currentProject, ...projects];\n    }\n    return projects;\n\n  }\n\n  saveCurrentProject (): Promise<IdeProject> {\n    if (this.projectApiUrl!=null) {\n\n      const toSave = {...this.currentProject};\n      delete toSave.current;  // We don't want to save the fact it's the current project\n\n      const model = dtcde.getModelManager().getContent();\n      toSave.content = model;\n      if( toSave._id) {\n        return firstValueFrom(this.http.put<IdeProject>(this.projectApiUrl+'/'+this.currentProject.name, toSave, {responseType:\"json\"} ).pipe(\n          map (value => {\n          delete value.content;\n          return value;\n        }))\n        );\n      } else {\n        return firstValueFrom(this.http.post<IdeProject>(this.projectApiUrl, toSave, {responseType:\"json\"} ).pipe (\n          map (value => {\n            this.currentProject._id=value._id;\n            return this.currentProject;\n          }))\n        );\n      }\n    } else {\n      return Promise.reject ( new Error (\"No API provided to save project.\"));\n    }\n\n  }\n\n  loadProject (prj:IdeProject): Promise<IdeProject> {\n    if( prj.name) {\n      if (this.projectApiUrl!=null) {\n        return firstValueFrom(this.http.get<IdeProject>(this.projectApiUrl + '/' + prj.name, {responseType: 'json'}));\n      } else {\n        return Promise.reject ( new Error (\"No API provided to load project.\"));\n      }\n  \n    } else {\n      return Promise.resolve(prj);\n    }\n  }\n\n  /**\n   * Creates a new empty project and sets it as current project\n   */\n  newCurrentProject (): IdeProject {\n    this.setCurrentProject(new IdeProject());\n    return this.currentProject;\n  }\n\n  setCurrentProject (prj:IdeProject): void {\n    if( this.currentProject?.current) {\n      delete this.currentProject.current;\n    }\n    this.currentProject=prj;\n    this.currentProject.current = true;\n    this.projects = this.placeCurrentProject(this.projects);\n  }\n\n  loadAndSetCurrentProject (prj:IdeProject, updateService: ChangeUpdateService) : Promise<IdeProject>{\n   // console.log(\"Loading Project\");\n    return this.loadProject(prj).then (value => {\n     // console.log(\"Setting current Project\");\n      this.setCurrentProject(value);\n      // console.log(\"Pushing update\");\n      updateService.pushChange(new Change(ChangeType.RESET, '', value.content));\n      // console.log(\"Loading Project done\");\n      return value;\n    })\n\n  }\n\n  getCurrentProject (): IdeProject {\n    return this.currentProject;\n  }\n\n  isCurrentProject (prj:IdeProject): boolean {\n    if (prj.current)  return prj.current;\n    else\n      return false;\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { TypeOfPipe } from './pipes/type-of.pipe';\nimport { TextModule } from './text/text.module';\nimport { LocalePipe } from './pipes/locale.pipe';\nimport { LocaleDescPipe } from './pipes/locale-desc.pipe';\nimport { ChangeModule } from './change/change.module';\n\n@NgModule({\n    declarations: [TypeOfPipe, LocalePipe, LocaleDescPipe],\n  exports: [\n    TypeOfPipe,\n    LocalePipe,\n    LocaleDescPipe\n  ],\n    imports: [\n        CommonModule,\n        TextModule,\n      ChangeModule\n    ]\n})\nexport class SharedModule { }\n","import { Injectable } from '@angular/core';\nimport { DontCodeModel } from '@dontcode/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LocaleService {\n  texts = new Map<string, string> ([\n    [DontCodeModel.ROOT, 'I want to create'],\n    [DontCodeModel.APP_TYPE, 'I want to create a'],\n    [DontCodeModel.APP_NAME, 'with the name'],\n    [DontCodeModel.APP_NAME+'-desc', 'Enter the name'],\n    [DontCodeModel.APP_ENTITIES, 'handing the following items:'],\n    [DontCodeModel.APP_ENTITIES+'-desc', 'List of managed items'],\n    [DontCodeModel.APP_ENTITIES_FROM, 'An item from'],\n    [DontCodeModel.APP_ENTITIES_FROM+'-desc', 'Predefined items'],\n    [DontCodeModel.APP_ENTITIES_NAME, 'with the name'],\n    [DontCodeModel.APP_ENTITIES_NAME+'-desc', 'Name of item'],\n    [DontCodeModel.APP_FIELDS, 'containing the following fields:'],\n    [DontCodeModel.APP_FIELDS+'-desc', 'List of fields'],\n    [DontCodeModel.APP_FIELDS_NAME, 'A field named'],\n    [DontCodeModel.APP_FIELDS_NAME+'-desc', 'Name of field'],\n    [DontCodeModel.APP_FIELDS_TYPE, 'with the type'],\n    [DontCodeModel.APP_FIELDS_TYPE+'-desc', 'Type of field'],\n    [DontCodeModel.APP_REPORTS, 'It will display reports:'],\n    [DontCodeModel.APP_REPORTS+'-desc', 'Design the reports you want to use'],\n    [DontCodeModel.APP_REPORTS_TITLE, 'One named'],\n    [DontCodeModel.APP_REPORTS_TITLE+'-desc', 'The title of the report'],\n    [DontCodeModel.APP_REPORTS_FOR, 'for the item'],\n    [DontCodeModel.APP_REPORTS_FOR+'-desc', 'Name of the item to generate the report for'],\n    [DontCodeModel.APP_REPORTS_GROUP, 'Values must be grouped'],\n    [DontCodeModel.APP_REPORTS_GROUP+'-desc', 'Select if and how a grouping of values will be done'],\n    [DontCodeModel.APP_REPORTS_GROUP_OF, 'on'],\n    [DontCodeModel.APP_REPORTS_GROUP_OF+'-desc', 'The field or the type of field to use for grouping'],\n    [DontCodeModel.APP_REPORTS_GROUP_SHOW, 'show'],\n    [DontCodeModel.APP_REPORTS_GROUP_SHOW+'-desc', 'if grouping on a type of field, which one to show ?'],\n    [DontCodeModel.APP_REPORTS_GROUP_LABEL, 'with the label'],\n    [DontCodeModel.APP_REPORTS_GROUP_LABEL+'-desc', 'The title of the group to display'],\n    [DontCodeModel.APP_REPORTS_GROUP_AGGREGATE, 'and the group must display'],\n    [DontCodeModel.APP_REPORTS_GROUP_AGGREGATE+'-desc', 'What result to be displayed for each group ?'],\n    [DontCodeModel.APP_REPORTS_GROUP_AGGREGATE_OPERATION, 'the'],\n    [DontCodeModel.APP_REPORTS_GROUP_AGGREGATE_OPERATION+'-desc', 'Operation to display on the elements'],\n    [DontCodeModel.APP_REPORTS_GROUP_AGGREGATE_OF, 'of'],\n    [DontCodeModel.APP_REPORTS_GROUP_AGGREGATE_OF+'-desc', 'What field will be displayed ?'],\n    [DontCodeModel.APP_REPORTS_GROUP_AGGREGATE_LABEL, 'labelled as'],\n    [DontCodeModel.APP_REPORTS_GROUP_AGGREGATE_LABEL+'-desc', 'The label of the field aggregation'],\n    [DontCodeModel.APP_REPORTS_SORT, 'Please sort the values'],\n    [DontCodeModel.APP_REPORTS_SORT+'-desc', 'Specify how the values will be sorted'],\n    [DontCodeModel.APP_REPORTS_SORT_BY, 'according to'],\n    [DontCodeModel.APP_REPORTS_SORT_BY+'-desc', 'The field you want to sort'],\n    [DontCodeModel.APP_REPORTS_SORT_DIRECTION, 'order'],\n    [DontCodeModel.APP_REPORTS_SORT_DIRECTION+'-desc', 'Highest ranking or Lowest ranking first ?'],\n    [DontCodeModel.APP_REPORTS_DISPLAY, 'The report displays'],\n    [DontCodeModel.APP_REPORTS_DISPLAY+'-desc', 'what must be displayed'],\n    [DontCodeModel.APP_REPORTS_DISPLAY_TYPE, 'a'],\n    [DontCodeModel.APP_REPORTS_DISPLAY_TYPE+'-desc', 'the graph or table you want displayed'],\n    [DontCodeModel.APP_REPORTS_DISPLAY_OF, 'of'],\n    [DontCodeModel.APP_REPORTS_DISPLAY_OF+'-desc', 'the field to display. Empty for all'],\n    [DontCodeModel.APP_REPORTS_DISPLAY_BY, 'by'],\n    [DontCodeModel.APP_REPORTS_DISPLAY_BY+'-desc', 'the field to display. Empty for all'],\n    [DontCodeModel.APP_REPORTS_DISPLAY_TITLE, 'with the title'],\n    [DontCodeModel.APP_REPORTS_DISPLAY_TITLE+'-desc', 'Enter the title of the graph or table displayed'],\n    [DontCodeModel.APP_SHARING, 'Information will be shared '],\n    [DontCodeModel.APP_SHARING+'-desc', 'List of screens'],\n    [DontCodeModel.APP_SHARING_WITH, 'with'],\n    [DontCodeModel.APP_SHARING_WITH+'-desc', 'Persons to information will be visible to.'],\n    [DontCodeModel.APP_SOURCES, 'Data will come from:'],\n    [DontCodeModel.APP_SOURCES+'-desc', 'Source of data'],\n    [DontCodeModel.APP_SOURCES_NAME, 'A source named'],\n    [DontCodeModel.APP_SOURCES_NAME+'-desc', 'Sets a name for the data source'],\n    [DontCodeModel.APP_SOURCES_TYPE, 'of type'],\n    [DontCodeModel.APP_SOURCES_TYPE+'-desc', 'How to connect to the source'],\n    [DontCodeModel.APP_SOURCES_URL, 'with the url'],\n    [DontCodeModel.APP_SOURCES_URL+'-desc', 'The url to call the service'],\n    [DontCodeModel.APP_SCREENS, 'Showing the screens'],\n    [DontCodeModel.APP_SCREENS+'-desc', 'List of screens'],\n    [DontCodeModel.APP_SCREENS_NAME, 'A screen with the name'],\n    [DontCodeModel.APP_SCREENS_NAME+'-desc', 'Name of screen'],\n    [DontCodeModel.APP_SCREENS_LAYOUT, 'and the layout'],\n    [DontCodeModel.APP_SCREENS_LAYOUT+'-desc', 'layout of the screen'],\n    [DontCodeModel.APP_COMPONENTS, 'displaying parts:'],\n    [DontCodeModel.APP_COMPONENTS+'-desc', 'List of parts'],\n    [DontCodeModel.APP_COMPONENTS_TYPE, 'A part with the type'],\n    [DontCodeModel.APP_COMPONENTS_TYPE+'-desc', 'Type of part'],\n    [DontCodeModel.APP_COMPONENTS_ENTITY, 'handling the entity'],\n    [DontCodeModel.APP_COMPONENTS_ENTITY+'-desc', 'Entity\\'s name'],\n    // Find a way for plugins to dynamically inserts label texts\n    [DontCodeModel.APP_SCREENS+'/type', 'of type'],\n    [DontCodeModel.APP_SCREENS+'/type-desc', 'Type of screen'],\n    [DontCodeModel.APP_SCREENS+'/entity', 'handling the entity'],\n    [DontCodeModel.APP_SCREENS+'/entity-desc', 'Entity\\'s name']\n  ]);\n\n  constructor() {\n    //\n  }\n\n  toText (context:string, element?:string): string {\n    let ret:string|undefined;\n    if (element) {\n      ret = this.texts.get(context+'/'+element);\n      if (!ret) {\n        ret = context+'/'+element;\n      }\n    }else {\n      ret = this.texts.get(context);\n      if (!ret)\n        ret = context;\n    }\n    return ret;\n  }\n\n}\n","import { Injectable } from \"@angular/core\";\nimport { Change, ChangeType, DontCodeModel, DontCodeSchemaItem, AbstractSchemaItem } from \"@dontcode/core\";\nimport { EditorElement, EditorElementType } from \"../../../routes/editor/editor-element\";\nimport { HttpClient } from \"@angular/common/http\";\nimport { ChangeUpdateService } from \"../../change/services/change-update.service\";\n\n/**\n  Manages the model to be edited and as well the list of elements that informs the UI about what to display.\n */\n@Injectable({\n  providedIn: 'root'\n})\nexport class TextService {\n\n  protected jsonSchema:DontCodeSchemaItem|null=null;\n\n  protected rootElement:EditorElement|null=null;\n\n  /**\n   * Stores the SchemaItem corresponding to a position in the schema\n   * For example:\n   *  'creation/entities' => The SchemaItem describing an entity\n   *  'creation/entities/fields/' => The SchemaItem describing a field in an entity\n   *  'creation/screens[type=list]/columns' => The SchemaItem describing a column of a screen when the screen type is list\n   */\n  //mapOfJson = new Map<string, DontCodeSchemaItem>();\n\n  constructor(protected http:HttpClient) {\n//    console.debug('TextElement: Constructor');\n\n  }\n\n\n  resetSchema () {\n//    console.debug('TextElement: Resetting rootElement');\n    this.rootElement=null;\n  }\n\n  /**\n   * Read the schema to integrate it in the list\n   * @param schemaAsJson\n   */\n  readSchema (schemaAsJson:DontCodeSchemaItem) {\n    this.jsonSchema = schemaAsJson;\n    const rootSchema= AbstractSchemaItem.goto(schemaAsJson, DontCodeModel.ROOT);\n    if( rootSchema) {\n      this.rootElement = EditorElement.createNew(\n        DontCodeModel.ROOT, DontCodeModel.ROOT,\n        EditorElementType.label, rootSchema);\n  //      console.debug('TextElement: New rootElement set');\n      }\n  }\n\n  getRootElement (): EditorElement {\n    if (!this.rootElement) throw new Error('No root elements to return');\n  //  console.debug('TextElement: returning rootElement');\n    return this.rootElement;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n\n\n@NgModule({\n  declarations: [],\n  imports: [\n    CommonModule\n  ]\n})\nexport class TextModule { }\n","export const environment = {\n  production: false,\n  previewUrl: 'https://run.dont-code.net/preview-ui/next',\n  //repositoryUrl: 'assets/repositories/next.json'\n  repositoryUrl: 'https://test.dont-code.net/demo/repository-next.json'\n\n};\n\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic()\n  .bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","/* (ignored) */","import * as DontCode from '../globals';\n\n/**\n * Stores and manipulate the schema representing a dont-code application\n */\nexport interface DontCodeSchemaItem {\n  isObject(): boolean;\n  isArray(): boolean;\n  isEnum(): boolean;\n  isValue(): boolean;\n  isReference(): boolean;\n  isRoot(): boolean;\n  isReadonly(): boolean;\n  isHidden(): boolean;\n\n  /**\n   * Adds or update a child with the change given by the plugin\n   * @param change\n   */\n  upsertWith(change: DontCode.ChangeConfig): boolean;\n\n  /**\n   * Updates the Schema Item with the given change config\n   * @param update\n   */\n  updateWith(update: DontCode.ChangeConfig): void;\n\n  getParent(): DontCodeSchemaItem | undefined;\n  getChild(id?: string): DontCodeSchemaItem | undefined;\n  //  getChildIndex (child:DontCodeSchemaItem): number;\n  getChildren(): IterableIterator<[string, DontCodeSchemaItem]>;\n\n  /**\n   * Returns all properties\n   */\n  allProperties(): IterableIterator<[string, DontCodeSchemaProperty]>;\n  getProperties(code: string): DontCodeSchemaProperty | undefined;\n  hasProperties(code: string): boolean;\n\n  /**\n   * Check if possibly the property named code can be assigned to this schemaItem by one of its child dynamically.\n   * @param code\n   */\n  isPossibleDynamicProperty(code: string): DontCodeSchemaProperty | undefined;\n\n  /**\n   * Returns all the children and the dynamic properties that could appear depending on the data\n   */\n  getChildrenAndPossibleProperties (): IterableIterator<[string, DontCodeSchemaItem]>;\n\n  getRelativeId(): string | undefined;\n  setRelativeId(relativeId: string | undefined): void;\n\n  getTargetPath(): string | undefined;\n}\n\nexport abstract class AbstractSchemaItem implements DontCodeSchemaItem {\n  protected parent: DontCodeSchemaItem | undefined;\n  protected array = false;\n  protected readOnly = false;\n  protected hidden = false;\n  protected relativeId: string | undefined;\n  protected targetPath: string | undefined;\n\n  protected constructor(\n    parent: DontCodeSchemaItem | undefined,\n    relativeId?: string\n  ) {\n    this.parent = parent;\n    this.relativeId = relativeId;\n  }\n\n  isArray(): boolean {\n    return this.array;\n  }\n\n  setArray(val: boolean) {\n    this.array = val;\n  }\n\n  isEnum(): boolean {\n    return false;\n  }\n\n  isObject(): boolean {\n    return false;\n  }\n\n  isReference(): boolean {\n    return false;\n  }\n\n  isValue(): boolean {\n    return false;\n  }\n\n  isRoot(): boolean {\n    return false;\n  }\n\n  isHidden(): boolean {\n    return this.hidden;\n  }\n\n  setHidden(val: boolean): void {\n    this.hidden = val;\n  }\n\n  isReadonly(): boolean {\n    return this.readOnly;\n  }\n\n  setReadonly(val: boolean): void {\n    this.readOnly = val;\n  }\n\n  public static generateItem(\n    json: any,\n    itemId: string,\n    parent?: DontCodeSchemaItem\n  ): AbstractSchemaItem {\n    let isArray = Array.isArray(json);\n\n    if (isArray) {\n      console.error('arrays are not supported', json);\n      return json;\n    }\n\n    let ret: AbstractSchemaItem;\n    isArray = false;\n\n    if (json['type']) {\n      const type = json['type'];\n      switch (type) {\n        case 'object':\n          ret = new DontCodeSchemaObject(json, itemId, parent);\n          break;\n        case 'array':\n          ret = this.generateItem(json['items'], itemId, parent);\n          isArray = true;\n          break;\n        default:\n          ret = new DontCodeSchemaValue(json, itemId, parent);\n      }\n    } else if (json['enum']) {\n      ret = new DontCodeSchemaEnum(json, itemId, parent);\n    } else if (json['$ref']) {\n      ret = new DontCodeSchemaRef(json, itemId, parent);\n    } else {\n      return json;\n    }\n    if (json['readOnly'] === true) ret.setReadonly(true);\n    if (json['writeOnly'] === true) ret.setHidden(true);\n    ret.setArray(isArray);\n    return ret;\n  }\n\n  public static isObject(item: any): boolean {\n    return typeof item === 'object' && !Array.isArray(item) && item !== null;\n  }\n\n  public static goto(\n    entity: DontCodeSchemaItem,\n    to: string\n  ): DontCodeSchemaItem | undefined {\n    let ret: DontCodeSchemaItem | undefined = entity;\n    to.split('/').forEach((value) => {\n      if (value !== '#' && value != '') {\n        ret = ret?.getChild(value);\n      }\n      if (!ret) {\n        console.error(\n          'Cannot find ' + value + ' of ' + to + ' in the following item ',\n          entity\n        );\n      }\n    });\n    return ret;\n  }\n\n  upsertWith(change: DontCode.ChangeConfig): boolean {\n    return false;\n  }\n\n  getParent(): DontCodeSchemaItem | undefined {\n    return this.parent;\n  }\n\n  getChild(id?: string): DontCodeSchemaItem | undefined {\n    return;\n  }\n\n  getChildren(): IterableIterator<[string, DontCodeSchemaItem]> {\n    return new Map().entries();\n  }\n\n  updateWith(update: DontCode.ChangeConfig): void {\n    //\n  }\n\n  allProperties(): IterableIterator<[string, DontCodeSchemaProperty]> {\n    return [].values();\n  }\n\n  getProperties(code: string): DontCodeSchemaProperty | undefined {\n    return undefined;\n  }\n\n  hasProperties(code: string): boolean {\n    return false;\n  }\n\n  getRelativeId(): string | undefined {\n    return this.relativeId;\n  }\n  setRelativeId(relativeId: string | undefined) {\n    this.relativeId = relativeId;\n  }\n\n  getTargetPath(): string | undefined {\n    return this.targetPath;\n  }\n\n  setTargetPath(newPath: string): void {\n    this.targetPath = newPath;\n  }\n\n  isPossibleDynamicProperty(code: string): DontCodeSchemaProperty | undefined {\n    const children = this.getChildren();\n    for (const child of children) {\n      const childProps = child[1].allProperties();\n      for (const childProp of childProps) {\n        if (childProp[1].getChild(code)) {\n          return childProp[1];\n        }\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * Returns all properties that can be used by this SchemaItem depending on the values entered\n   */\n  getAllPossibleDynamicProperties ():IterableIterator<[string, DontCodeSchemaItem]> {\n    const children = this.getChildren();\n    const ret = new Map<string, DontCodeSchemaItem>();\n    for (const child of children) {\n      const childProps = child[1].allProperties();\n      for (const childProp of childProps) {\n        for (const childChildProp of childProp[1].getChildren()) {\n          if (ret.has(childChildProp[0])) {\n            console.warn(\"Dynamic Property \"+childChildProp[0]+\" is being defined by multiple children.\");\n          }\n          ret.set(childChildProp[0], childChildProp[1]);\n        }\n      }\n    }\n    return ret.entries();\n  }\n\n  /**\n   * Returns the list of children and all possible dynamic properties that can be created depending on the values entered\n   */\n  getChildrenAndPossibleProperties(): IterableIterator<[string, DontCodeSchemaItem]> {\n    return concatIterable(this.getChildren(), this.getAllPossibleDynamicProperties());\n  }\n\n}\n\n/**\n * Generator function to combine multiple iterators into one\n * @param iterators\n */\nexport function* concatIterable<T>(...iterators: IterableIterator<T>[]) {\n  for (let i of iterators) {\n      i = i[Symbol.iterator]();\n\n    let f: IteratorResult<T> | Promise<IteratorResult<T>>;\n    while (true) {\n      f = i.next();\n      if (f.done) {\n        break;\n      }\n      yield f.value;\n    }\n  }\n}\n\n/**\n * Handles an item defined as an object consisting of a name and a set of named children\n */\nexport class DontCodeSchemaObject extends AbstractSchemaItem {\n  protected children = new Map<string, DontCodeSchemaItem>();\n\n  constructor(json: any, relativeId?: string, parent?: DontCodeSchemaItem) {\n    super(parent, relativeId);\n    if (json) this.readJson(json);\n  }\n\n  protected readJson(json: any) {\n    const props = json['properties'];\n    if (props) {\n      for (const key in props) {\n        this.children.set(\n          key,\n          AbstractSchemaItem.generateItem(props[key], key, this)\n        );\n      }\n    }\n    /*const definitions =json['$defs'];\n    if( definitions) {\n      const defsItem=AbstractSchemaItem.generateItem(definitions, '$defs', this);\n      this.children.set('$defs', defsItem);\n    }*/\n  }\n\n  override isEnum(): boolean {\n    return false;\n  }\n\n  override isObject(): boolean {\n    return true;\n  }\n\n  override isReference(): boolean {\n    return false;\n  }\n\n  override isValue(): boolean {\n    return false;\n  }\n\n  override isRoot(): boolean {\n    return false;\n  }\n\n  override upsertWith(change: DontCode.ChangeConfig): boolean {\n    const existsOrNot = this.getChild(change.location.id);\n    if (!existsOrNot) {\n      if (change.location.id!=null) {\n        const exists = AbstractSchemaItem.generateItem(\n          change.update,\n          change.location.id,\n          this\n        );\n        if (change.location.after) {\n          const newMap = new Map<string, DontCodeSchemaItem>();\n          this.children.forEach((value, key) => {\n            newMap.set(key, value);\n            if ((key === change.location.after)&&(change.location.id!=null)) {\n              newMap.set(change.location.id, exists);\n            }\n          });\n          this.children = newMap;\n        } else {\n          this.children.set(change.location.id, exists);\n        }\n        exists.updateWith(change);\n      }\n    } else {\n      // Make sure to load the sub-properties\n      existsOrNot.updateWith(change);\n    }\n    return true;\n  }\n\n  override updateWith(update: DontCode.ChangeConfig) {\n    super.updateWith(update);\n  }\n\n  override getChild(id?: string): DontCodeSchemaItem | undefined {\n    if (id) return this.children.get(id);\n    else return;\n  }\n\n  override getChildren(): IterableIterator<[string, DontCodeSchemaItem]> {\n    return this.children.entries();\n  }\n\n  /*getChildIndex(child: DontCodeSchemaItem): number {\n    let ret=-1;\n    this.children.forEach((value, key) => {\n      ret++;\n      if( value===child)\n        return ret;\n    })\n    return -1;\n  }*/\n}\n\n/**\n * The root item of the model is a specialized object\n */\nexport class DontCodeSchemaRoot extends DontCodeSchemaObject {\n  constructor(json?: any) {\n    super(json, undefined);\n  }\n\n  protected override readJson(json: any) {\n    super.readJson(json);\n\n    // Let the base class believe it's a property and do all the work !\n    const $defs = json['$defs'];\n    if ($defs) {\n      this.children.set(\n        '$defs',\n        new DontCodeSchemaObject(\n          {\n            properties: $defs,\n          },\n          '$defs',\n          this\n        )\n      );\n    }\n  }\n\n  override isEnum(): boolean {\n    return false;\n  }\n\n  override isObject(): boolean {\n    return true;\n  }\n\n  override isReference(): boolean {\n    return false;\n  }\n\n  override isValue(): boolean {\n    return false;\n  }\n  override isRoot(): boolean {\n    return true;\n  }\n}\n\n/**\n * Supports selection of a value amongst a list (or a hierarchical tree)\n */\nexport class DontCodeSchemaEnum extends AbstractSchemaItem {\n  protected values = new Array<DontCodeSchemaEnumValue>();\n  protected properties = new Map<string, DontCodeSchemaProperty>();\n\n  constructor(json: any, relativeId?: string, parent?: DontCodeSchemaItem) {\n    super(parent, relativeId);\n    this.updateValues(json['enum'], this.values);\n    this.targetPath = json['format'];\n  }\n\n  override isEnum(): boolean {\n    return true;\n  }\n\n  override isObject(): boolean {\n    return false;\n  }\n\n  override isReference(): boolean {\n    return false;\n  }\n\n  override isValue(): boolean {\n    return false;\n  }\n\n  override isRoot(): boolean {\n    return false;\n  }\n\n  getValues(): Array<DontCodeSchemaEnumValue> {\n    return this.values;\n  }\n\n  override updateWith(update: DontCode.ChangeConfig) {\n    super.updateWith(update);\n    this.updateValues(update.update['enum'], this.values, update);\n  }\n\n  updateValues(\n    values: Array<any>,\n    destination: Array<DontCodeSchemaEnumValue>,\n    from?: DontCode.ChangeConfig\n  ): void {\n    values.forEach((value) => {\n      if (typeof value === 'string') {\n        if (\n          !destination.find((dest) => {\n            return dest.getValue() === value;\n          })\n        ) {\n          destination.push(new DontCodeSchemaEnumValue(value));\n        }\n        if (from?.props) {\n          const props = new DontCodeSchemaProperty(\n            from,\n            this.relativeId + '=' + value,\n            this\n          );\n          if (!props.isEmpty()) this.properties.set(value, props);\n        }\n      } else {\n        for (const subKey in value) {\n          if (value.hasOwnProperty(subKey)) {\n            let enumValue = destination.find((dest) => {\n              return dest.getValue() === value;\n            });\n            if (!enumValue) {\n              enumValue = new DontCodeSchemaEnumValue(subKey);\n              destination.push(enumValue);\n            }\n            if (!enumValue.getChildren()) enumValue.setChildren([]);\n            this.updateValues(\n              value[subKey].enum,\n              enumValue.getChildren(),\n              from\n            );\n          }\n        }\n      }\n    });\n  }\n\n  override allProperties(): IterableIterator<[string, DontCodeSchemaProperty]> {\n    return this.properties.entries();\n  }\n\n  override getProperties(code: string): DontCodeSchemaProperty | undefined {\n    return this.properties.get(code);\n  }\n\n  override hasProperties(code: string): boolean {\n    return this.properties.has(code);\n  }\n}\n\n/**\n * A Simple class to store possible hierarchies of values, and separate label from the model value\n */\nexport class DontCodeSchemaEnumValue {\n  private _label: string;\n  private _value: string;\n  private _children = new Array<DontCodeSchemaEnumValue>();\n\n  constructor(value: string, label?: string) {\n    this._value = value;\n    if (label) {\n      this._label = label;\n    } else {\n      this._label = value;\n    }\n  }\n\n  getLabel(): string {\n    if (this._label) return this._label;\n    else return this._value;\n  }\n\n  setLabel(value: string) {\n    this._label = value;\n  }\n\n  getValue(): string {\n    return this._value;\n  }\n\n  setValue(value: string) {\n    this._value = value;\n  }\n\n  getChildren(): Array<DontCodeSchemaEnumValue> {\n    return this._children;\n  }\n\n  setChildren(value: Array<DontCodeSchemaEnumValue>) {\n    this._children = value;\n  }\n}\n\n/**\n * The model item is just a value that the user can change\n */\nexport class DontCodeSchemaValue extends AbstractSchemaItem {\n  protected type: string;\n\n  constructor(json: any, relativeId?: string, parent?: DontCodeSchemaItem) {\n    super(parent, relativeId);\n    this.type = json['type'];\n    this.targetPath = json['format'];\n  }\n\n  override isValue(): boolean {\n    return true;\n  }\n\n  getType(): string {\n    return this.type;\n  }\n}\n\n/**\n * This item is a reference (in json-schema term) to a definition elsewhere in the schema.\n */\nexport class DontCodeSchemaRef extends AbstractSchemaItem {\n  protected ref: string;\n  protected resolvedRef = new Map<string, DontCodeSchemaItem>();\n\n  constructor(json: any, relativeId?: string, parent?: DontCodeSchemaItem) {\n    super(parent, relativeId);\n    this.ref = json['$ref'];\n  }\n\n  override isReference(): boolean {\n    return true;\n  }\n\n  getReference(): string {\n    return this.ref;\n  }\n\n  resolveReference(resolved: DontCodeSchemaItem) {\n    this.resolvedRef.set('', resolved);\n  }\n\n  override getChildren(): IterableIterator<[string, DontCodeSchemaItem]> {\n    return this.resolvedRef.entries();\n  }\n}\n\n/**\n * An Object Item in the schema can define alternative subproperties that are used depending on some values.\n */\nexport class DontCodeSchemaProperty extends DontCodeSchemaObject {\n  protected replace: boolean;\n  protected posAfter?: string;\n\n  constructor(\n    json: DontCode.ChangeConfig,\n    relativeId: string,\n    parent: DontCodeSchemaItem\n  ) {\n    super(\n      {\n        type: 'object',\n        properties: json.props,\n      },\n      relativeId,\n      parent\n    );\n    if (json.replace) {\n      this.replace = json.replace;\n    } else {\n      this.replace = false;\n    }\n    this.posAfter = json.location.after;\n  }\n\n  isEmpty(): boolean {\n    return this.children.size == 0;\n  }\n\n  isReplace(): boolean {\n    return this.replace;\n  }\n\n  getPosAfter(): string | undefined {\n    return this.posAfter;\n  }\n}\n","export class DontCodeModel {\n  static readonly ROOT = 'creation';\n  static readonly APP_NAME_NODE = 'name';\n  static readonly APP_TYPE_NODE = 'type';\n  static readonly APP_TYPE =\n    DontCodeModel.ROOT + '/' + DontCodeModel.APP_TYPE_NODE;\n  static readonly APP_NAME =\n    DontCodeModel.ROOT + '/' + DontCodeModel.APP_NAME_NODE;\n  static readonly APP_ENTITIES_NODE = 'entities';\n  static readonly APP_ENTITIES =\n    DontCodeModel.ROOT + '/' + DontCodeModel.APP_ENTITIES_NODE;\n  static readonly APP_ENTITIES_FROM_NODE = 'from';\n  static readonly APP_ENTITIES_FROM =\n    DontCodeModel.APP_ENTITIES + '/' + DontCodeModel.APP_ENTITIES_FROM_NODE;\n  static readonly APP_ENTITIES_NAME_NODE = 'name';\n  static readonly APP_ENTITIES_NAME =\n    DontCodeModel.APP_ENTITIES + '/' + DontCodeModel.APP_ENTITIES_NAME_NODE;\n  static readonly APP_FIELDS_NODE = 'fields';\n  static readonly APP_FIELDS =\n    DontCodeModel.APP_ENTITIES + '/' + DontCodeModel.APP_FIELDS_NODE;\n  static readonly APP_FIELDS_NAME_NODE = 'name';\n  static readonly APP_FIELDS_NAME =\n    DontCodeModel.APP_FIELDS + '/' + DontCodeModel.APP_FIELDS_NAME_NODE;\n  static readonly APP_FIELDS_TYPE_NODE = 'type';\n  static readonly APP_FIELDS_TYPE =\n    DontCodeModel.APP_FIELDS + '/' + DontCodeModel.APP_FIELDS_TYPE_NODE;\n  static readonly APP_SHARING_NODE = 'sharing';\n  static readonly APP_SHARING =\n    DontCodeModel.ROOT + '/' + DontCodeModel.APP_SHARING_NODE;\n  static readonly APP_SHARING_WITH_NODE = 'with';\n  static readonly APP_SHARING_WITH =\n    DontCodeModel.APP_SHARING + '/' + DontCodeModel.APP_SHARING_WITH_NODE;\n  static readonly APP_REPORTS_NODE = 'reports';\n  static readonly APP_REPORTS =\n    DontCodeModel.ROOT + '/' + DontCodeModel.APP_REPORTS_NODE;\n  static readonly APP_REPORTS_TITLE_NODE = 'title';\n  static readonly APP_REPORTS_TITLE =\n    DontCodeModel.APP_REPORTS + '/' + DontCodeModel.APP_REPORTS_TITLE_NODE;\n  static readonly APP_REPORTS_FOR_NODE = 'for';\n  static readonly APP_REPORTS_FOR =\n    DontCodeModel.APP_REPORTS + '/' + DontCodeModel.APP_REPORTS_FOR_NODE;\n  static readonly APP_REPORTS_GROUP_NODE = 'groupedBy';\n  static readonly APP_REPORTS_GROUP =\n    DontCodeModel.APP_REPORTS + '/' + DontCodeModel.APP_REPORTS_GROUP_NODE;\n  static readonly APP_REPORTS_SORT_NODE = 'sortedBy';\n  static readonly APP_REPORTS_SORT =\n    DontCodeModel.APP_REPORTS + '/' + DontCodeModel.APP_REPORTS_SORT_NODE;\n  static readonly APP_REPORTS_DISPLAY_NODE = 'as';\n  static readonly APP_REPORTS_DISPLAY =\n    DontCodeModel.APP_REPORTS + '/' + DontCodeModel.APP_REPORTS_DISPLAY_NODE;\n  static readonly APP_REPORTS_GROUP_LABEL_NODE = 'label';\n  static readonly APP_REPORTS_GROUP_LABEL =\n    DontCodeModel.APP_REPORTS_GROUP + '/' + DontCodeModel.APP_REPORTS_GROUP_LABEL_NODE;\n  static readonly APP_REPORTS_GROUP_OF_NODE = 'of';\n  static readonly APP_REPORTS_GROUP_OF =\n    DontCodeModel.APP_REPORTS_GROUP + '/' + DontCodeModel.APP_REPORTS_GROUP_OF_NODE;\n  static readonly APP_REPORTS_GROUP_SHOW_NODE = 'show';\n  static readonly APP_REPORTS_GROUP_SHOW =\n    DontCodeModel.APP_REPORTS_GROUP + '/' + DontCodeModel.APP_REPORTS_GROUP_SHOW_NODE;\n  static readonly APP_REPORTS_GROUP_AGGREGATE_NODE = 'display';\n  static readonly APP_REPORTS_GROUP_AGGREGATE =\n    DontCodeModel.APP_REPORTS_GROUP + '/' + DontCodeModel.APP_REPORTS_GROUP_AGGREGATE_NODE;\n  static readonly APP_REPORTS_GROUP_AGGREGATE_LABEL_NODE = 'label';\n  static readonly APP_REPORTS_GROUP_AGGREGATE_LABEL =\n    DontCodeModel.APP_REPORTS_GROUP_AGGREGATE + '/' + DontCodeModel.APP_REPORTS_GROUP_AGGREGATE_LABEL_NODE;\n  static readonly APP_REPORTS_GROUP_AGGREGATE_OPERATION_NODE = 'operation';\n  static readonly APP_REPORTS_GROUP_AGGREGATE_OPERATION =\n    DontCodeModel.APP_REPORTS_GROUP_AGGREGATE + '/' + DontCodeModel.APP_REPORTS_GROUP_AGGREGATE_OPERATION_NODE;\n  static readonly APP_REPORTS_GROUP_AGGREGATE_OF_NODE = 'of';\n  static readonly APP_REPORTS_GROUP_AGGREGATE_OF =\n    DontCodeModel.APP_REPORTS_GROUP_AGGREGATE + '/' + DontCodeModel.APP_REPORTS_GROUP_AGGREGATE_OF_NODE;\n  static readonly APP_REPORTS_SORT_BY_NODE = 'by';\n  static readonly APP_REPORTS_SORT_BY =\n    DontCodeModel.APP_REPORTS_SORT + '/' + DontCodeModel.APP_REPORTS_SORT_BY_NODE;\n  static readonly APP_REPORTS_SORT_DIRECTION_NODE = 'direction';\n  static readonly APP_REPORTS_SORT_DIRECTION =\n    DontCodeModel.APP_REPORTS_SORT + '/' + DontCodeModel.APP_REPORTS_SORT_DIRECTION_NODE;\n  static readonly APP_REPORTS_DISPLAY_TITLE_NODE = 'title';\n  static readonly APP_REPORTS_DISPLAY_TITLE =\n    DontCodeModel.APP_REPORTS_DISPLAY + '/' + DontCodeModel.APP_REPORTS_DISPLAY_TITLE_NODE;\n  static readonly APP_REPORTS_DISPLAY_TYPE_NODE = 'type';\n  static readonly APP_REPORTS_DISPLAY_TYPE =\n    DontCodeModel.APP_REPORTS_DISPLAY + '/' + DontCodeModel.APP_REPORTS_DISPLAY_TYPE_NODE;\n  static readonly APP_REPORTS_DISPLAY_OF_NODE = 'of';\n  static readonly APP_REPORTS_DISPLAY_OF =\n    DontCodeModel.APP_REPORTS_DISPLAY + '/' + DontCodeModel.APP_REPORTS_DISPLAY_OF_NODE;\n  static readonly APP_REPORTS_DISPLAY_BY_NODE = 'by';\n  static readonly APP_REPORTS_DISPLAY_BY =\n    DontCodeModel.APP_REPORTS_DISPLAY + '/' + DontCodeModel.APP_REPORTS_DISPLAY_BY_NODE;\n  static readonly APP_SOURCES_NODE = 'sources';\n  static readonly APP_SOURCES =\n    DontCodeModel.ROOT + '/' + DontCodeModel.APP_SOURCES_NODE;\n  static readonly APP_SOURCES_NAME_NODE = 'name';\n  static readonly APP_SOURCES_NAME =\n    DontCodeModel.ROOT +\n    '/' +\n    DontCodeModel.APP_SOURCES_NODE +\n    '/' +\n    DontCodeModel.APP_SOURCES_NAME_NODE;\n  static readonly APP_SOURCES_TYPE_NODE = 'type';\n  static readonly APP_SOURCES_TYPE =\n    DontCodeModel.ROOT +\n    '/' +\n    DontCodeModel.APP_SOURCES_NODE +\n    '/' +\n    DontCodeModel.APP_SOURCES_TYPE_NODE;\n  static readonly APP_SOURCES_URL_NODE = 'url';\n  static readonly APP_SOURCES_URL =\n    DontCodeModel.ROOT +\n    '/' +\n    DontCodeModel.APP_SOURCES_NODE +\n    '/' +\n    DontCodeModel.APP_SOURCES_URL_NODE;\n  static readonly APP_SCREENS_NODE = 'screens';\n  static readonly APP_SCREENS =\n    DontCodeModel.ROOT + '/' + DontCodeModel.APP_SCREENS_NODE;\n  static readonly APP_SCREENS_NAME_NODE = 'name';\n  static readonly APP_SCREENS_NAME =\n    DontCodeModel.APP_SCREENS + '/' + DontCodeModel.APP_SCREENS_NAME_NODE;\n  static readonly APP_SCREENS_LAYOUT_NODE = 'layout';\n  static readonly APP_SCREENS_LAYOUT =\n    DontCodeModel.APP_SCREENS + '/' + DontCodeModel.APP_SCREENS_LAYOUT_NODE;\n  static readonly APP_COMPONENTS_NODE = 'components';\n  static readonly APP_COMPONENTS =\n    DontCodeModel.APP_SCREENS + '/' + DontCodeModel.APP_COMPONENTS_NODE;\n  static readonly APP_COMPONENTS_TYPE_NODE = 'type';\n  static readonly APP_COMPONENTS_TYPE =\n    DontCodeModel.APP_COMPONENTS + '/' + DontCodeModel.APP_COMPONENTS_TYPE_NODE;\n  static readonly APP_COMPONENTS_ENTITY_NODE = 'entity';\n  static readonly APP_COMPONENTS_ENTITY =\n    DontCodeModel.APP_COMPONENTS +\n    '/' +\n    DontCodeModel.APP_COMPONENTS_ENTITY_NODE;\n}\n","import { DontCodeModel } from './dont-code-model';\nimport { DontCodeSchemaManager } from './dont-code-schema-manager';\n\nexport class DontCodeSchema {\n  static ROOT = '/properties/' + DontCodeModel.ROOT;\n\n  /**\n   * This is a copy of dont-code-schema.json, please don't forget to update\n   */\n  static defaultv1 = {\n    \"$id\": \"https://dont-code.net/v1/dont-code-schema.json\",\n    \"$schema\": \"https://json-schema.org/draft/2020-12/schema\",\n    \"description\": \"JSON Schema v1 for dont-code\",\n    \"type\": \"object\",\n    \"required\": [\"creation\"],\n    \"properties\": {\n      \"creation\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"type\": {\n            \"enum\": [\"Application\"]\n          },\n          \"name\": {\n            \"type\": \"string\"\n          },\n          \"entities\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"$ref\": \"#/$defs/entity\"\n            }\n          },\n          \"sharing\": {\n            \"$ref\": \"#/$defs/sharing\"\n          },\n          \"reports\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"$ref\": \"#/$defs/report\"\n            }\n          },\n          \"sources\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"$ref\": \"#/$defs/source\"\n            }\n          },\n          \"screens\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"$ref\": \"#/$defs/screen\"\n            }\n          }\n        },\n        \"additionalProperties\": false\n      }\n    },\n    \"$defs\": {\n      \"entity\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"from\": {\n            \"type\": \"string\",\n            \"format\": \"$.creation.sources.name\"\n          },\n          \"name\": {\n            \"type\": \"string\"\n          },\n          \"fields\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"$ref\": \"#/$defs/field\"\n            }\n          }\n        },\n        \"additionalProperties\": false\n      },\n      \"field\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"name\": {\n            \"type\": \"string\"\n          },\n          \"type\": {\n            \"enum\": [\n              \"Text\",\n              \"Number\",\n              \"Boolean\",\n              {\n                \"Time\": {\n                  \"enum\": [\"Date\", \"Date & Time\", \"Time\"]\n                }\n              },\n              {\n                \"Money\": {\n                  \"enum\": [\"Dollar\", \"Euro\", \"Other currency\"]\n                },\n                \"Web\": {\n                  \"enum\": [\"Website (url)\", \"Image\"]\n                }\n              }, {\n                \"Special\": {\n                  \"enum\": [\"Reference\"]\n                }\n              }\n            ]\n          }\n        },\n        \"additionalProperties\": false\n      },\n      \"sharing\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"with\": {\n            \"enum\": [\"No-one\"]\n          }\n        },\n        \"additionalProperties\": false\n      },\n      \"source\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"name\": {\n            \"type\": \"string\"\n          },\n          \"type\": {\n            \"enum\": [\"Unknown\"]\n          }\n        }\n      },\n      \"report\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"title\": {\n            \"type\": \"string\"\n          },\n          \"for\": {\n            \"type\": \"string\",\n            \"format\": \"$.creation.entities.name\"\n          },\n          \"groupedBy\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"$ref\": \"#/$defs/report-group\"\n            }\n          },\n          \"sortedBy\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"$ref\": \"#/$defs/report-sort\"\n            }\n          },\n          \"as\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"$ref\": \"#/$defs/report-display\"\n            }\n          }\n        },\n        \"additionalProperties\": false\n      },\n      \"report-group\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"of\": {\n            \"type\": \"string\",\n            \"format\": \".fields.name\"\n          },\n          \"label\": {\n            \"type\": \"string\"\n          },\n          \"show\": {\n            \"enum\": [\"OnlyLowest\", \"OnlyHighest\"]\n          },\n          \"display\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"$ref\": \"#/$defs/report-group-aggregate\"\n            }\n          }\n        },\n        \"additionalProperties\": false\n      },\n      \"report-group-aggregate\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"operation\": {\n            \"enum\": [\"Count\", \"Sum\", \"Average\", \"Minimum\", \"Maximum\"]\n          },\n          \"of\": {\n            \"type\": \"string\",\n            \"format\": \".@parent.fields.name\"\n          },\n          \"label\": {\n            \"type\": \"string\"\n          }\n        },\n        \"additionalProperties\": false\n      },\n      \"report-sort\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"by\": {\n            \"type\": \"string\",\n            \"format\": \".fields.name\"\n          },\n          \"direction\": {\n            \"enum\": [\"None\", \"Ascending\", \"Descending\"]\n          }\n        },\n        \"additionalProperties\": false\n      },\n      \"report-display\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"type\": {\n            \"enum\": [\"Table\", \"Bar\", \"Line\", \"Pie\"]\n          },\n          \"of\": {\n            \"type\": \"string\",\n            \"format\": \".@parent.fields.name\"\n          },\n          \"by\": {\n            \"type\": \"string\",\n            \"format\": \".@parent.fields.name\"\n          },\n          \"title\": {\n            \"type\": \"string\"\n          }\n        },\n        \"additionalProperties\": false\n      },\n\n      \"screen\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"name\": {\n            \"type\": \"string\"\n          },\n          \"layout\": {\n            \"enum\": [\"Flow\", \"Grid\"]\n          },\n          \"components\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"$ref\": \"#/$defs/component\"\n            }\n          }\n        },\n        \"additionalProperties\": false\n      },\n      \"component\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"type\": {\n            \"enum\": [\"List\", \"Edit\", \"View\"]\n          },\n          \"entity\": {\n            \"type\": \"string\",\n            \"format\": \"$.creation.entities.name\"\n          }\n        },\n        \"additionalProperties\": false\n      }\n    }\n  }\n}\n\n  /**\n * Store all information needed to point to a single element in a model.\n */\n  export class DontCodeModelPointer {\n  position: string;\n\n  positionInSchema: string;\n\n  containerPosition?: string; // undefined as root does not have container...\n  containerPositionInSchema?: string; // undefined as root does not have container...\n\n  lastElement: string;\n  isProperty?: boolean;\n\n  constructor(\n    position: string,\n    schemaPosition: string,\n    containerPosition?: string,\n    containerSchemaPosition?: string,\n    lastElement?: string,\n    isProperty?: boolean\n  ) {\n    this.position = position;\n    this.positionInSchema = schemaPosition;\n    this.containerPosition = containerPosition;\n    this.containerPositionInSchema = containerSchemaPosition;\n    if (lastElement) this.lastElement = lastElement;\n    else this.lastElement = '';\n    this.isProperty = isProperty;\n    this.fillMissingElements();\n  }\n\n  fillMissingElements(optionalSchemaMgr?: DontCodeSchemaManager): void {\n    if (this.position == null || this.positionInSchema == null) {\n      throw new Error('Cannot fill Elements for an empty position');\n    }\n\n    if (this.containerPosition == null) {\n      this.containerPosition =\n        DontCodeModelPointer.parentPosition(this.position) ?? undefined;\n    }\n    if (this.containerPositionInSchema == null) {\n      this.containerPositionInSchema =\n        DontCodeModelPointer.parentPosition(this.positionInSchema) ?? undefined;\n    }\n    if (this.lastElement == null || this.lastElement.length == 0) {\n      this.lastElement =\n        DontCodeModelPointer.lastElementOf(this.position) ?? this.position;\n    }\n\n    if (this.isProperty == null && optionalSchemaMgr) {\n      if (this.containerPositionInSchema)\n        this.isProperty =\n          optionalSchemaMgr\n            .locateItem(this.containerPositionInSchema, true)\n            .getChild(this.lastElement) != null;\n      else this.isProperty = true; // We only have properties at root level\n    }\n  }\n\n  /**\n   * Finds the last element of this position\n   * @param position\n   */\n  public static lastElementOf(position?: string): string | undefined {\n    if (position == null) return position;\n    return position.substring(position.lastIndexOf('/') + 1);\n  }\n\n  /**\n   * Finds the next item in the position and returns its value and position in the string\n   * @param position\n   * @param from\n   */\n  public static nextItemAndPosition(\n    position: string,\n    from: number\n  ): { pos: number; value: string | null } {\n    let posSlash = position.indexOf('/', from);\n    if (posSlash === from) {\n      from = from + 1;\n      posSlash = position.indexOf('/', from);\n    }\n    if (posSlash !== -1) posSlash = posSlash - 1;\n    else {\n      if (posSlash === from) {\n        posSlash = -1;\n      } else {\n        posSlash = position.length - 1;\n      }\n    }\n\n    let value = null;\n    if (posSlash !== -1) value = position.substring(from, posSlash + 1);\n\n    return {\n      pos: posSlash,\n      value: value,\n    };\n  }\n\n  /**\n   * Find the name of the last element pointed by this pointer\n   * Usually it's the value of key (if it's a field) or the last container name (if it's an element in a container like entity/a/fields/a)\n   * @deprecated\n   */\n\n  calculateKeyOrContainer(): string {\n    if (this.isProperty === true) {\n      return this.lastElement;\n    } else {\n      return DontCodeModelPointer.lastElementOf(this.containerPosition) ?? '';\n    }\n  }\n\n  /**\n   * Find the ItemId or container key represented by the pointer\n   * Usually it's the id of the item (if it's an element in a container like entity/a/fields/a) or the last container name\n   * @Deprecated\n   */\n  calculateItemIdOrContainer(): string | undefined {\n    if (this.isProperty === false) {\n      return this.lastElement;\n    } else {\n      return DontCodeModelPointer.lastElementOf(this.containerPosition) ?? '';\n    }\n  }\n\n  /**\n   * If this pointer is pointing to a direct property of the given pointer, then it returns the property's name, otherwise null\n   * @param pointer\n   * @return the property name or null\n   */\n  isSubItemOf(pointer: DontCodeModelPointer): string | null {\n    if (pointer.position === this.containerPosition) {\n      return this.lastElement;\n    } else return null;\n  }\n\n  /**\n   * Returns the direct property's name under which this pointer points to, even if it's pointing to sub properties of the direct property.\n   * @param pointer\n   * @return the property name or null\n   */\n  isUnderSubItemOf(pointer: DontCodeModelPointer): string | null {\n    if (this.positionInSchema.startsWith(pointer.positionInSchema)) {\n      const keyPos = this.positionInSchema.indexOf(\n        '/',\n        pointer.positionInSchema.length + 1\n      );\n      if (keyPos == -1)\n        return this.positionInSchema.substring(\n          pointer.positionInSchema.length + 1\n        );\n      else\n        return this.positionInSchema.substring(\n          pointer.positionInSchema.length + 1,\n          keyPos\n        );\n    } else return null;\n  }\n\n  /**\n   * Returns a pointer pointing to a sub Item of the current pointer.\n   * The current pointer must point to an array\n   * @param subItem\n   */\n  subItemOrPropertyPointer(\n    subElement: string,\n    isItem: boolean\n  ): DontCodeModelPointer {\n    if (isItem) return this.subPropertyPointer(subElement);\n    else return this.subItemPointer(subElement);\n  }\n\n  /**\n   * Returns a pointer pointing to a sub property of the current pointer\n   * @param subProp\n   */\n  subPropertyPointer(subProp: string): DontCodeModelPointer {\n    const newPointer = new DontCodeModelPointer(\n      this.position === '' ? subProp : this.position + '/' + subProp,\n      this.positionInSchema === ''\n        ? subProp\n        : this.positionInSchema + '/' + subProp,\n      this.position,\n      this.positionInSchema,\n      subProp,\n      true\n    );\n    return newPointer;\n  }\n\n  /**\n   * Returns a pointer pointing to a sub Item of the current pointer.\n   * The current pointer must point to an array\n   * @param subItem\n   */\n  subItemPointer(subItem: string): DontCodeModelPointer {\n    const newPointer = new DontCodeModelPointer(\n      this.position === '' ? subItem : this.position + '/' + subItem,\n      this.positionInSchema,\n      this.position,\n      this.containerPositionInSchema,\n      subItem,\n      false\n    );\n    return newPointer;\n  }\n\n    /**\n     * Returns the parent pointer or an exception if it's the root\n     * @param subItem\n     */\n    safeParentPointer(optionalSchemaMgr?: DontCodeSchemaManager): DontCodeModelPointer {\n      const ret = this.parentPointer(optionalSchemaMgr);\n      if( ret===undefined)\n        throw new Error(\"No parent position for pointer \"+this.position);\n      return ret;\n    }\n\n    /**\n     * Returns the parent pointer or undefined if it's the root\n     * @param subItem\n     */\n    parentPointer(optionalSchemaMgr?: DontCodeSchemaManager): DontCodeModelPointer|undefined {\n      if( (this.containerPosition==null) || (this.containerPositionInSchema==null))\n        return undefined;\n      const newPointer = new DontCodeModelPointer(\n        this.containerPosition,\n        this.containerPositionInSchema\n      );\n      if( optionalSchemaMgr!=null) {\n        newPointer.fillMissingElements(optionalSchemaMgr);\n      }\n      return newPointer;\n    }\n\n    /**\n     * Returns true if the pointer is the parent of the position.\n     * @param position\n     * @param directOnly: if true, only returns true if it's a direct parent\n     */\n    public isParentOf (position:string, directOnly?:boolean): boolean {\n      if (directOnly===true) {\n        const parent=DontCodeModelPointer.parentPosition(position);\n        if( parent==null) {\n          return false;\n        } else {\n          return this.position == parent;\n        }\n      }else {\n        return position.startsWith(this.position);\n      }\n    }\n\n    /**\n   * Safely returns the parent position\n   * @param position\n   */\n  public static parentPosition(position?: string): string | null {\n    if (position == null || position.length === 0) return null;\n    const lastSlash = position.lastIndexOf('/');\n    if (lastSlash == -1) return '';\n    else {\n      return position.substring(0, lastSlash);\n    }\n  }\n\n\n  /**\n   * Safely splits between the parent position and last element\n   * @param position\n   */\n  public static splitPosition(\n    position?: string\n  ): { parent: string; element: string } | null {\n    if (position == null || position.length === 0) return null;\n    const lastSlash = position.lastIndexOf('/');\n    if (lastSlash == -1)\n      return {\n        parent: '',\n        element: position,\n      };\n    else {\n      return {\n        parent: position.substring(0, lastSlash),\n        element: position.substring(lastSlash + 1),\n      };\n    }\n  }\n}\n","import {\n  DontCodeSchemaItem,\n  DontCodeSchemaRef,\n  DontCodeSchemaRoot,\n} from './dont-code-schema-item';\nimport { DontCodeModelPointer, DontCodeSchema } from './dont-code-schema';\nimport { PluginConfig } from '../globals';\n\n/**\n * Manages the schema used to describe an application in Dont-code.\n * A schema is provided by default, but can be updated by plugins.\n * That means plugins can add or modify new fields or entities thus changing the way applications are edited and described.\n */\nexport class DontCodeSchemaManager {\n  protected currentSchema!: DontCodeSchemaRoot;\n  protected readSchema: any;\n\n  constructor() {\n    this.reset();\n  }\n  /**\n   * Returns the current schema\n   */\n  getSchema(): DontCodeSchemaItem {\n    return this.currentSchema;\n  }\n\n  convertSchemaToMap(readSchema: any): DontCodeSchemaRoot {\n    return new DontCodeSchemaRoot(readSchema);\n  }\n\n  registerChanges(config: PluginConfig) {\n    const pluginFullName = config.plugin.id + '-v' + config.plugin.version;\n    if (config['schema-updates']) {\n      const updates = config['schema-updates'];\n      for (const update of updates) {\n        const changes = update.changes;\n        for (const change of changes) {\n          if (change.location.id) {\n            const parent = this.locateItem(change.location.parent);\n            if (parent) {\n              parent.upsertWith(change);\n            } else {\n              throw 'Cannot find parent element: ' + change.location.parent;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Locate an item from it's position in the model\n   * @param schemaPosition\n   * @param resolveReference true to resolve the last reference instead of returning a @DontCodeSchemaRef\n   */\n  locateItem(\n    schemaPosition: string,\n    resolveReference?: boolean\n  ): DontCodeSchemaItem {\n    const split = schemaPosition.split('/');\n    let cur: DontCodeSchemaItem | undefined = this.currentSchema;\n    for (const value of split) {\n      if (!cur) {\n        console.error(\n          'Could not find subItem ' + value + ' of ' + schemaPosition\n        );\n        throw new Error(\n          'Could not find subItem ' + value + ' of ' + schemaPosition\n        );\n      }\n      if (value && value.length > 0 && value !== '#') {\n        if (cur.isReference())\n          cur = this.resolveReference(cur as DontCodeSchemaRef);\n        if (!cur) {\n          console.error(\n            'Could not find reference ' +\n              (cur as unknown as DontCodeSchemaRef)?.getReference() +\n              ' of ' +\n              schemaPosition\n          );\n          throw new Error(\n            'Could not find reference ' +\n              (cur as unknown as DontCodeSchemaRef)?.getReference() +\n              ' of ' +\n              schemaPosition\n          );\n        }\n        cur = cur.getChild(value);\n      }\n    }\n\n    if (resolveReference && cur?.isReference()) {\n      cur = this.resolveReference(cur as DontCodeSchemaRef);\n    }\n    if (cur!=null)\n      return cur;\n    else {\n      throw new Error(\n        'Could not find item at schema position ' + schemaPosition);\n\n    }\n  }\n\n  resolveReference(ref: DontCodeSchemaRef): DontCodeSchemaItem {\n    return this.locateItem(ref.getReference());\n  }\n\n  generateParentPointer(\n    pointer: DontCodeModelPointer\n  ): DontCodeModelPointer | undefined {\n    if (pointer.containerPosition != null)\n      return this.generateSchemaPointer(pointer.containerPosition);\n    return;\n  }\n\n  /**\n   * Generates a new and complete DontCodeModelPointer from the specified position\n   * @param queriedPosition\n   */\n  generateSchemaPointer(queriedPosition: string): DontCodeModelPointer {\n    let ret: DontCodeModelPointer;\n\n    const position = queriedPosition;\n    const posElems = position.split('/');\n\n    if (posElems.length === 0 || posElems[0].length === 0) {\n      // Managing the special case of asking for root\n      ret = new DontCodeModelPointer(queriedPosition, queriedPosition);\n      return ret;\n    } else {\n      ret = new DontCodeModelPointer(queriedPosition, '');\n    }\n\n    let parentItem = this.currentSchema as DontCodeSchemaItem;\n    let ignoreNext = false;\n    for (const element of posElems) {\n      if (!ignoreNext) {\n        let nextItem =\n          parentItem.getChild(element) ??\n          parentItem.isPossibleDynamicProperty(element);\n        if (nextItem) {\n          ret.isProperty = true;\n          ret.containerPositionInSchema = ret.positionInSchema;\n          if (ret.positionInSchema !== null && ret.positionInSchema.length > 0)\n            ret.positionInSchema = ret.positionInSchema + '/' + element;\n          else ret.positionInSchema = element;\n\n          if (nextItem.isArray()) {\n            ignoreNext = true;\n          } else {\n            ignoreNext = false;\n          }\n\n          if (nextItem.isReference())\n            nextItem = this.resolveReference(nextItem as DontCodeSchemaRef);\n\n          if (nextItem == null) {\n            // Cannot find the next item in the schema: Error in the url\n            throw new Error(\n              \"Cannot parse '\" +\n                position +\n                \"' from the schema as \" +\n                nextItem +\n                ' is reference an unknown element'\n            );\n          }\n          parentItem = nextItem;\n        } else {\n          // Cannot find the next item in the schema: Error in the url\n          throw new Error(\n            \"Cannot parse '\" +\n              position +\n              \"' from the schema as \" +\n              element +\n              ' is not a child of ' +\n              parentItem.getRelativeId()\n          );\n        }\n      } else {\n        ret.isProperty = false;\n        ignoreNext = false;\n      }\n    }\n\n    ret.containerPositionInSchema = ret.positionInSchema.substring(\n      0,\n      ret.positionInSchema.lastIndexOf('/')\n    );\n    ret.containerPosition = ret.position.substring(\n      0,\n      ret.position.lastIndexOf('/')\n    );\n    ret.lastElement = posElems[posElems.length - 1];\n\n    return ret;\n  }\n\n  /**\n   * Returns the pointer to the subElement of the given pointer. It checked whether the given propOrItemName is a property or an item\n   * by looking at the schema\n   * @param panullrent\n   * @param propOrItemName\n   */\n  generateSubSchemaPointer(\n    parent: DontCodeModelPointer,\n    propOrItemName: string\n  ): DontCodeModelPointer {\n    if (\n      this.locateItem(parent.positionInSchema, true).getChild(propOrItemName)\n    ) {\n      return parent.subPropertyPointer(propOrItemName);\n    } else {\n      return parent.subItemPointer(propOrItemName);\n    }\n  }\n\n  reset() {\n    this.readSchema = DontCodeSchema.defaultv1;\n    this.currentSchema = this.convertSchemaToMap(this.readSchema);\n  }\n}\n","import {DontCodeSchemaManager} from '../model/dont-code-schema-manager';\nimport * as DontCode from '../globals';\nimport {DontCodePreviewManager} from './preview/dont-code-preview-manager';\nimport PluginConfig = DontCode.PluginConfig;\n\nexport class DontCodePluginManager {\n  protected plugins: Map<string, PluginInfo> = new Map();\n\n  registerPlugin(\n    plugin: DontCode.Plugin,\n    schemaManager: DontCodeSchemaManager,\n    previewManager: DontCodePreviewManager\n  ) {\n    // Ensure registering plugins only once.\n    const config: PluginConfig = plugin.getConfiguration();\n    const fullId = config.plugin.id + '-v' + config.plugin.version;\n\n    if( this.plugins.get(fullId)==null) {\n      //console.debug (\"Setting up\", fullId);\n      schemaManager.registerChanges(config);\n      previewManager.registerHandlers(config);\n\n      this.plugins.set(fullId, new PluginInfo (plugin));\n    } else {\n      //console.debug(\"Plugin \"+fullId+\" already registered, skipping it\");\n    }\n  }\n\n  initPlugins (core:DontCode.Core): void {\n    this.plugins.forEach(plugin => {\n      if (plugin.initCalled===false) {\n        try {\n            // Initialize the change of model\n          const defs = plugin.plugin.getConfiguration()?.[\"definition-updates\"];\n          core.getChangeManager().applyPluginConfigUpdates(defs);\n          plugin.plugin.pluginInit(core);\n          plugin.initCalled=true;\n        } catch (error) {\n          console.error(\"Error calling \"+plugin.plugin+\" init method:\", error);\n        }\n      }\n    });\n  }\n\n  reset() {\n    this.plugins.clear();\n  }\n}\n\nclass PluginInfo {\n  plugin: DontCode.Plugin;\n  initCalled:boolean;\n\n  constructor(plugin: DontCode.Plugin, initCalled?: boolean) {\n    this.plugin=plugin;\n    if (initCalled==null)\n      this.initCalled=false;\n    else\n      this.initCalled=initCalled;\n  }\n}\n","import {ActionHandlerConfig, ChangeHandlerConfig, PluginConfig} from '../../globals';\nimport { Observable, ReplaySubject, Subject, Subscription } from 'rxjs';\nimport {ActionHandler} from \"../action-handler\";\n\n/**\n * Manages handlers that provides UI, calculation or action for data associated with an element.\n * It decodes \"preview-handlers\", \"global-handlers\", \"action-handlers\" from plugin-config.\n */\nexport class DontCodePreviewManager {\n  protected handlersPerLocations!: Map<string, ChangeHandlerConfig[]>;\n  protected globalHandlersPerLocations!: Map<string, ChangeHandlerConfig[]>;\n  protected actionHandlersPerLocation!: Map<{ position:string, context:string }, ActionHandlerConfig[]>;\n  protected globalHandlers!: ReplaySubject<ChangeHandlerConfig>;\n\n  constructor() {\n    this.reset();\n  }\n\n  reset() {\n    this.handlersPerLocations = new Map<string, ChangeHandlerConfig[]>();\n    this.globalHandlersPerLocations = new Map<string, ChangeHandlerConfig[]>();\n    this.actionHandlersPerLocation = new Map();\n    this.globalHandlers = new ReplaySubject();\n  }\n\n  registerHandlers(config: PluginConfig): void {\n    if (config['preview-handlers']) {\n      config['preview-handlers'].forEach((value) => {\n        let array = this.handlersPerLocations.get(value.location.parent);\n        if (!array) {\n          array = new Array<ChangeHandlerConfig>();\n          this.handlersPerLocations.set(value.location.parent, array);\n        }\n        array.push(value);\n      });\n    }\n    if (config['global-handlers']) {\n      config['global-handlers'].forEach((value) => {\n        let array = this.handlersPerLocations.get(value.location.parent);\n        if (!array) {\n          array = new Array<ChangeHandlerConfig>();\n          this.handlersPerLocations.set(value.location.parent, array);\n        }\n        array.push(value);\n        // Update the global handlers as well\n        array = this.globalHandlersPerLocations.get(value.location.parent);\n        if (!array) {\n          array = new Array<ChangeHandlerConfig>();\n          this.globalHandlersPerLocations.set(value.location.parent, array);\n        }\n        array.push(value);\n        this.globalHandlers.next(value);\n      });\n    }\n    if (config['action-handlers']) {\n      for (const value of config['action-handlers']) {\n        let array = this.actionHandlersPerLocation.get({position:value.location.parent, context:value[\"action-context\"]});\n        if (!array) {\n          array = new Array<ActionHandlerConfig>();\n          this.actionHandlersPerLocation.set({position:value.location.parent, context:value[\"action-context\"]}, array);\n        }\n        array.push(value);\n\n      }\n    }\n  }\n\n  getGlobalHandlers(): Map<string, Array<ChangeHandlerConfig>> {\n    return this.globalHandlersPerLocations;\n  }\n\n  receiveGlobalHandlers(): Observable<ChangeHandlerConfig> {\n    return this.globalHandlers;\n  }\n\n  retrieveHandlerConfig(\n    position: string,\n    modelContent?: any\n  ): ChangeHandlerConfig | null {\n    const found = this.handlersPerLocations.get(position);\n    let ret: ChangeHandlerConfig | null = null;\n    let contentNeeded = false;\n\n    if (found) {\n      for (const configuration of found) {\n        if (configuration.location.values) {\n          if (modelContent) {\n            let jsonValue = modelContent as string;\n            if (configuration.location.id)\n              jsonValue = modelContent[configuration.location.id];\n\n            this.extractValuesAsArray(configuration.location.values).forEach(\n              (targetValue) => {\n                if (targetValue === jsonValue) {\n                  ret = configuration;\n                  return;\n                }\n              }\n            );\n          } else {\n            // We found one handler that needs the jsonContent\n            contentNeeded = true;\n          }\n        } else {\n          // We have found a default handler, we keep it but keep on looking for a better one\n          if (ret === null) {\n            ret = configuration;\n          }\n        }\n      }\n    } else {\n      // Try to see if the parent position is handled\n      if (typeof modelContent === 'string' && position.lastIndexOf('/') > 0) {\n        if (position.endsWith('/'))\n          position = position.substring(0, position.length - 1);\n\n        const key = position.substring(position.lastIndexOf('/') + 1);\n        const parentValue: { [index: string]: string } = {};\n        parentValue[key] = modelContent;\n        return this.retrieveHandlerConfig(\n          position.substring(0, position.lastIndexOf('/')),\n          parentValue\n        );\n      }\n    }\n\n    if (ret === null && contentNeeded) {\n      // We had one potential handler but couldn't select it as the jsonContent is not provided\n      throw new Error(\n        'Content must be provided in order to select an handler for position ' +\n          position\n      );\n    }\n    return ret;\n  }\n\n  /**\n   * Returns all the action handlers for a given position in the model and for a given context.\n   * @param position\n   * @param context\n   * @param modelContent\n   */\n  retrieveActionHandlers(    position: string, context:string, modelContent?: any ): ActionHandlerConfig[] {\n    const ret= this.actionHandlersPerLocation.get({position, context});\n    if( ret==null)\n      return [];\n    else\n      return ret;\n  }\n\n  private extractValuesAsArray(values: any): Array<string> {\n    const ret = new Array<string>();\n    this.extractValuesToArray(values, ret);\n    return ret;\n  }\n\n  private extractValuesToArray(values: any, res: Array<string>) {\n    if (Array.isArray(values)) {\n      (values as Array<string>).forEach((value) => {\n        if (typeof value === 'string') {\n          res.push(value);\n        } else {\n          this.extractValuesToArray(value, res);\n        }\n      });\n    } else {\n      for (const key in values) {\n        if (values.hasOwnProperty(key)) {\n          this.extractValuesToArray(values[key], res);\n        }\n      }\n    }\n  }\n}\n","import { DontCodeSchemaManager } from './model/dont-code-schema-manager';\nimport { DontCodePreviewManager } from './plugin/preview/dont-code-preview-manager';\nimport { DontCodeStoreManager } from './store/dont-code-store-manager';\nimport { DontCodeModelManager } from './model/dont-code-model-manager';\nimport {DontCodeChangeManager} from \"./change/dont-code-change-manager\";\n\nexport interface Core {\n  getSchemaUri(): string;\n  registerPlugin(plugin: Plugin): void;\n  initPlugins (): void;\n  getSchemaManager(): DontCodeSchemaManager;\n  getModelManager(): DontCodeModelManager;\n  getChangeManager(): DontCodeChangeManager;\n  getPreviewManager(): DontCodePreviewManager;\n  getStoreManager(): DontCodeStoreManager;\n  reset(): Core;\n}\n\nexport interface Plugin {\n  getConfiguration(): PluginConfig;\n  /**\n   * Once all plugins have been loaded, each one pluginInit's is being called.\n   * @param dontCode\n   */\n  pluginInit (dontCode: Core): void;\n}\n\n/**\n * The typescript equivalent of the dont-code-schema.json\n */\nexport interface DontCodeSchemaType {\n  creation: {\n    type: string;\n    name: string;\n    entities?: {[key:string]:DontCodeEntityType};\n    sharing?: DontCodeSharingType;\n    reports?: {[key:string]:DontCodeReportType};\n    sources?: {[key:string]:DontCodeSourceType};\n    screens?: Array<{\n      name: string;\n    }>;\n  };\n}\n\nexport interface DontCodeEntityType {\n  from?: string;\n  name: string;\n  fields?: {[key:string]:DontCodeFieldType};\n}\n\nexport interface DontCodeFieldType {\n  name: string;\n  type: string;\n}\n\nexport interface DontCodeSharingType {\n  with: string;\n}\n\nexport interface DontCodeReportType {\n  title: string;\n  for: string;\n  groupedBy?: {[key:string]:DontCodeReportGroupType};\n  sortedBy?: {[key:string]:DontCodeReportSortType};\n  as?: {[key:string]:DontCodeReportDisplayType};\n}\n\nexport interface DontCodeReportGroupType {\n  of: string,\n  display:{[key:string]:DontCodeReportGroupAggregateType};\n  show?:DontCodeReportGroupShowType,\n  label?:string,\n}\n\nexport interface DontCodeReportGroupAggregateType {\n  operation: DontCodeGroupOperationType;\n  of:string,\n  label?:string\n}\n\nexport enum DontCodeReportGroupShowType {\n  OnlyLowest=\"OnlyLowest\",\n  OnlyHighest=\"OnlyHighest\"\n}\n\nexport enum DontCodeGroupOperationType {\n  Count= \"Count\",\n  Sum=\"Sum\",\n  Average=\"Average\",\n  Minimum=\"Minimum\",\n  Maximum=\"Maximum\"\n}\n\nexport interface DontCodeReportSortType {\n  by:string,\n  direction: DontCodeSortDirectionType\n}\n\nexport enum DontCodeSortDirectionType {\n  None = \"None\",\n  Ascending = \"Ascending\",\n  Descending = \"Descending\"\n}\n\nexport interface DontCodeReportDisplayType {\n  type: string;\n  of: string;\n  by?:string;\n  title: string;\n}\n\nexport interface DontCodeSourceType {\n  name: string;\n  type: string;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\nexport interface DontCodeSharingType {\n\n}\n\n/**\n * The typescript equivalent of plugin-config-schema.json\n */\nexport interface PluginConfig {\n  plugin: {\n    id: string;\n    'display-name'?: string;\n    version: string;\n  };\n  'schema-updates'?: Array<{\n    id: string;\n    description?: string;\n    changes: Array<ChangeConfig>;\n  }>;\n  'preview-handlers'?: Array<ChangeHandlerConfig>;\n  'global-handlers'?: Array<ChangeHandlerConfig>;\n  'action-handlers'?: Array<ActionHandlerConfig>;\n  'definition-updates'?: Array<DefinitionUpdateConfig>\n}\n\nexport interface ChangeConfig {\n  location: LocationConfig;\n  update?: any;\n  props?: any;\n  replace?: boolean;\n}\n\nexport interface ChangeHandlerConfig {\n  location: LocationConfig;\n  class: {\n    source: string;\n    name: string;\n  };\n}\n\nexport interface LocationConfig {\n  parent: string;\n  id?: string;\n  after?: string;\n  values?: any;\n}\n\nexport interface DefinitionUpdateConfig {\n  location: LocationConfig;\n  update: any;\n}\n\nexport interface ChangeHandlerConfig {\n  location: LocationConfig;\n  class: ClassDefinitionConfig;\n}\n\nexport interface ClassDefinitionConfig {\n  source: string;\n  name: string;\n}\n\nexport interface ActionHandlerConfig {\n  location: LocationConfig;\n  'action-context': ActionContextType;\n  actions: Array<ActionConfig>;\n  class: ClassDefinitionConfig\n}\n\nexport enum ActionContextType {\n  LIST=\"list\",\n  EDIT=\"edit\",\n  VIEW=\"view\"\n}\n\nexport interface ActionConfig {\n  type:ActionType;\n  'display-name':string;\n  icon: IconDefinitionConfig;\n}\n\nexport enum ActionType {\n  EXTRACT=\"extract\",\n  UPDATE=\"update\",\n  CALCULATE=\"calculate\"\n}\n\nexport interface IconDefinitionConfig {\n  url?:string;\n}\n\n\n/**\n * The typescript equivalent of repository-schema.json\n */\nexport interface RepositorySchema {\n  name:string,\n  description?:string,\n  plugins: Array<RepositoryPluginEntry>\n}\n\nexport interface RepositoryPluginEntry {\n  id:string,\n  \"display-name\"?:string,\n  version:string,\n  info?: RepositoryPluginInfo,\n  config?: RepositoryPluginConfig\n}\n\nexport interface RepositoryPluginInfo {\n  \"exposed-module\":string,\n  \"remote-entry\"?:string\n}\n\nexport interface RepositoryPluginConfig {\n  \"definition-updates\"?:Array<DefinitionUpdateConfig>\n}\n\nexport {};\n","import {DontCodeStoreProvider,} from './dont-code-store-provider';\nimport {DontCodeModelManager} from '../model/dont-code-model-manager';\nimport {\n  DontCodeGroupOperationType,\n  DontCodeReportGroupAggregateType, DontCodeReportGroupShowType,\n  DontCodeReportGroupType,\n  DontCodeReportSortType,\n  DontCodeSortDirectionType,\n  DontCodeSourceType\n} from '../globals';\nimport {DontCodeModel} from '../model/dont-code-model';\nimport {DontCodeStorePreparedEntities} from \"./store-provider-helper\";\nimport {Observable} from \"rxjs\";\nimport {DontCodeDataTransformer} from \"./dont-code-data-transformer\";\n\nexport class DontCodeStoreManager {\n  private _default?: DontCodeStoreProvider<never>;\n  private providerByPosition = new Map<string, DontCodeStoreProvider<never>>();\n  private providerByType = new Map<string, DontCodeStoreProvider<never>>();\n\n  constructor(\n    protected modelMgr: DontCodeModelManager,\n    provider?: DontCodeStoreProvider<never>\n  ) {\n    this._default = provider;\n    this.reset();\n  }\n\n  reset() {\n    this.providerByPosition.clear();\n    this.providerByType.clear();\n  }\n\n  getProvider<T>(position?: string): DontCodeStoreProvider<T> | undefined {\n    if (position == null) {\n      return this._default;\n    } else {\n      let ret = null;\n      // Try to find if the entity is loaded from a defined source\n      const srcDefinition = this.modelMgr.findTargetOfProperty(\n        DontCodeModel.APP_ENTITIES_FROM_NODE,\n        position\n      )?.value as DontCodeSourceType;\n      if (srcDefinition) {\n        ret = this.providerByType.get(srcDefinition.type);\n      }\n      if (!ret) {\n        ret = this.providerByPosition.get(position);\n      }\n      return ret ?? this._default;\n    }\n  }\n\n  getProviderSafe<T=never>(position?: string): DontCodeStoreProvider<T> {\n    const ret = this.getProvider<T>(position);\n    if (ret == null) {\n      throw new Error('Trying to get an undefined or null provider');\n    } else {\n      return ret;\n    }\n  }\n\n  getDefaultProvider<T=never>(): DontCodeStoreProvider<T> | undefined {\n    return this.getProvider();\n  }\n\n  getDefaultProviderSafe<T=never>(): DontCodeStoreProvider<T> {\n    return this.getProviderSafe();\n  }\n\n  setProvider(value: DontCodeStoreProvider<never>, position?: string): void {\n    if (position == null) this._default = value;\n    else {\n      this.providerByPosition.set(position, value);\n    }\n  }\n\n  setProviderForSourceType(\n    value: DontCodeStoreProvider<never>,\n    srcType: string\n  ): void {\n    this.providerByType.set(srcType, value);\n  }\n\n  setDefaultProvider(value: DontCodeStoreProvider<never>): void {\n    this.setProvider(value);\n  }\n\n  removeProvider(position?: string): void {\n    if (position == null) this._default = undefined;\n    else {\n      this.providerByPosition.delete(position);\n    }\n  }\n\n  removeProviderForSourceType(srcType: string): void {\n    this.providerByType.delete(srcType);\n  }\n\n  removeDefaultProvider(): void {\n    this.removeProvider();\n  }\n\n  storeEntity<T=never>(position: string, entity: T): Promise<T> {\n    return this.getProviderSafe<T>(position).storeEntity(position, entity);\n  }\n\n  loadEntity<T=never>(position: string, key: any): Promise<T|undefined> {\n    return this.getProviderSafe<T>(position).loadEntity(position, key);\n  }\n\n  safeLoadEntity<T=never>(position: string, key: any): Promise<T> {\n    return this.getProviderSafe<T>(position).safeLoadEntity(position, key);\n  }\n\n  deleteEntity(position: string, key: any): Promise<boolean> {\n    return this.getProviderSafe(position).deleteEntity(position, key);\n  }\n\n  searchEntities<T=never>(\n    position: string,\n    ...criteria: DontCodeStoreCriteria[]\n  ): Observable<Array<T>> {\n    return this.getProviderSafe<T>(position).searchEntities(position, ...criteria);\n  }\n\n  searchAndPrepareEntities<T=never>(\n    position: string,\n    sort?:DontCodeStoreSort,\n    groupBy?:DontCodeStoreGroupby,\n    dataTransformer?:DontCodeDataTransformer,\n    ...criteria: DontCodeStoreCriteria[]\n  ): Observable<DontCodeStorePreparedEntities<T>> {\n    return this.getProviderSafe<T>(position).searchAndPrepareEntities(position, sort, groupBy, dataTransformer, ...criteria);\n  }\n\n\n  canStoreDocument(position?: string): boolean {\n    const res = this.getProvider(position)?.canStoreDocument(position);\n    if (res) return res;\n    else return false;\n  }\n\n  storeDocuments(\n    toStore: File[],\n    position?: string\n  ): Observable<UploadedDocumentInfo> {\n    return this.getProviderSafe(position).storeDocuments(toStore, position);\n  }\n\n}\n\nexport type UploadedDocumentInfo = {\n  documentName: string;\n  isUrl: boolean;\n  documentId?: string;\n};\n\nexport enum DontCodeStoreCriteriaOperator {\n  EQUALS = '=',\n  LESS_THAN = '<',\n  LESS_THAN_EQUAL = '<=',\n}\n\nexport class DontCodeStoreCriteria {\n  name: string;\n  value: any;\n  operator: DontCodeStoreCriteriaOperator;\n\n  constructor(\n    name: string,\n    value: any,\n    operator?: DontCodeStoreCriteriaOperator\n  ) {\n    this.name = name;\n    this.value = value;\n    if (!operator) this.operator = DontCodeStoreCriteriaOperator.EQUALS;\n    else {\n      this.operator = operator;\n    }\n  }\n}\n\nexport class DontCodeStoreSort implements DontCodeReportSortType {\n\n  direction: DontCodeSortDirectionType;\n\n  constructor(public by: string, direction?:DontCodeSortDirectionType, public subSort?:DontCodeStoreSort) {\n    if (direction==null)   this.direction=DontCodeSortDirectionType.None;\n    else this.direction=direction;\n  }\n}\n\nexport class DontCodeStoreGroupby implements DontCodeReportGroupType {\n  display:{[key:string]:DontCodeStoreAggregate};\n\n  constructor(public of:string, display?:{[key:string]:DontCodeStoreAggregate}, public show?:DontCodeReportGroupShowType) {\n    if (display==null) this.display={};\n    else this.display=display;\n  }\n\n  public atLeastOneGroupIsRequested (): boolean {\n    if( (this.display!=null) && (Object.keys(this.display).length>0))\n      return true;\n    return false;\n  }\n\n  getRequiredListOfFields(): Set<string> {\n    const ret = new Set<string>();\n    if( this.display!=null) {\n      for (const aggregate of Object.values(this.display)) {\n        ret.add(aggregate.of);\n      }\n    }\n    return ret;\n  }\n}\n\nexport class DontCodeStoreAggregate implements DontCodeReportGroupAggregateType{\n  constructor(public of:string, public operation:DontCodeGroupOperationType) {\n  }\n}\n","import { DontCodeModelPointer } from '../model/dont-code-schema';\n\nexport class Change {\n  type: ChangeType;\n  position: string;\n  value: any;\n  pointer?: DontCodeModelPointer;\n  oldPosition?: string;\n  beforeKey?: string;\n\n  constructor(\n    type: ChangeType,\n    position: string,\n    value: any,\n    pointer?: DontCodeModelPointer,\n    beforeKey?: string,\n    oldPosition?: string\n  ) {\n    this.type = type;\n    this.position = position;\n    if (position === '/')\n      throw new Error(\n        'Root position is defined by empty string and not slash anymore'\n      );\n    this.value = value;\n    this.pointer = pointer;\n    this.beforeKey = beforeKey;\n    this.oldPosition = oldPosition;\n  }\n\n  /**\n   * Utility method to return the position parent of this change by selecting the right way to calculate it\n   * if the change is for the root (thus with no parent), it throws an exception.\n   * Use this method if you are sure the Change is not for root.\n   */\n  getSafeParentPosition(): string {\n    const parent = this.getParentPosition();\n    if (parent == null) throw new Error('No Parent position for root changes.');\n    return parent;\n  }\n\n  /**\n   * Utility method to return the position parent of this change by selecting the right way to calculate it\n   * if the change is for the root (thus with no parent), it returns null.\n   * */\n  getParentPosition(): string | null {\n    if (this.pointer != null) {\n      return this.pointer.containerPosition ?? null;\n    } else {\n      return DontCodeModelPointer.parentPosition(this.position);\n    }\n  }\n}\n\nexport enum ChangeType {\n  ADD = 'ADD',\n  UPDATE = 'UPDATE',\n  DELETE = 'DELETE',\n  MOVE = 'MOVE',\n  RESET = 'RESET',\n  ACTION = 'ACTION'\n}\n","import {Change, ChangeType} from \"../change/change\";\nimport {ActionContextType, ActionType} from \"../globals\";\nimport {DontCodeModelPointer} from \"../model/dont-code-schema\";\nimport {Observable, Subject} from \"rxjs\";\nimport {run} from \"jest\";\n\n/**\n * An action is a special type of change where we ask the handler to act on data.\n */\nexport class Action extends Change {\n  context: ActionContextType;\n  actionType:ActionType;\n  running: Subject<Promise<void>> | null = new Subject<Promise<void>>();\n\n  constructor(\n                  position: string,\n                  value: any,\n                  context: ActionContextType,\n                  actionType:ActionType,\n                  pointer?: DontCodeModelPointer,\n                  running?:Subject<Promise<void>>|null,\n                  changeType?:ChangeType\n) {\n    super(changeType??ChangeType.ACTION,position, value,pointer);\n    this.context=context;\n    this.actionType=actionType;\n    if( running!=null) this.running=running;\n  }\n}\n","import {Change, ChangeType} from '../change/change';\nimport {DontCodeSchemaItem} from './dont-code-schema-item';\nimport {DontCodeSchemaManager} from './dont-code-schema-manager';\nimport {JSONPath} from 'jsonpath-plus';\nimport {DontCodeModelPointer} from './dont-code-schema';\nimport {DefinitionUpdateConfig} from \"../globals\";\nimport {Action} from \"../action/action\";\n\n/**\n * Stores and constantly updates the json (as an instance of the DontCodeSchema) as it is being edited / modified through Change events\n * It does not store the entity values but the description of entities, screens... as defined in the Editor\n */\nexport class DontCodeModelManager {\n  protected content: any;\n\n  static readonly POSSIBLE_CHARS_FOR_ARRAY_KEYS = \"abcdefghijklmnopqrstuvxyz\";\n  static readonly POSSIBLE_CHARS_FOR_ARRAY_KEYS_LENGTH = DontCodeModelManager.POSSIBLE_CHARS_FOR_ARRAY_KEYS.length;\n\n  constructor(protected schemaMgr: DontCodeSchemaManager) {\n    this.reset();\n  }\n\n  reset() {\n    this.content = undefined;\n  }\n\n  /**\n   * Returns the complete json stored\n   */\n  getContent(): any {\n    return this.content;\n  }\n\n  /**\n   * Resets the current json content to the one given in parameter\n   * @param newContent\n   */\n  resetContent(newContent: any) {\n    this.content = newContent;\n  }\n\n  /**\n   * Checks if the element can be viewed in the Builder or not\n   * @param content\n   */\n  static isHidden(content: any): boolean {\n    return content?.$hidden == true;\n  }\n\n  /**\n   * Checks if the element can be edited in the Builder or not\n   * @param content\n   */\n  static isReadonly(content: any): boolean {\n    return content?.$readOnly == true;\n  }\n\n  /**\n   * Apply the change to the current model and split it into multiple atomic changes for each modified property\n   * @param toApply\n   */\n  applyChange(toApply: Change): Array<Change> {\n    let pointer =\n      toApply.pointer ?? this.schemaMgr.generateSchemaPointer(toApply.position);\n    toApply.pointer = pointer;\n    const parentPosition = pointer.containerPosition;\n    const subElem = toApply.pointer?.lastElement;\n    if (parentPosition != null && subElem != null)\n      pointer = this.schemaMgr.generateParentPointer(pointer)!;\n\n    const atomicChanges = new AtomicChange();\n    atomicChanges.isRoot = true;\n    atomicChanges.name = pointer.position;\n    let lastChange = atomicChanges;\n    let content = this.findAtPosition(pointer.position);\n\n    if (content == null) {\n      // Are we trying to delete a non existing content ?\n      if (toApply.type === ChangeType.DELETE) {\n        return []; // Nothing has changed\n      } else {\n        // we are adding something, so create the parent\n        content = this.findAtPosition(pointer.position, true, atomicChanges);\n        let basePosition = pointer.position;\n        while (lastChange.subChanges.length > 0) {\n          basePosition = basePosition.substring(\n            0,\n            basePosition.lastIndexOf('/')\n          );\n          lastChange = lastChange.subChanges[0];\n        }\n        atomicChanges.name = basePosition;\n      }\n    }\n\n    if( toApply.type===ChangeType.ACTION) {\n      lastChange.type=ChangeType.ACTION;\n    }\n\n    const isAnUpdate = this.applyChangeRecursive(\n      toApply,\n      content,\n      toApply.value,\n      toApply.pointer,\n      lastChange\n    );\n    return this.generateChanges(\n      toApply,\n      atomicChanges,\n      isAnUpdate,\n      this.schemaMgr.generateSchemaPointer(atomicChanges.name)\n    );\n  }\n\n  protected applyChangeRecursive(\n    srcChange: Change,\n    oldContent: any,\n    newContent: any,\n    pointer: DontCodeModelPointer,\n    atomicChanges: AtomicChange,\n    oldPosition?: string\n  ): boolean {\n    if (srcChange.pointer == null)\n      throw new Error(\n        'Cannot apply a change without a pointer at position ' +\n        srcChange.position\n      );\n\n    let isAnUpdate=true;\n    if (oldPosition == null) oldPosition = srcChange.oldPosition;\n\n    const subElem = pointer.lastElement;\n    if (subElem || subElem.length === 0) {\n      //const subPointer = pointer.subItemOrPropertyPointer(subElem, pointer?.key==null);\n      const oldSubContent =\n        subElem.length === 0 ? oldContent : oldContent[subElem];\n      switch (srcChange.type) {\n        case ChangeType.ACTION: {\n\n          // An action doesn't modify the data but must be created for each subelement\n          const curAtomicChange = atomicChanges.createSubChange(ChangeType.ACTION, subElem, atomicChanges.value);\n          this.compareRecursiveIfNeeded(srcChange, oldSubContent,null,pointer, curAtomicChange);\n          break;\n        }\n        case ChangeType.ADD:\n        case ChangeType.UPDATE:\n        case ChangeType.RESET: {\n          let curAtomicChange;\n          if (\n            srcChange.type === ChangeType.RESET &&\n            srcChange.position === pointer.position\n          ) {\n            // Create a RESET change for the root element reset only\n            if (\n              typeof newContent === 'object' &&\n              this.isTheSameForParent(oldSubContent, newContent)\n            ) {\n              curAtomicChange = atomicChanges.createSubChange(\n                undefined,\n                subElem,\n                null\n              );\n            } else if (\n              typeof newContent === 'object' ||\n              oldSubContent !== newContent\n            ) {\n              curAtomicChange = atomicChanges.createSubChange(\n                ChangeType.RESET,\n                subElem,\n                newContent\n              );\n            }\n          } else if (oldSubContent == null) {\n            curAtomicChange = atomicChanges.createSubChange(\n              ChangeType.ADD,\n              subElem,\n              newContent\n            );\n          } else if (\n            typeof newContent === 'object' &&\n            this.isTheSameForParent(oldSubContent, newContent)\n          ) {\n            curAtomicChange = atomicChanges.createSubChange(\n              undefined,\n              subElem,\n              null\n            );\n          } else if (\n            typeof newContent === 'object' ||\n            oldSubContent !== newContent\n          ) {\n            if ((typeof oldSubContent === 'object') && (srcChange.type==ChangeType.ADD)) {\n              // Verify that when asked to add a subitem, it's really an add, that means, at least one subproperty doesn't exist.\n              // Otherwise it's a UPDATE change\n              isAnUpdate=false;\n              for (const subProperty of Object.getOwnPropertyNames(newContent)) {\n                if (oldSubContent[subProperty]!=undefined) {  // At least one element is already present\n                  isAnUpdate=true;\n                  break;\n                }\n              }\n            }\n\n            curAtomicChange = atomicChanges.createSubChange(\n              ChangeType.UPDATE,  // Even if it's an ADD of a subElement, we consider it's an UPDATE for the parent\n              subElem,\n              newContent\n            );\n          }\n\n          if (curAtomicChange)\n            this.compareRecursiveIfNeeded(\n              srcChange,\n              oldSubContent,\n              newContent,\n              pointer,\n              curAtomicChange\n            );\n          if ((subElem.length > 0) && (isAnUpdate))\n            // Special case when changing the root element (subElem = '')\n            this.insertProperty(\n              oldContent,\n              subElem,\n              newContent,\n              srcChange.beforeKey\n            );\n        }\n          break;\n        case ChangeType.DELETE: {\n          if (oldContent[subElem]) {\n            const curAtomicChange = atomicChanges.createSubChange(\n              ChangeType.DELETE,\n              subElem,\n              null\n            );\n            this.compareRecursiveIfNeeded(\n              srcChange,\n              oldContent[subElem],\n              newContent,\n              pointer,\n              curAtomicChange\n            );\n            delete oldContent[subElem];\n          }\n        }\n          break;\n        case ChangeType.MOVE: {\n          // If it's the root of move, then find the value to move from the oldPosition\n          if (srcChange.position === pointer.position) {\n            if (oldPosition == null)\n              throw new Error(\n                'Cannot process MOVE change without oldPosition' +\n                srcChange.position\n              );\n            if (newContent == null) {\n              newContent = this.findAtPosition(oldPosition);\n            }\n            if (newContent) {\n              const curAtomicChange = atomicChanges.createSubChange(\n                ChangeType.MOVE,\n                subElem,\n                newContent,\n                oldPosition\n              );\n              if (srcChange.position !== oldPosition) {\n                // When we reorder elements of an array, it's a move to the same position: No changes\n                this.compareRecursiveIfNeeded(\n                  srcChange,\n                  null,\n                  newContent,\n                  pointer,\n                  curAtomicChange,\n                  oldPosition\n                );\n                this.insertProperty(\n                  oldContent,\n                  subElem,\n                  newContent,\n                  srcChange.beforeKey\n                );\n                // Really perform the change\n                const splittedPosition =\n                  DontCodeModelPointer.splitPosition(oldPosition)!;\n                const parentContent = this.findAtPosition(\n                  splittedPosition.parent\n                );\n                delete parentContent[splittedPosition.element];\n              } else {\n                // Just insert the same element at a different position in the object\n                this.compareRecursiveIfNeeded(\n                  srcChange,\n                  null,\n                  newContent,\n                  pointer,\n                  curAtomicChange,\n                  oldPosition\n                );\n                this.insertProperty(\n                  oldContent,\n                  subElem,\n                  newContent,\n                  srcChange.beforeKey\n                );\n              }\n            }\n          } else {\n            // The move has already been done, so just createSubChange and loop through subElements\n            const curAtomicChange = atomicChanges.createSubChange(\n              ChangeType.MOVE,\n              subElem,\n              null,\n              oldPosition\n            );\n            this.compareRecursiveIfNeeded(\n              srcChange,\n              oldContent,\n              newContent,\n              pointer,\n              curAtomicChange,\n              oldPosition\n            );\n          }\n        }\n          break;\n        default:\n          throw new Error('No support for change of type ' + srcChange.type);\n      }\n    } else {\n      this.compareRecursiveIfNeeded(\n        srcChange,\n        oldContent,\n        newContent,\n        pointer,\n        atomicChanges,\n        oldPosition\n      );\n    }\n    return isAnUpdate;\n  }\n\n  /**\n   * Check if the values are the same, or the objects property names are the same, so that we can define it impacts or not the parent\n   * @param oldValue\n   * @param newValue\n   */\n  isTheSameForParent(oldValue: any, newValue: any): boolean {\n    if (newValue === oldValue) {\n      return true;\n    } else if (newValue == null || oldValue == null) {\n      return false;\n    } else if (typeof oldValue === 'object' && typeof newValue === 'object') {\n      const oldKeys = Object.keys(oldValue);\n      const newKeys = Object.keys(newValue);\n      return (\n        oldKeys.length === newKeys.length &&\n        oldKeys.every((value, index) => {\n          return value === newKeys[index];\n        })\n      );\n    } else {\n      return oldValue === newValue;\n    }\n  }\n\n  /**\n   * By checking the differences between old and new content, and depending on the src change type, generate a change for each sub element hierarchically\n   * @param src\n   * @param oldContent\n   * @param newContent\n   * @param atomicChanges\n   */\n  compareRecursiveIfNeeded(\n    src: Change,\n    oldContent: any,\n    newContent: any,\n    pointer: DontCodeModelPointer,\n    atomicChanges: AtomicChange,\n    oldPosition?: string\n  ): void {\n    if (oldContent == null || typeof oldContent !== 'object') oldContent = {};\n    if (newContent == null || typeof newContent !== 'object') newContent = {};\n    const alreadyChecked = new Set<string>();\n\n    // Check if existing elements have been deleted or updated\n    for (const oldSubProperty in oldContent) {\n      const subPointer = this.schemaMgr.generateSubSchemaPointer(\n        pointer,\n        oldSubProperty\n      );\n      const subPosition = subPointer.position;\n      alreadyChecked.add(oldSubProperty);\n      // eslint-disable-next-line no-prototype-builtins\n      if (newContent.hasOwnProperty(oldSubProperty)) {\n        this.applyChangeRecursive(\n          src,\n          oldContent,\n          newContent[oldSubProperty],\n          subPointer,\n          atomicChanges,\n          oldPosition\n        );\n      } else {\n          // Action are just passed to all subElements\n        if (src.type==ChangeType.ACTION) {\n          const srcAction = src as Action;\n          this.applyChangeRecursive(new Action(subPosition, srcAction.value, srcAction.context, srcAction.actionType, subPointer, srcAction.running),\n            oldContent, null, subPointer, atomicChanges);\n        } else if (src.type!=ChangeType.ADD){\n          // It doesn't exist in the new element, so if not explicitely added, then it's deleted\n          this.applyChangeRecursive(\n            new Change(ChangeType.DELETE, subPosition, null, subPointer),\n            oldContent,\n            null,\n            subPointer,\n            atomicChanges,\n            oldPosition\n          );\n        }\n      }\n    }\n\n    // Check if new elements have been added\n    for (const newSubProperty in newContent) {\n      if (src.type === ChangeType.MOVE) {\n        const subPointer = this.schemaMgr.generateSubSchemaPointer(\n          pointer,\n          newSubProperty\n        );\n        const subPosition = subPointer.position;\n        //src.oldPosition = subPosition;\n        this.applyChangeRecursive(\n          src,\n          oldContent,\n          newContent[newSubProperty],\n          subPointer,\n          atomicChanges,\n          oldPosition + '/' + newSubProperty\n        );\n      } else if (!alreadyChecked.has(newSubProperty)) {\n        const subPointer = this.schemaMgr.generateSubSchemaPointer(\n          pointer,\n          newSubProperty\n        );\n        const subPosition = subPointer.position;\n        this.applyChangeRecursive(\n          new Change(\n            ChangeType.ADD,\n            subPosition,\n            newContent[newSubProperty],\n            subPointer\n          ),\n          oldContent,\n          newContent[newSubProperty],\n          subPointer,\n          atomicChanges\n        );\n      }\n    }\n  }\n\n  protected generateChanges(\n    src: Change,\n    atomicChanges: AtomicChange,\n    isAnUpdate: boolean,\n    pointer?: DontCodeModelPointer,\n    result?: Array<Change>\n  ): Array<Change> {\n    if (result == null) result = new Array<Change>();\n\n    if (src.pointer == null)\n      throw new Error('Cannot generate changes without the pointer');\n\n    if (pointer == null) pointer = src.pointer;\n\n    if (atomicChanges.type != null) {\n      //pointer = this.schemaMgr.generateSubSchemaPointer(pointer, atomicChanges.name);\n      if (atomicChanges.type === ChangeType.MOVE) {\n        if (atomicChanges.oldPosition == null)\n          throw new Error(\n            'A Move Change must have an oldPosition set ' + pointer.position\n          );\n        if (\n          atomicChanges.oldPosition !== pointer.position &&\n          src.position === pointer.position\n        ) {\n          // Generate an update of the old position only if it's different from the new position, as for the new position an update has already been generated\n          result.push(\n            new Change(\n              ChangeType.UPDATE,\n              DontCodeModelPointer.parentPosition(atomicChanges.oldPosition)!,\n              atomicChanges.value\n            )\n          );\n        }\n        result.push(\n          new Change(\n            ChangeType.MOVE,\n            pointer.position,\n            atomicChanges.value,\n            pointer,\n            undefined,\n            atomicChanges.oldPosition\n          )\n        );\n      } else {\n        if ( atomicChanges.type===ChangeType.ACTION) {\n            // Create an action for Change of action type\n          const srcAction = src as Action;\n          result.push(\n            new Action(\n              pointer.position,\n              srcAction.value,\n              srcAction.context,\n              srcAction.actionType,\n              pointer,\n              srcAction.running\n            )\n          );\n\n        } else {\n          result.push(\n            new Change(\n              atomicChanges.type,\n              pointer.position,\n              atomicChanges.value,\n              pointer\n            )\n          );\n        }\n      }\n    } else {\n      // First check if we need to send an UPDATED change to this element because a subElement is added / removed\n      for (let i = 0; i < atomicChanges.subChanges.length; i++) {\n        const cur = atomicChanges.subChanges[i];\n        if (\n          cur.type != null &&\n          cur.type !== ChangeType.UPDATE &&\n          cur.name.length > 0\n        ) {\n          if( isAnUpdate==true) {  // Sometimes we receive ADD but they are UPDATE in fact\n            result.push(\n              new Change(\n                ChangeType.UPDATE,\n                pointer.position,\n                this.findAtPosition(pointer.position),\n                pointer\n              )\n            );\n          }\n          break;\n        }\n        /*if( (cur.type === ChangeType.MOVE) && (cur.oldPosition != null)) {\n          result.push(new Change (ChangeType.UPDATE, cur.oldPosition, null));\n        }*/\n      }\n    }\n\n    // Then recurse through all subelements, generating changes along the way\n    for (let i = 0; i < atomicChanges.subChanges.length; i++) {\n      const cur = atomicChanges.subChanges[i];\n      this.generateChanges(\n        src,\n        cur,\n        true, // It's never an incorrect update for subelements\n        this.schemaMgr.generateSubSchemaPointer(pointer, cur.name),\n        result\n      );\n    }\n\n    return result;\n  }\n\n  /**\n   * Calculates a key that can be inserted at the given position in the content\n   * @param pos\n   */\n  generateNextKeyForPosition(pos: string, create = false): string {\n    const array = this.findAtPosition(pos, create);\n    if (array == null)\n      throw new Error(\"No element at position \" + pos);\n    return DontCodeModelManager.generateNextKey(array);\n  }\n\n  static generateNextKey(array: Record<string, unknown> | Set<string>): string {\n    let keys: Set<string>;\n    if (array.size != null) {\n      keys = array as Set<string>;\n    } else {\n      keys = new Set(Object.keys(array));\n    }\n    let tentative = keys.size;\n    let found = false;\n    const modulo = DontCodeModelManager.POSSIBLE_CHARS_FOR_ARRAY_KEYS_LENGTH;\n    let key;\n    do {\n      // Calculate a tentative key\n      key = '';\n      do {\n        const quotient = Math.trunc(tentative / modulo);\n        const rest = tentative % modulo;\n\n        key = DontCodeModelManager.POSSIBLE_CHARS_FOR_ARRAY_KEYS[rest].concat(key);\n        tentative = quotient - 1; // -1 because we need to not take into account the first row of values as they don't have the same number of chars\n\n      } while (tentative >= 0);\n\n      // Check if the key is already present\n      found = keys.has(key);\n      tentative++;\n    } while (found);\n    return key;\n  }\n\n  /**\n   * Provides the json extract at the given position.\n   * For example, findAtPosition ('creation/entities/a') will returns the description (fields...) of the first entity created with the editor\n   * @param position\n   * @param create\n   */\n  findAtPosition(\n    position: string,\n    create?: boolean,\n    added?: AtomicChange\n  ): any {\n    const path = position.split('/');\n    if (this.content == null) {\n      if (create) {\n        this.content = {};\n      } else {\n        return null;\n      }\n    }\n\n    let current = this.content;\n    let currentPath = '';\n\n    path.forEach((element) => {\n      if (element === '' || current === null) return current;\n      if (currentPath.length === 0) currentPath = element;\n      else currentPath = currentPath + '/' + element;\n      if (!current[element]) {\n        if (create) {\n          current[element] = {};\n          if (added) {\n            added = added.createSubChange(ChangeType.ADD, element, {});\n          }\n        } else {\n          current = null;\n          return null;\n        }\n      }\n\n      current = current[element];\n    });\n    return current;\n  }\n\n  /**\n   * Enable querying the model for any value, following jsonPath model\n   * To use when potentially you expect multiple values\n   * @param query: the query as a jsonPath\n   * @param position: in case the jsonPath is relative\n   */\n  queryModelToArray(query: string, position?: string): Array<any> {\n    let root = this.content;\n    if (position) {\n      root = this.findAtPosition(position, false);\n    }\n    const result = JSONPath({\n      path: query,\n      json: root,\n      resultType: 'value',\n      wrap: false,\n      flatten: true,\n    });\n    return result;\n  }\n\n  /**\n   * Enable querying the model for any value, following jsonPath model\n   * To use when potentially you expect a single value.\n   * @param query: the query as a  jsonPath\n   * @param position: in case the jsonPath is relative\n   */\n  queryModelToSingle(query: string, position?: string): ModelQuerySingleResult|null {\n    let root = this.content;\n    if (position) {\n      root = this.findAtPosition(position, false);\n    }\n    let result = JSONPath({\n      path: query,\n      json: root,\n      resultType: 'all',\n      wrap: false,\n    });\n    if (Array.isArray(result)) {\n      if (result.length <= 1) result = result[0];\n      else\n        throw new Error(\n          'Multiple results returned by queryModelToSingle with path ' + query\n        );\n    }\n    // In Dont-code, on the contrary of Json Pointer, you don't start a pointer by /\n    if (result?.pointer?.startsWith('/')) {\n      result.pointer = result.pointer.substring(1);\n    }\n\n    if (result != null) {\n      delete result.path;\n      delete result.parent;\n      delete result.parentProperty;\n    }\n    return result as ModelQuerySingleResult;\n  }\n\n  /**\n   * Returns the list of values that are possible target of a given property path. With this the Builder User Interface can display to the user a combo-box will all targets\n   * For example, with the following Dont-code model:\n   * \"from\": {\n   *           \"type\": \"string\",\n   *           \"format\": \"$.creation.sources.name\"\n   *         }\n   *\n   * findAllPossibleTargetsOrProperty (\"from\", ...) will returns all sources names.\n   * @param property\n   * @param position\n   * @param schemaItem\n   */\n  findAllPossibleTargetsOfProperty(\n    property: string,\n    position: string,\n    schemaItem?: DontCodeSchemaItem\n  ): Array<any> {\n    if (schemaItem == null) {\n      const ptr = this.schemaMgr.generateSchemaPointer(position);\n      schemaItem = this.schemaMgr.locateItem(\n        ptr.subPropertyPointer(property).positionInSchema,\n        true\n      );\n    }\n    const targetPath = schemaItem?.getTargetPath();\n    if (schemaItem && targetPath) {\n      const lastDotPos = targetPath.lastIndexOf('.');\n      return this.queryModelToArray(targetPath.substring(0, lastDotPos) + '.*');\n    } else {\n      throw new Error(\n        'No Schema or no format definition for ' + position + '/' + property\n      );\n    }\n  }\n\n  /**\n   * Returns the exact element that matches the target of a given property path.\n   *\n   * For example, with the following Dont-code model:\n   * \"from\": {\n   *           \"type\": \"string\",\n   *           \"format\": \"$.creation.sources.name\"\n   *         }\n   *\n   * and an instantiated model like this:\n   * {\n   *   \"from\": \"EntityName\"\n   * }\n   * findAllPossibleTargetsOrProperty (\"from\", ...) will return only the source named \"EntityName\".\n   * @param property\n   * @param position\n   * @param schemaItem\n   */\n  findTargetOfProperty(\n    property: string,\n    position: string,\n    schemaItem?: DontCodeSchemaItem\n  ): ModelQuerySingleResult | null {\n    const src = this.findAtPosition(position, false);\n    if (src && src[property]) {\n      if (schemaItem == null) {\n        const ptr = this.schemaMgr.generateSchemaPointer(position);\n        schemaItem = this.schemaMgr.locateItem(\n          ptr.subPropertyPointer(property).positionInSchema,\n          true\n        );\n      }\n      const targetPath = schemaItem?.getTargetPath();\n      if (schemaItem && targetPath) {\n        const lastDotPos = targetPath.lastIndexOf('.');\n        //        const filteredQuery = targetPath.substring(0, lastDotPos)+'[?(@.'+targetPath.substring(lastDotPos+1)+'===\"'+src[property]+'\")]';\n        const filteredQuery =\n          targetPath.substring(0, lastDotPos) +\n          \"[?(@['\" +\n          targetPath.substring(lastDotPos + 1) +\n          '\\']===\"' +\n          src[property] +\n          '\")]';\n        return this.queryModelToSingle(filteredQuery);\n      } else {\n        throw new Error(\n          'No Schema or no format definition for ' + position + '/' + property\n        );\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Insert a property at the end of an object or before the specified property\n   * @param parent\n   * @param propName\n   * @param value\n   * @param beforeProp\n   */\n  insertProperty(\n    parent: any,\n    propName: string,\n    value: any,\n    beforeProp?: string\n  ) {\n    if (beforeProp) {\n      // Reinsert all properties of the object and inject the new one at the right order\n      const keys = Object.keys(parent);\n      for (const key of keys) {\n        if (key !== propName) {\n          const copy = parent[key];\n          delete parent[key];\n          if (key === beforeProp) {\n            if (parent[propName] !== undefined) delete parent[propName];\n            parent[propName] = value;\n          }\n          parent[key] = copy;\n        }\n      }\n    } else {\n      if (parent[propName] !== undefined) delete parent[propName];\n      parent[propName] = value;\n    }\n  }\n\n  /**\n   * From a DefinitionUpdateConfig given by a repository configuration, generates a Change that can be applied to the model.\n   * @param definition\n   */\n  convertToChange(definition: DefinitionUpdateConfig): Change {\n    let ptr = this.schemaMgr.generateSchemaPointer(definition.location.parent);\n    const schemaItem = this.schemaMgr.locateItem(ptr.positionInSchema, false);\n    if (schemaItem.isArray()) {\n      if ((definition.location.id == null) || (definition.location.id === '*')) {\n        // We must create a subelement\n        ptr = ptr.subItemPointer(this.generateNextKeyForPosition(ptr.position, true));\n      } else {\n        ptr = ptr.subItemPointer(definition.location.id);\n      }\n    } else {\n      if (definition.location.id != null) {\n        ptr = ptr.subItemPointer(definition.location.id);\n      }\n    }\n    return new Change(ChangeType.ADD, ptr.position, definition.update\n      , ptr\n      , definition.location.after);\n\n  }\n\n  /**\n   * Try to guess which field is most likely to represent the name of an object (ususally a field with name \"name\", or \"title\")\n   * @param position\n   * @param modelAsJson\n   */\n  guessNamePropertyOfElement(position: string | null, modelAsJson: any): string | null {\n    if (modelAsJson == null) {\n      if (position == null)\n        throw new Error(\"Either position or model must be provided\");\n      modelAsJson = this.findAtPosition(position, false);\n      if (modelAsJson == null) {\n        throw new Error(\"Position \" + position + \" does not exist in model\");\n      }\n    }\n    if ((modelAsJson.fields != null) && (Array.isArray(modelAsJson.fields)))\n      modelAsJson = modelAsJson.fields;\n\n    const curScore: { score: number, field: any } = {score: -1, field: null};\n\n    for (const field in modelAsJson) {\n      if (DontCodeModelManager.scoreFieldAsName(modelAsJson[field].name, modelAsJson[field].type, curScore))\n        break;\n    }\n\n    if (curScore.score > 0) {\n      return curScore.field;\n    } else\n      return null;\n\n  }\n\n  public static guessNamePropertyOfObject(obj: any): string | null {\n    const score: { score: number, field: any } = {score: -1, field: null};\n    for (const prop in obj) {\n      DontCodeModelManager.scoreFieldAsName(prop, 'Text', score);\n    }\n    if (score.score > 0)\n      return score.field;\n    else\n      return null;\n  }\n\n  public static guessNamePropertyFromList(...list: string[]): string | null {\n    const score: { score: number, field: any } = {score: -1, field: null};\n    for (const prop of list) {\n      DontCodeModelManager.scoreFieldAsName(prop, 'Text', score);\n    }\n    if (score.score > 0)\n      return score.field;\n    else\n      return null;\n  }\n\n  /**\n   * Checks the probability the name given (and type) is field name that represents the name of the element.\n   * @param name\n   * @param type\n   * @param score\n   * @protected\n   */\n  protected static scoreFieldAsName(name: string, type: string, score: { score: number, field: any }): boolean {\n    if (name == null)\n      return false;\n    const propName = name.toLowerCase();\n    for (const [key, value] of this.NAME_PROPERTY_NAMES) {\n      if (propName === key) {\n        const foundScore = value ?? 0;\n        if (score.score < foundScore) {\n          score.score = foundScore;\n          score.field = name;\n          if (score.score == 100)\n            return true;\n        }\n      } else if (propName.includes(key)) {\n        const foundScore = (value ?? 0) / 2;\n        if (score.score < foundScore) {\n          score.score = foundScore;\n          score.field = name;\n        }\n      }\n    }\n\n    if (type == \"Text\") {\n      if (score.score < 20) {\n        score.score = 20;\n        score.field = name;\n      }\n    }\n\n    if (score.score > 0) return true;\n    else return false;\n  }\n\n  protected static readonly NAME_PROPERTY_NAMES = new Map<string, number>([\n    ['name', 100],\n    ['nom', 100],\n    ['title', 80],\n    ['titre', 80],\n    ['lastname', 80],\n    ['label', 70],\n    ['libell', 70]\n  ])\n\n  /**\n   * Extract the value of any data in parameter. It can handle complex data and flattens it into something that you can calculate or act upon (number or string)\n   * @param obj\n   * @param metaData Will store information about how to extract the data for this item. Will accelerate greatly extraction for other similar data.\n   * @param position\n   * @param schemaItem\n   * @protected\n   */\n  public extractValue<T>(obj: T, metaData: DataTransformationInfo, position?: DontCodeModelPointer, schemaItem?: DontCodeSchemaItem): any {\n    if (obj == null)\n      return obj;\n    if (!metaData.parsed) {\n      this.extractMetaData(obj, metaData, position, schemaItem);\n    }\n\n    // We already know what to do\n    if (metaData.direct) {\n      return obj;\n    } else {\n      if (metaData.array) {\n        if ((obj as Array<T>).length > 0) {\n          obj = (obj as Array<T>)[0];\n        } else return obj;\n      }\n      if (metaData.subValue != null) {\n        return (obj as any)[metaData.subValue];\n      } else if (metaData.subValues!=null) {\n\n        for (let i=0;i<metaData.subValues.length; i++) {\n          obj=(obj as any)[metaData.subValues[i]];\n          if (obj==null) break;\n        }\n        return obj;\n\n      } else {\n        // If we couldn't determine the object's value, maybe it's because the value is not present\n        return undefined;\n      }\n    }\n  }\n\n  /**\n   * Apply the primitive value back in the object\n   * @param obj\n   * @param value\n   * @param metaData Will store information about how to extract the data for this item. Will accelerate greatly extraction for other similar data.\n   * @param valueObj if any, the object that contained the source. In case you want to apply other values of the source as well\n   * @param position\n   * @param schemaItem\n   * @return The object with the primitive set or the value if the obj is indeed a primitive already\n   */\n  public applyValue <T>(obj: T, value:any, metaData: DataTransformationInfo, valueObj?: T, position?: DontCodeModelPointer, schemaItem?: DontCodeSchemaItem): T {\n    if (obj == null)\n      return value;\n\n    if (!metaData.parsed) {\n      this.extractMetaData(obj, metaData, position, schemaItem);\n    }\n\n    // We already know what to do\n    if (metaData.direct) {\n      return value as unknown as T;\n    } else {\n      if (metaData.array) {\n          // We extract the first element of the array\n        if ((obj as Array<T>).length > 0) {\n          obj = (obj as Array<T>)[0];\n        } else {\n          if (value!=undefined) // Only undefined are not pushed, null values can be pushed\n            (obj as Array<T>).push(value as unknown as T);\n          return obj\n        }\n      }\n      if (metaData.subValue != null) {\n        if( value===undefined) {\n          delete (obj as any)[metaData.subValue];\n        } else {\n          (obj as any)[metaData.subValue]=value;\n        }\n      } else if (metaData.subValues != null) {\n        let curObj = obj as any;\n        if (value === undefined) {\n          for (let i=0;i<metaData.subValues.length-1; i++) {\n            curObj=curObj[metaData.subValues[i]];\n            if (curObj==null) break;\n          }\n            // Delete the element only it there was one\n          if( (curObj!=null) && (curObj[metaData.subValues[metaData.subValues.length-1]]!=undefined)) {\n              delete curObj[metaData.subValues[metaData.subValues.length-1]];\n\n          }\n        } else {\n          for (let i=0;i<metaData.subValues.length-1; i++) {\n            if (curObj[metaData.subValues[i]]==undefined) {\n              curObj[metaData.subValues[i]]={};\n            }\n            curObj = curObj[metaData.subValues[i]];\n          }\n\n          if ((curObj[metaData.subValues[metaData.subValues.length-1]]==null) && (valueObj!=null)) {\n            let curValueObj=valueObj as any;\n            for (let i=0;i<metaData.subValues.length-1; i++) {\n              if (curValueObj[metaData.subValues[i]]==null) {\n                curValueObj=null;\n                break;\n              }\n              curValueObj = curValueObj[metaData.subValues[i]];\n            }\n  \n            if (curValueObj!=null) {\n                // The element to copy to was null, so let's copy all properties from the second element\n                for (const valueProp in curValueObj) {\n\n                  if ((curObj[valueProp]==null) && (curValueObj[valueProp]!=null)) {\n                    curObj[valueProp]= structuredClone (curValueObj[valueProp]);\n                  }\n                }\n              }\n          }\n            // apply the value\n          curObj[metaData.subValues[metaData.subValues.length-1]]=value;\n        }\n      }\n      return obj;\n    }\n  }\n\n  /**\n   * Sorts the values in place. If the value is a complex type, extract a comparable item before\n   * @param values \n   * @param field if any field must be used for the sort\n   * @param sortOrder Optionally provides a sort order (positive or negative) to support multiple sorts\n   * @param metaData \n   */\n  public sortValues<T> (values:T[], sortOrder = 1, field?: string, metaData?: DataTransformationInfo,position?: DontCodeModelPointer, schemaItem?: DontCodeSchemaItem): void {\n    const metaInfo = metaData?? new DataTransformationInfo();\n\n    if (!metaInfo.parsed) {\n      for (const val of values) {\n        this.extractMetaData(this.extractField (val, field), metaInfo, position, schemaItem);\n        if (metaInfo.parsed) break;\n      }\n    }\n\n    if (metaInfo.parsed) {\n      values.sort ((first, second) => {\n        const firstValue = this.extractValue (this.extractField(first, field), metaInfo, position, schemaItem );\n        const secondValue = this.extractValue (this.extractField(second, field), metaInfo, position, schemaItem );\n\n        if (firstValue==null) {\n          if (secondValue==null) return 0;\n          else return -sortOrder;\n        } else if (secondValue==null) return sortOrder;\n\n        // firstValue and secondValue are now either string, number or Date\n\n        if ((typeof firstValue === 'string') && (typeof secondValue === 'string')) {\n            return sortOrder*(firstValue as string).localeCompare (secondValue);\n        }\n\n        return firstValue < secondValue ? -sortOrder : firstValue > secondValue ? sortOrder : 0;\n      });\n    } else {\n      console.warn ('Cannot sort array of unknown values');\n      return;\n    }\n\n  } \n\n  /**\n   * Guess how values can be set or extracted from an unknown object\n   * @param obj\n   * @param metaData\n   * @param position\n   * @param schemaItem\n   */\n  public extractMetaData<T>(obj: T, metaData: DataTransformationInfo, position?: DontCodeModelPointer, schemaItem?: DontCodeSchemaItem): void {\n\n    if( obj == null) return;\n    metaData.parsed = true;\n    metaData.subValue = null;\n    metaData.subValues = null;\n    if (typeof obj !== 'object') {\n      if (obj != null) {\n        metaData.direct = true;\n      } else {\n        metaData.parsed = false;\n      }\n    } else {\n      if (Array.isArray(obj)) {\n        metaData.array = true;\n        // eslint-disable-next-line no-restricted-syntax\n        console.debug(\"Getting an array as a value for metadata extraction\", obj);\n        if ((obj as Array<any>).length > 0) {\n          obj = (obj as Array<any>)[0];\n        } else {\n          metaData.parsed = false;\n        }\n      }\n      if (obj instanceof Date) {\n        metaData.direct = true;\n      } else {\n        // It's an unknown object\n        if ((obj as any).value !== undefined) {\n          metaData.subValue = 'value';\n        } else if ((obj as any).amount !== undefined) {\n          // It's an MoneyAmount\n          metaData.subValue = 'amount';\n        } else if ((obj as any).cost !== undefined) {\n            // It's a PriceModel\n          metaData.subValues = ['cost','amount'];\n        } else {\n          let firstKey = null;\n          for (const key in obj) {\n            if (firstKey == null) firstKey = key;\n            if ((obj[key] != null) && (typeof (obj[key]) !== 'object')) {\n              metaData.subValue = key;\n            }\n          }\n          if ((metaData.subValue == null)&& (metaData.subValues==null)) {\n            if ((typeof obj!=='object') || (obj instanceof Date)) {\n              metaData.subValue = firstKey;\n              console.warn(\"Guessed value key of \" + metaData.subValue + ' for object:', obj);\n            } else {\n              console.warn(\"Cannot guess value for object: \", obj);\n              metaData.parsed=false;\n              metaData.subValue=null;\n              metaData.subValues=null;\n              metaData.direct=false;\n              metaData.array=false;\n            }\n          }\n\n        }\n      }\n    }\n  }\n\n\n  /**\n   * Modify the first element with the value of the second element by applying the operator given in parameter\n   * @param firstElement\n   * @param secondElement\n   * @param metaData Will store information about how to extract the data for this item. Will accelerate greatly extraction for other similar data.\n   * @param operator\n   * @param position\n   * @param schemaItem\n   * @protected\n   */\n  public modifyValues<T>(firstElement: T, secondElement: T, metaData: DataTransformationInfo, operator: (firstValue: any, secondValue: any) => any , position?: DontCodeModelPointer, schemaItem?: DontCodeSchemaItem): T {\n    if (firstElement == null) {\n      throw new Error(\"Cannot modify value of null object\");\n    }\n    const firstValue = this.extractValue(firstElement, metaData, position, schemaItem);\n    const secondValue =this.extractValue(secondElement, metaData, position, schemaItem); \n    const calculatedValue = operator(firstValue, secondValue);\n\n      return this.applyValue(firstElement, calculatedValue, metaData, secondElement, position, schemaItem);\n  }\n\n  protected extractField(val: any, field?: string): any {\n    if( (field!=null) && (val!=null)) return val[field];\n    else return val;\n  }\n  \n}\n/**\n * Keep track of information about how to extract value of data\n */\nexport class DataTransformationInfo {\n  parsed = false; // Has the element been parsed ?\n  array=false; // Is it an array ?\n  direct = false; // Is the element already a usable value (not an object)\n  subValue:string|null=null; // What field will give the usable value ?\n  subValues:string[]|null=null; // What list of fields needs to be following to extract the usable value ?\n}\n\nclass AtomicChange {\n  type!: ChangeType;\n  name = '';\n  subChanges = new Array<AtomicChange>();\n  isRoot = false;\n  oldPosition: string | undefined;\n  value: any;\n\n  constructor(\n    type?: ChangeType,\n    name?: string,\n    value?: any,\n    oldPosition?: string\n  ) {\n    if (type) this.type = type;\n    if (name) this.name = name;\n    this.oldPosition = oldPosition;\n    this.value = value;\n  }\n\n  createSubChange(\n    type: ChangeType | undefined,\n    elementName: string,\n    value: any,\n    oldPosition?: string\n  ): AtomicChange {\n    const newChange = new AtomicChange(type, elementName, value, oldPosition);\n    this.subChanges.push(newChange);\n    return newChange;\n  }\n}\n\nexport class ModelQuerySingleResult {\n  value?:any;\n  pointer!:string;\n}\n\n","import {Observable, ReplaySubject, Subject, throwError} from \"rxjs\";\nimport {Change, ChangeType} from \"./change\";\nimport {DontCodeModelManager} from \"../model/dont-code-model-manager\";\nimport {DontCodeSchemaManager} from \"../model/dont-code-schema-manager\";\nimport {DefinitionUpdateConfig} from \"../globals\";\nimport {DontCodeModelPointer} from \"../model/dont-code-schema\";\nimport {Action} from \"../action/action\";\n\n/**\n * Manages the impact of changes that modify the model.\n * Any element can listen to a change at any level of the model, and gets notified accordingly\n */\nexport class DontCodeChangeManager {\n\n  protected receivedChanges!:Subject<Change>;\n\n  protected listeners = new Map<\n    { position: string; property?: string },\n    Subject<Change>\n    >();\n  protected listenerCachePerPosition = new Map<\n    string,\n    Array<Subject<Change>>\n    >();\n\n  constructor(protected schemaManager:DontCodeSchemaManager,\n              protected modelManager:DontCodeModelManager) {\n    this.reset();\n  }\n\n  reset() {\n    if (this.receivedChanges!=null)\n      this.receivedChanges.complete();\n    this.receivedChanges = new Subject<Change>();\n    this.listeners.clear();\n    this.listenerCachePerPosition.clear();\n  }\n\n  /**\n   * Check if the change affects the given position\n   * @param pos\n   * @param change\n   * @protected\n   */\n  protected isInterestedIn(\n    position: string,\n    property: string | undefined,\n    change: Change\n  ): boolean {\n    let onlyLevel = false;\n    if (position[position.length - 1] === '?') {\n      onlyLevel = true;\n      position = position.substring(0, position.length - 1);\n    }\n    if (position[position.length - 1] === '/') {\n      position = position.substring(0, position.length - 1);\n    }\n    //console.log(\"Setting Commands updates for \", position);\n    //console.log(\"Filtering position for pos,item:\", command.position, position, lastItem);\n    if (change.position != null && change.position.startsWith(position)) {\n      let nextPosition = DontCodeModelPointer.nextItemAndPosition(\n        change.position,\n        position.length + 1\n      );\n      const nextItem = nextPosition.value;\n      if (property) {\n        if (nextItem === property) {\n          //console.log(\"Filtering ok\");\n          return true;\n        } else {\n          // Supports for listeners like \"creation/entities\", with \"name\" property that are in fact \"creation/entities/xxanyEntityIDxx\", with \"name\" property\n          nextPosition = DontCodeModelPointer.nextItemAndPosition(\n            change.position,\n            nextPosition.pos + 1\n          );\n          if (nextPosition.value === property) {\n            return true;\n          }\n        }\n        //console.log(\"Filtering no\");\n        return false;\n      } else if (onlyLevel) {\n        //console.log(\"Filtering ok\");\n        if (nextItem != null) {\n          // Check if its the last item\n          nextPosition = DontCodeModelPointer.nextItemAndPosition(\n            change.position,\n            nextPosition.pos + 1\n          );\n          if (nextPosition.value === '') return true;\n        }\n        return false;\n      } else {\n        return true;\n      }\n    } else {\n      //console.log(\"Filtering no\");\n      return false;\n    }\n  }\n\n  protected createNewListener(\n    position: string,\n    property?: string\n  ): Observable<Change> {\n    const key = { position, property };\n\n    this.clearEmptyListeners ();\n    let item = this.listeners.get(key);\n    if (item == null) {\n      item = new ReplaySubject<Change>(1);\n      this.listeners.set(key, item);\n      this.listenerCachePerPosition.clear();\n    }\n\n        // Someone was listening to the same element, so we need to send the initial Reset only to the new listener\n    if (item.observed==true) {\n      return throwError( () => new Error (\"Several components listen to the same position {\"+position+', '+property));\n    }\n\n\n    // In case the model already contains a value the listener is interested in, just call it already\n    const cleanedPosition = this.cleanPosition(position);\n    const existing = this.modelManager.findAtPosition(cleanedPosition, false);\n    if (existing!=null) {\n      let chg = new Change(ChangeType.RESET, cleanedPosition, existing, this.schemaManager.generateSchemaPointer(cleanedPosition));\n      if (this.isInterestedIn(position, property, chg)) {\n        item.next(chg);\n      } else {\n        // Try to find if a sub element works (in case the listener wants all changes inside an array, for example \"creation/entities\" and \"name\" property)\n        if (property!=null) {\n          for (const propKey in existing) {\n            chg = new Change(ChangeType.RESET, cleanedPosition + '/' + propKey, existing[propKey], this.schemaManager.generateSchemaPointer(cleanedPosition + '/' + propKey));\n            if (this.isInterestedIn(position, property, chg)) {\n              item.next(chg);\n            } else if ((property!=null)&&(existing[propKey][property]!=null)) {\n              chg = new Change(ChangeType.RESET, cleanedPosition + '/' + propKey+'/'+property, existing[propKey][property], this.schemaManager.generateSchemaPointer(cleanedPosition + '/' + propKey+'/'+property));\n              if (this.isInterestedIn(position, property, chg)) {\n                item.next(chg);\n              }\n            }\n          }\n        }\n      }\n    }\n    return item;\n  }\n\n  protected addToListenerCache(position: string, who: Subject<Change>) {\n    let interesteds = this.listenerCachePerPosition.get(position);\n    if (!interesteds) {\n      interesteds = new Array<Subject<Change>>();\n      this.listenerCachePerPosition.set(position, interesteds);\n    }\n\n    interesteds.push(who);\n  }\n\n  getJsonAt(position: string): any {\n    return this.modelManager.findAtPosition(position, false);\n  }\n\n  /**\n   * Adds to the model the updates of configuration defined by the plugin or by the repository\n   * @param defs\n   */\n  applyPluginConfigUpdates (defs: DefinitionUpdateConfig[] | undefined):void {\n    if (defs!=null) {\n      for (const definition of defs) {\n        this.pushChange(this.modelManager.convertToChange(definition));\n      }\n    }\n\n  }\n\n  /**\n   * Updates the model by the change (by calling DontCodeModelManager.applyChange ()), and notifies all listeners of the modifications\n   * @param change\n   * @return true if at least one listener has been called\n   */\n  pushChange(change: Change): boolean {\n    let ret=false;\n    const subChanges = this.modelManager.applyChange(change);\n    ret = this.manageChangeInternally(change);\n    // Sends as well the subChanges induced by this change\n    for (const subChange of subChanges) {\n      if (\n        subChange.type !== change.type ||\n        subChange.position !== change.position\n      ) {\n        const otherRet=this.manageChangeInternally(subChange);\n        ret = ret || otherRet;\n      }\n    }\n    return ret;\n  }\n\n  manageChangeInternally(change: Change): boolean {\n    if (!change.pointer) {\n      change.pointer = this.calculatePointerFor(change.position);\n    }\n    this.receivedChanges.next(change);\n    return this.findAndNotify(change, new Map<Subject<Change>, Array<string>>());\n  }\n\n  /**\n   * Finds a listener that is interested in this change and notifies it.\n   * @param change\n   * @param alreadyCalled\n   */\n  findAndNotify(\n    change: Change,\n    alreadyCalled: Map<Subject<Change>, Array<string>>\n  ): boolean {\n    let ret=false;\n    // First resolve the position and cache it\n    if (!this.listenerCachePerPosition.get(change.position)) {\n      this.listeners.forEach((value, key) => {\n        if (this.isInterestedIn(key.position, key.property, change)) {\n          this.addToListenerCache(change.position, value);\n        }\n      });\n    }\n\n      // Then call all listeners, but only once\n    const affected = this.listenerCachePerPosition.get(change.position);\n    if (affected!=null) {\n      for (const subject of affected) {\n        let canCall = true;\n        const positions = alreadyCalled.get(subject);\n        if (positions) {\n          // Don't call twice the same listener for the same or parent position\n          for (const position of positions) {\n            if (change.position.startsWith(position)) {\n              canCall = false;\n            }\n          }\n        } else {\n          alreadyCalled.set(subject, new Array<string>());\n        }\n        if (canCall) {\n          ret=true;\n          subject.next(change);\n          alreadyCalled.get(subject)?.push(change.position);\n        }\n      }\n    }\n    return ret;\n  }\n\n  /**\n   * Be notified when something changes in the model at the following position\n   * for example:\n   * position: /creation/screens, property: name will be notified of all name changes for all screens\n   * position: /creation/screens, property: null will be notified of any change in any screen and subscreens\n   * position: /creation/screens/a, property: null will be notified on changes in screen a and below\n   * position: /creation/screens/?, property: null will be notified on changes in screen items (move, delete), and not below\n   * position: null, property: null will be notified on all changes\n   * @param position\n   * @param property\n   */\n  receiveCommands(position?: string, property?: string): Observable<Change> {\n    if (position) {\n      return this.createNewListener(position, property);\n    } else return this.receivedChanges;\n  }\n\n  getSchemaManager(): DontCodeSchemaManager {\n    return this.schemaManager;\n  }\n\n  calculatePointerFor(position: string): DontCodeModelPointer {\n    const ret = this.schemaManager.generateSchemaPointer(position);\n    return ret;\n  }\n\n  close() {\n    this.receivedChanges.complete();\n  }\n\n  /**\n   * Removes ? or / from end of position\n   * @param position\n   * @private\n   */\n  private cleanPosition(position: string): string {\n    position = position.endsWith('?')\n      ? position.substring(0, position.length - 1)\n      : position;\n    position = position.endsWith('/')\n      ? position.substring(0, position.length - 1)\n      : position;\n    return position;\n  }\n\n  protected clearEmptyListeners() {\n    const toRemove=new Array<{position:string, property?:string}>\n    for (const listener of this.listeners) {\n      if( !listener[1].observed) {\n        toRemove.push(listener[0]);\n      }\n    }\n\n    for (const remove of toRemove) {\n      this.listeners.delete(remove);\n    }\n  }\n}\n","import * as DontCode from './globals';\nimport { DontCodeSchemaManager } from './model/dont-code-schema-manager';\nimport { DontCodePluginManager } from './plugin/dont-code-plugin-manager';\nimport { DontCodePreviewManager } from './plugin/preview/dont-code-preview-manager';\nimport { DontCodeStoreManager } from './store/dont-code-store-manager';\nimport { DontCodeModelManager } from './model/dont-code-model-manager';\nimport {DontCodeChangeManager} from \"./change/dont-code-change-manager\";\nimport {Core} from \"./globals\";\n\nexport class DontCodeCore implements DontCode.Core {\n  protected schemaManager: DontCodeSchemaManager;\n  protected pluginManager: DontCodePluginManager;\n  protected previewManager: DontCodePreviewManager;\n  protected storeManager: DontCodeStoreManager;\n  protected modelManager: DontCodeModelManager;\n  protected changeManager: DontCodeChangeManager;\n\n  constructor() {\n    console.debug(\"Init core\");\n    this.schemaManager = new DontCodeSchemaManager();\n    this.pluginManager = new DontCodePluginManager();\n    this.previewManager = new DontCodePreviewManager();\n    this.modelManager = new DontCodeModelManager(this.schemaManager);\n    this.changeManager = new DontCodeChangeManager(this.schemaManager, this.modelManager);\n    this.storeManager = new DontCodeStoreManager(this.modelManager);  }\n\n  reset(): DontCode.Core {\n    this.schemaManager.reset();\n    this.pluginManager.reset();\n    this.previewManager.reset();\n    this.modelManager.reset();\n    this.changeManager.reset();\n    this.storeManager.reset();\n    return this;\n  }\n\n  registerPlugin(plugin: DontCode.Plugin): void {\n    this.pluginManager.registerPlugin(\n      plugin,\n      this.schemaManager,\n      this.previewManager\n    );\n  }\n\n  initPlugins (): void {\n    this.pluginManager.initPlugins (this);\n  }\n\n  getSchemaUri(): string {\n    return 'schemas/v1/dont-code-schema.json';\n  }\n\n  /**\n   * Returns the schema of dont-code augmented by plugins\n   */\n  getSchemaManager(): DontCodeSchemaManager {\n    return this.schemaManager;\n  }\n\n  getPreviewManager(): DontCodePreviewManager {\n    return this.previewManager;\n  }\n\n  getStoreManager(): DontCodeStoreManager {\n    return this.storeManager;\n  }\n\n  getModelManager(): DontCodeModelManager {\n    return this.modelManager;\n  }\n\n  getChangeManager(): DontCodeChangeManager {\n    return this.changeManager;\n  }\n\n}\n\nif (!(self as any).dontCodeCore)\n  (self as any).dontCodeCore = new DontCodeCore();\n// eslint-disable-next-line no-var\nexport var dtcde: Core = (self as any).dontCodeCore;\n","import { Change } from '@dontcode/core';\n\n/**\n * Description of a message exchanged between the components (client, services)\n * It can be an INIT with the sessionId requested or given\n * Or a CHANGE with the sessionId and Change\n */\nexport class Message {\n  type: MessageType;\n  sessionId?: string;\n  change?: Change;\n\n  constructor(type: MessageType, sessionId?: string, change?: Change) {\n    this.type = type;\n    this.sessionId = sessionId;\n    this.change = change;\n  }\n}\n\nexport enum MessageType {\n  INIT = 'INIT',\n  CHANGE = 'CHANGE',\n}\n","/**\n * Store a monetary amount together with the currency (value and currency).\n * To be used by all fields managing currencies ('Euro', 'Dollar', 'Other currency' by default) in order to facilitate exchange between plugins\n */\nexport class MoneyAmount {\n  amount: number | undefined;\n  currencyCode: string | undefined;\n}\n","import {Action} from \"../action/action\";\n\n/**\n * Defines how an action handler can act on data\n */\nexport interface ActionHandler {\n\n  /**\n   * Performs an action given the scope, the position in the meta-model, the action name and the data\n   * These actions do not return any data\n   * @param action\n   */\n  performAction (action: Action):Promise<void>;\n}\n\n/**\n * Helper in case you have synchronous action only and you don't want to manage promises\n */\nexport abstract class AbstractActionHandler implements ActionHandler {\n\n  performAction(action: Action): Promise<void> {\n    return new Promise(() => {\n      this.performSynchronousAction(action);\n    });\n  }\n\n  performSynchronousAction (action:Action): void {\n    // To be implemented\n    throw new Error (\"Action \"+action+\" for \"+action.context.valueOf()+\" at \"+action.position+\" not implemented yet\");\n  }\n}\n","import {\n  DontCodeStoreAggregate,\n  DontCodeStoreCriteria,\n  DontCodeStoreCriteriaOperator,\n  DontCodeStoreGroupby,\n  DontCodeStoreSort\n} from \"./dont-code-store-manager\";\nimport {DataTransformationInfo, DontCodeModelManager} from \"../model/dont-code-model-manager\";\nimport {DontCodeSchemaItem} from \"../model/dont-code-schema-item\";\nimport {DontCodeModelPointer} from \"../model/dont-code-schema\";\nimport {DontCodeGroupOperationType} from \"../globals\";\n\n/**\n * Helps handle metadata information about loaded items\n */\nexport class StoreProviderHelper {\n\n  static specialFieldsCache = new Map<string, SpecialFields>();\n  /**\n   * In case some entity definition has changed, clear the cache\n   */\n  public static clearConfigCache (): void {\n    this.specialFieldsCache.clear();\n  }\n\n  /**\n   * In case the provider source doesn't support search criteria, they can be applied here\n   * @param list\n   * @param criteria\n   */\n  public static applyFilters<T> (list:Array<T>, ...criteria: DontCodeStoreCriteria[]): Array<T> {\n    if ((criteria==null)||(criteria.length==0)) return list;\n    return list.filter(element => {\n      for (const criterium of criteria) {\n        const toTest = element[criterium.name as keyof T];\n        switch (criterium.operator) {\n          case DontCodeStoreCriteriaOperator.EQUALS:\n            return criterium.value==toTest;\n          case DontCodeStoreCriteriaOperator.LESS_THAN:\n            return toTest < criterium.value;\n          case DontCodeStoreCriteriaOperator.LESS_THAN_EQUAL:\n            return toTest <= criterium.value;\n          default:\n            throw new Error (\"Operator \"+criterium.operator+\" unknown\");\n        }\n      }\n      return true;\n    });\n    return list;\n  }\n\n  /** Returns any field who is a date, in order to convert it from json. Keep the result in a cache map\n   *\n   * @param position\n   * @param entity\n   * @protected\n   */\n  public static findSpecialFields (position:string, entity:any):SpecialFields {\n    let specialFields = StoreProviderHelper.specialFieldsCache.get(position);\n    if (specialFields!=null) return specialFields;\n\n    const curScore: {score:number, field:any} = {score:-1, field:null}\n\n    specialFields = new SpecialFields();\n    const fields = entity.fields;\n    if( fields!=null) {\n      let prop: keyof typeof fields;\n      for (prop in fields) {\n        // Finds the date fields that will need to be converted from json to javascript Date\n        if (fields[prop]?.type==='Date' || fields[prop]?.type==='Date & Time') {\n          specialFields.addDateField(fields[prop]?.name);\n        } else {\n          StoreProviderHelper.scoreIdFieldFromEntityField(fields[prop], curScore);\n        }\n      }\n    }\n    if (curScore.score>0) {\n      specialFields.idField=curScore.field;\n    }\n    StoreProviderHelper.specialFieldsCache.set(position, specialFields);\n\n    // eslint-disable-next-line no-restricted-syntax\n    console.debug(\"Found special fields for entity at position \"+position, specialFields);\n    return specialFields;\n  }\n\n  protected static findSpecialFieldsFromData(data: Array<any>, existingFields: SpecialFields) {\n    if( (existingFields.idField==null) && (data?.length>0)) {\n      // We must guess the id field from data\n      const first=data[0];\n      const curScore: {score:number, field:any} = {score:-1, field:null}\n      let prop: keyof typeof first;\n\n      for (prop in first) {\n        StoreProviderHelper.scoreIdFieldFromProperty(prop, curScore);\n      }\n      if (curScore.score>0) {\n        const test=data.length>1?data[Math.floor((data.length+1)/2)]:null;\n        if ((test==null) || (test[curScore.field]!=first[curScore.field]))  // Just check that another element doesn't have the same value as an id should be unique\n          existingFields.idField=curScore.field;\n      }\n    }\n  }\n\n  protected static scoreIdFieldFromEntityField (prop:any, score:{score:number, field:any}): boolean {\n    return StoreProviderHelper.scoreIdFieldFromProperty(prop?.name, score);\n  }\n\n  protected static scoreIdFieldFromProperty (name:string, score:{score:number, field:any}): boolean {\n    if( name==null)\n      return false;\n    const propName=name.toLowerCase();\n    // Finds if the element is the id field\n    if( propName === \"_id\") {\n      score.field=\"_id\";  // Don't need to process Id\n      score.score = 100;\n      return true;\n    } else {\n      if ((propName == \"id\")||(propName==\"uniqueid\")||(propName==\"identifier\") || (propName=='key') || (propName=='primaryKey')||(propName=='uniqueKey')) {\n        if (score.score<80) {\n          score.score=80;\n          score.field=name;\n        }\n      } else if (propName.includes(\"unique\")||propName.includes(\"primary\")) {\n        if (score.score<50) {\n          score.score = 50;\n          score.field=name;\n        }\n      }else if (propName.includes(\"id\")||propName.includes('key')) {\n        if (score.score<30) {\n          score.score = 30;\n          score.field=name;\n        }\n      }\n      return false;\n    }\n\n  }\n  /**\n   * Ensure _id is removed if necessary before saving the element\n   * @param listToConvert\n   * @param specialFields\n   * @protected\n   */\n  public static cleanUpDataBeforeSaving (listToConvert:Array<any>, specialFields:SpecialFields) : void {\n    if ((specialFields?.idField!=null)&&(specialFields?.idField!='_id')) {\n      listToConvert.forEach(value => {\n        delete value._id;\n      })\n    }\n  }\n\n  /**\n   * Converts dates and dateTimes properties of each element of the array to Typescript format\n   * Ensure _id is set with the right id\n   * @param listToConvert\n   * @param specialFields\n   * @protected\n   */\n  public static cleanUpLoadedData (listToConvert:Array<any>, specialFields:SpecialFields) : void {\n\n    if (specialFields!=null) {\n      if( specialFields.idField==null) {\n        StoreProviderHelper.findSpecialFieldsFromData (listToConvert, specialFields);\n      }\n      listToConvert.forEach((val)=> {\n        if ((specialFields.idField!=null)&&(specialFields.idField!=\"_id\")) // We need to copy the id to the standard _id field\n        {\n          val._id=val[specialFields.idField];\n        }\n        specialFields.dateFields?.forEach(prop => {\n          const toConvert = val[prop];\n          if (toConvert!=null) {\n            let timeEpoch =Date.parse(toConvert);\n            if( isNaN(timeEpoch)) {\n              // Invalid date try to remove a possible TZ description in []\n              const tzDescIndex = toConvert.lastIndexOf('[');\n              if (tzDescIndex!=-1) {\n                timeEpoch=Date.parse(toConvert.substring(0, tzDescIndex));\n              }\n            }\n            if (isNaN(timeEpoch)) {\n              delete val[prop];\n            }\n            else {\n              val[prop]=new Date(timeEpoch);\n            }\n          }\n        })\n      })\n    }\n  }\n\n  /**\n   * Sort the array using the defined sort declarations across all properties.\n   *\n   * @param toSort\n   * @param sortOptions\n   */\n  static multiSortArray<T>(toSort: T[], sortOptions?: DontCodeStoreSort): T[] {\n    if( sortOptions==null)\n      return toSort;\n    return toSort;\n  }\n\n  /**\n   * Calculates sum, avg, min or max values per group\n   * @param values\n   * @param groupBy\n   * @param modelMgr\n   * @param position\n   * @param item\n   */\n  static calculateGroupedByValues<T>(values: T[], groupBy: DontCodeStoreGroupby, modelMgr?: DontCodeModelManager, position?: DontCodeModelPointer, item?:DontCodeSchemaItem):DontCodeStoreGroupedByEntities|undefined {\n      // We are counting per different value of the groupedBy Item\n    if ((groupBy!=null) && (groupBy.display!=null)) {\n      let fieldToGroupBy=groupBy.of as keyof T;\n      if (groupBy.show!=null) fieldToGroupBy=groupBy.show.valueOf() as keyof T;\n\n      const counters=new Map<any,Map<keyof T, Counters>> ();\n      let lastGroupDelimiter:any;\n      let oneGroupOfCounters=new Map<keyof T, Counters>();\n\n      const fieldsRequired = groupBy.getRequiredListOfFields() as Set<keyof T>;\n      for (const value of values) {\n        if (value[fieldToGroupBy]!=lastGroupDelimiter) {   // We change the group\n          lastGroupDelimiter=value[fieldToGroupBy];\n          const storedGroupOfCounters=counters.get(lastGroupDelimiter);\n          if( storedGroupOfCounters==null) {\n            oneGroupOfCounters = new Map<keyof T, Counters>();\n            counters.set(lastGroupDelimiter, oneGroupOfCounters);\n          }else {\n            oneGroupOfCounters = storedGroupOfCounters;\n          }\n        }\n\n        for (const field of fieldsRequired) {\n          let counter=oneGroupOfCounters?.get(field);\n          if( counter==null) {\n            counter = new Counters();\n            oneGroupOfCounters.set(field, counter);\n          }\n\n          const valSrc=value[field];\n          const val=valSrc;\n          if (valSrc!=null) {\n              // If it's an object, we need to set the calculated values as the object itself\n            if ((typeof valSrc === 'object') &&  (!(valSrc instanceof Date)) && (modelMgr!=null)) {\n              if( counter.sum==null) counter.sum=structuredClone(valSrc);\n              else {\n                counter.sum=modelMgr.modifyValues(counter.sum, valSrc, counter.metaData,\n                  (first, second) => {\n                    if ((first!=null) && (second!=null))\n                      return first + second;\n                    else if (first == null) {\n                      return second;\n                    } else if (second==null) {\n                      return first;\n                    }\n                  },\n                  position, item);\n              }\n              const value=modelMgr.extractValue(valSrc, counter.metaData,position, item);\n              if( counter.minimum==null)  { counter.minimum=valSrc; counter.minAsValue=value}\n              else {\n                const minValue=counter.minAsValue;\n                if ((value!=null) && ((minValue==null) || (value < minValue)) ) { counter.minimum = valSrc; counter.minAsValue=value }\n              }\n\n              if( counter.maximum==null) { counter.maximum=valSrc; counter.maxAsValue=value;}\n              else {\n                const maxValue=counter.maxAsValue;\n\n                if ((value!=null) && ((maxValue==null) || (value > maxValue)))\n                  { counter.maximum = valSrc; counter.maxAsValue = value;}\n              \n              }\n\n              if (value!=null) {\n                counter.count++;\n              }\n\n            } else if (typeof val === 'number') {\n              if( counter.sum==null) counter.sum=0;\n              counter.sum=counter.sum+val;\n              if( (counter.minimum==null) || (val < counter.minimum))\n                { counter.minimum=valSrc; counter.minAsValue=valSrc as number;}\n              if( (counter.maximum==null) || (val > counter.maximum))\n                { counter.maximum=valSrc; counter.maxAsValue=valSrc as number;}\n              counter.count++;\n            } else if ((val instanceof Date) && (!isNaN(val.getTime()))) {\n              counter.sum=null;\n              if ((counter.minimum==null) || (val.valueOf() < counter.minimum.valueOf())) {\n                counter.minimum=valSrc;\n              }\n              if ((counter.maximum==null) || (val.valueOf() > counter.maximum.valueOf())) {\n                counter.maximum=valSrc;\n              }\n              counter.count++;\n            } else {  // strings\n              counter.count++;\n            }\n          }\n        }\n      }\n\n      // Now that we have all the counters, let's generate the GroupedFields\n      let ret: DontCodeStoreGroupedByEntities|undefined;\n      if (counters.size>0) {\n        ret = new DontCodeStoreGroupedByEntities(groupBy, new Map<any,DontCodeStoreGroupedByValues[]>);\n        for (const groupKey of counters.keys()) {\n          const group=counters.get(groupKey)!;\n\n          for (const aggregate of Object.values(groupBy.display)) {\n            let value;\n            const counter = group.get(aggregate.of as keyof T);\n            if (counter != null) {\n              switch (aggregate.operation) {\n                case DontCodeGroupOperationType.Count:\n                  value = counter.count;\n                  break;\n                case DontCodeGroupOperationType.Sum:\n                  value = counter.sum;\n                  break;\n                case DontCodeGroupOperationType.Average: {\n                  if ((counter.sum==null) || (counter.count==0)) value=null;\n                  else if ((typeof counter.sum === 'object') &&  (!(counter.sum instanceof Date)) && (modelMgr!=null)) {\n                    value = modelMgr.applyValue(structuredClone(counter.sum),\n                      modelMgr.extractValue(counter.sum, counter.metaData, position, item)/counter.count,\n                      counter.metaData, undefined, position, item);\n                  } else value = counter.sum / counter.count;\n                }\n                  break;\n                case DontCodeGroupOperationType.Minimum:\n                  value = counter.minimum;\n                  break;\n                case DontCodeGroupOperationType.Maximum:\n                  value = counter.maximum;\n                  break;\n              }\n              let listOfValues= ret.values?.get(groupKey);\n              if (listOfValues==null) {\n                listOfValues = new Array<DontCodeStoreGroupedByValues>();\n                  ret.values?.set(groupKey, listOfValues);\n              }\n              listOfValues.push(new DontCodeStoreGroupedByValues(aggregate, value));\n            }\n          }\n        }\n        return ret.values!.size>0?ret:undefined;\n      }\n    }\n    return undefined;\n  }\n}\n\nclass Counters {\n  sum:any;\n\n  count=0;\n\n  minimum: any;\n  minAsValue: number | null = null;\n\n  maximum: any;\n  maxAsValue: number | null = null;\n\n  metaData = new DataTransformationInfo();\n}\n\nexport class SpecialFields\n{\n  dateFields:Array<string>|null=null;\n  idField:any = null;\n\n  addDateField(name: any) {\n    if (this.dateFields==null) {\n      this.dateFields = new Array<string>();\n    }\n    this.dateFields.push(name);\n  }\n}\n\nexport class DontCodeStorePreparedEntities<T> {\n  constructor(public sortedData:T[], public sortInfo?:DontCodeStoreSort, public groupedByEntities?:DontCodeStoreGroupedByEntities) {\n  }\n}\n\nexport class DontCodeStoreGroupedByEntities {\n  constructor(public groupInfo:DontCodeStoreGroupby, public values?:Map<any,DontCodeStoreGroupedByValues[]>) {\n    if (values==null)\n      this.values=new Map<any,DontCodeStoreGroupedByValues[]>();\n  }\n}\n\nexport class DontCodeStoreGroupedByValues {\n  constructor(public forAggregate:DontCodeStoreAggregate, public value:any) {\n  }\n}\n","import {map, Observable} from 'rxjs';\nimport {\n  DontCodeStoreCriteria,\n  DontCodeStoreGroupby,\n  DontCodeStoreSort,\n  UploadedDocumentInfo\n} from './dont-code-store-manager';\nimport {\n  DontCodeStoreGroupedByEntities,\n  DontCodeStorePreparedEntities,\n  StoreProviderHelper\n} from \"./store-provider-helper\";\nimport {DontCodeDataTransformer} from \"./dont-code-data-transformer\";\nimport { DontCodeModelManager } from '../model/dont-code-model-manager';\n\n/**\n * The standard interface for any store provider\n */\nexport interface DontCodeStoreProvider<T=never> {\n  storeEntity(position: string, entity: T): Promise<T>;\n\n  /**\n   * Rejects the promise if the entity is not found\n   * @param position\n   * @param key\n   */\n  safeLoadEntity(position: string, key: any): Promise<T>;\n  loadEntity(position: string, key: any): Promise<T|undefined>;\n\n  deleteEntity(position: string, key: any): Promise<boolean>;\n\n  searchEntities(\n    position: string,\n    ...criteria: DontCodeStoreCriteria[]\n  ): Observable<Array<T>>;\n\n  searchAndPrepareEntities(\n    position: string,\n    sort?:DontCodeStoreSort,\n    groupBy?:DontCodeStoreGroupby,\n    transformer?: DontCodeDataTransformer<T>,\n    ...criteria: DontCodeStoreCriteria[]\n  ): Observable<DontCodeStorePreparedEntities<T>>;\n\n  canStoreDocument(position?: string): boolean;\n\n  /**\n   * Upload documents to a server store and returns the url or the id needed to retrieve them.\n   * @param toStore\n   * @param position\n   */\n  storeDocuments(\n    toStore: File[],\n    position?: string\n  ): Observable<UploadedDocumentInfo>;\n}\n\nexport abstract class AbstractDontCodeStoreProvider<T=never> implements DontCodeStoreProvider<T> {\n  abstract canStoreDocument(position?: string): boolean;\n\n  abstract deleteEntity(position: string, key: any): Promise<boolean>;\n\n  abstract loadEntity(position: string, key: any): Promise<T|undefined>;\n\n  protected modelMgr?:DontCodeModelManager;\n  \n  constructor (modelMgr?:DontCodeModelManager) {\n    this.modelMgr=modelMgr;\n  }\n\n  safeLoadEntity(position: string, key: any): Promise<T> {\n    return this.loadEntity(position, key).then(value => {\n      if (value==null)\n        return Promise.reject(\"Not found\");\n      else return value;\n    })\n  }\n\n  /**\n   * If the store supports queries with criteria, this function must be implemented, if not, listEntities must be implemented, and this function will apply filters\n   * @param position\n   * @param criteria\n   */\n  searchEntities(position: string, ...criteria: DontCodeStoreCriteria[]): Observable<T[]> {\n    return this.listEntities(position).pipe(\n      map (value => {\n        return StoreProviderHelper.applyFilters(value, ...criteria) as T[];\n      })\n    );\n  }\n\n  /**\n   * Returns the list of entities at a given position in the model. Implements at least this function or searchEntities depending on the capability of the store\n   * @param position\n   * @protected\n   */\n  protected listEntities (position:string): Observable<T[]> {\n    return this.searchEntities(position);\n  }\n\n  searchAndPrepareEntities(position: string, sort?: DontCodeStoreSort, groupBy?: DontCodeStoreGroupby, transformer?: DontCodeDataTransformer<T>, ...criteria: DontCodeStoreCriteria[]): Observable<DontCodeStorePreparedEntities<T>> {\n    return this.searchEntities(position, ...criteria).pipe(\n      map (value => {\n        // Run the transformation if any\n        if (transformer!=null) return transformer.postLoadingTransformation(value);\n        else return value;\n      }),\n      map (value => {\n        let groupedByValues:DontCodeStoreGroupedByEntities|undefined;\n        if((sort!=null) || (groupBy?.atLeastOneGroupIsRequested()===true)) {\n          value = StoreProviderHelper.multiSortArray(value, this.calculateSortHierarchy(sort, groupBy)) as T[];\n          if (groupBy!=null) {\n            groupedByValues = StoreProviderHelper.calculateGroupedByValues(value, groupBy, this.modelMgr);\n          }\n        }\n        return new DontCodeStorePreparedEntities<T> (value, sort, groupedByValues);\n      })\n    );\n  }\n\n  abstract storeDocuments(toStore: File[], position?: string): Observable<UploadedDocumentInfo>;\n\n  abstract storeEntity(position: string, entity: T): Promise<T>;\n\n\n  protected calculateSortHierarchy(sort?: DontCodeStoreSort, groupBy?: DontCodeStoreGroupby ):DontCodeStoreSort|undefined {\n    // We must first sort by the groupBy, and then by the sort\n    let rootSort:DontCodeStoreSort|undefined;\n    if (groupBy!=null) {\n      rootSort=new DontCodeStoreSort(groupBy.of, undefined, sort);\n    } else {\n      rootSort=sort;\n    }\n    return rootSort;\n  }\n\n}\n","import {Change, ChangeType} from '../change/change';\nimport {DontCodeModelPointer} from '../model/dont-code-schema';\nimport {dtcde} from \"../dontcode\";\nimport {AbstractDontCodeStoreProvider} from \"../store/dont-code-store-provider\";\nimport {DontCodeStoreCriteria, UploadedDocumentInfo} from \"../store/dont-code-store-manager\";\nimport {filter, firstValueFrom, from, map, Observable, take, throwError, timer} from \"rxjs\";\nimport {CommandProviderInterface} from \"../plugin/command-provider-interface\";\nimport {DontCodeSchemaManager} from \"../model/dont-code-schema-manager\";\nimport {Action} from \"../action/action\";\nimport { DontCodeModelManager } from '../model/dont-code-model-manager';\n\n/**\n * Ease the unit tests by providing helper functions\n */\nexport class DontCodeTestManager {\n  public static createDeleteChange(\n    containerSchema: string,\n    containerItemId: string | null,\n    schema: string | null,\n    itemId: string | null,\n    property?: string\n  ) {\n    return DontCodeTestManager.createAnyChange(\n      ChangeType.DELETE,\n      containerSchema,\n      containerItemId,\n      schema,\n      itemId,\n      null,\n      property\n    );\n  }\n\n  public static createMoveChange(\n    oldPosition: string,\n    beforeIdOrProperty: string | null,\n    containerSchema: string,\n    containerItemId: string | null,\n    schema: string,\n    itemId: string | null,\n    property?: string\n  ) {\n    const ret = DontCodeTestManager.createAnyChange(\n      ChangeType.MOVE,\n      containerSchema,\n      containerItemId,\n      schema,\n      itemId,\n      null,\n      property\n    );\n    ret.oldPosition = oldPosition;\n    if (beforeIdOrProperty) ret.beforeKey = beforeIdOrProperty;\n    return ret;\n  }\n\n  public static createTestChange(\n    containerSchema: string,\n    containerItemId: string | null,\n    schema: string | null,\n    itemId: string | null,\n    value: any,\n    property?: string\n  ) {\n    return DontCodeTestManager.createAnyChange(\n      ChangeType.ADD,\n      containerSchema,\n      containerItemId,\n      schema,\n      itemId,\n      value,\n      property\n    );\n  }\n\n  /**\n   * To help testing with pre-loaded data, you can add a storeprovider that will return the content of the file in the url\n   * whenever called for the position;\n   * @param position\n   * @param toFetchAsset\n   */\n/*  public static addDummyProviderFromAsset (position:string, toFetchAsset: string): Promise<void> {\n    return fetch(toFetchAsset).then(response => response.json()).then (content => {\n        DontCodeTestManager.addDummyProviderFromContent( position, content);\n    });\n  }\n*/\n\n  /**\n   * To help testing with pre-loaded data, you can add a storeprovider that will return the content of the file in the url\n   * whenever called for the position;\n   * @param position\n   * @param toFetchAsset\n   */\n  public static addDummyProviderFromContent (position:string, toReturn: any, modelMgr?:DontCodeModelManager): void {\n    dtcde.getStoreManager().setProvider(new DummyStoreProvider<never> (toReturn, modelMgr), position);\n  }\n\n  /**\n   * Wait until the tester function returns true. Ideal for ensuring tests wait an async result.\n   * It will call done () if tester was true, or done(\"Timeout\") if tester has always returned false\n   * @param tester\n   * @param done\n   * @param interval\n   * @param maxTry\n   */\n  public static waitUntilTrue ( tester: () => boolean, done: (err?:string) => void, interval?:number, maxTry?:number ): void {\n    DontCodeTestManager.waitUntilTrueAndEmit(tester, interval, maxTry).then ((ok)=> {\n      if (ok) {\n        done ();\n      }else {\n        done (\"Timeout waiting for an event\");\n      }\n    }, (err) => {\n      done (err);\n    });\n  }\n\n  public static waitUntilTrueAndEmit ( tester: () => boolean, interval?:number, maxTry?:number ): Promise<boolean> {\n      interval = interval??50;\n      maxTry=maxTry??50;\n\n      return firstValueFrom(timer(interval, interval).pipe(\n        take(maxTry),\n        filter( ()=> {\n          return tester();\n        }),\n        map(() => {\n            return true;\n          })\n        ),\n      {defaultValue:false}\n      );\n\n  }\n\n\n  public static createAnyChange(\n    type: ChangeType,\n    containerSchema: string,\n    containerItemId: string | null,\n    schema: string | null,\n    itemId: string | null,\n    value: any,\n    property?: string\n  ) {\n    const calcContainerItemId = containerItemId ? '/' + containerItemId : '';\n    const calcItemId = itemId ? '/' + itemId : '';\n    let calcSchema = schema ? '/' + schema : '';\n    if (containerSchema.length == 0) calcSchema = schema ? schema : '';\n    let calcProperty = property ? '/' + property : '';\n    if (containerSchema.length == 0 && calcSchema.length == 0)\n      calcProperty = property ? property : '';\n    const calcPropertySchemaItem = property\n      ? calcSchema + calcItemId\n      : itemId\n      ? calcSchema\n      : '';\n    const calcPropertySchema = property ? calcSchema : '';\n\n    return new Change(\n      type,\n      containerSchema +\n        calcContainerItemId +\n        calcSchema +\n        calcItemId +\n        calcProperty,\n      value,\n      new DontCodeModelPointer(\n        containerSchema +\n          calcContainerItemId +\n          calcSchema +\n          calcItemId +\n          calcProperty,\n        containerSchema + calcSchema + calcProperty,\n        containerSchema + calcContainerItemId + calcPropertySchemaItem,\n        containerSchema + calcPropertySchema,\n        property ?? itemId ?? undefined,\n        property != null\n      )\n    );\n  }\n}\n\n\n/**\n * Helper that emulates a StoreProvider with predefined values\n */\nclass DummyStoreProvider<T> extends AbstractDontCodeStoreProvider<T> {\n\n  content:any;\n\n  constructor(content: any, modelMgr?:DontCodeModelManager) {\n    super(modelMgr);\n    this.content = content;\n  }\n\n  canStoreDocument(position?: string): boolean {\n    return false;\n  }\n\n  deleteEntity(position: string, key: any): Promise<boolean> {\n    return Promise.reject(\"Not implemented by Dummy tester\");\n  }\n\n  loadEntity(position: string, key: any): Promise<T> {\n    if (this.content[key]!=null)\n      return Promise.resolve(this.content[key]);\n    return Promise.reject('Not found');\n  }\n\n  searchEntities(position: string, ...criteria: DontCodeStoreCriteria[]): Observable<Array<T>> {\n    if (Array.isArray(this.content)) {\n      return from([this.content]);\n    } else {\n      return from ([[this.content]]);\n    }\n  }\n\n  storeDocuments(toStore: File[], position?: string): Observable<UploadedDocumentInfo> {\n    return throwError(() => new Error (\"Not implemented by Dummy tester\"));\n  }\n\n  storeEntity(position: string, entity: T): Promise<T> {\n    return Promise.reject(\"Not implemented by Dummy tester\");\n  }\n\n}\n\n/**\n * A Class able to return a pre-defined json value. Can be used to inject to component\n */\nexport class TestProviderInterface implements CommandProviderInterface {\n  constructor(protected toRet: any) {}\n\n  getJsonAt(position: string): any {\n    return this.toRet;\n  }\n\n  receiveCommands(position?: string, lastItem?: string): Observable<Change> {\n    return new Observable<Change>();\n  }\n\n  calculatePointerFor(position: string): DontCodeModelPointer {\n    return dtcde.getSchemaManager().generateSchemaPointer(position);\n  }\n\n  getSchemaManager(): DontCodeSchemaManager {\n    return dtcde.getSchemaManager();\n  }\n\n  sendCommand(action: Action): Promise<void> {\n    return Promise.resolve(undefined);\n  }\n}\n\n","/**\n * Standard API for manipulating projects\n */\nexport class DontCodeProject {\n  name: string = '';\n  template: boolean = false;\n  description: string = '';\n  lastUpdated: Date | undefined;\n}\n","import { Inject, Injectable, Optional } from \"@angular/core\";\nimport { CommonLibConfig } from \"./common-lib-config\";\nimport { Observable, ReplaySubject, Subject } from \"rxjs\";\nimport { DONT_CODE_COMMON_CONFIG } from \"../common-global/globals\";\n\n/**\n * A service storing configuration information.\n * Configuration can be changed after loading\n */\n@Injectable({\n    providedIn: 'root',\n  })\n  export class CommonConfigService {\n      protected config: CommonLibConfig;\n      protected updates = new ReplaySubject<Readonly<CommonLibConfig>> (1);\n\n      constructor (@Optional() @Inject(DONT_CODE_COMMON_CONFIG) config: CommonLibConfig) {\n        this.config = config;\n        if( this.config==null) this.config={};\n      }\n\n      getConfig (): Readonly<CommonLibConfig> {\n        return this.config;\n      }\n      getUpdates (): Observable<Readonly<CommonLibConfig>> {\n        return this.updates;\n      }\n      \n      updateConfig (property:keyof CommonLibConfig, value:any) {\n        this.config[property]=value;\n        this.updates.next (this.config);\n      }\n\n      batchUpdateConfig (newValues: {[P in keyof CommonLibConfig]:any}) {\n        this.config = Object.assign(this.config, newValues);\n        this.updates.next (this.config);\n      }\n  }  ","import {Inject, InjectionToken, Optional} from \"@angular/core\";\nimport {MenuItem} from \"primeng/api\";\n\nexport interface CommonLibConfig {\n  webSocketUrl?: string;\n  ideWebSocketUrl?: string;\n  projectApiUrl?: string;\n  storeApiUrl?:string;\n  documentApiUrl?:string;\n  indexedDbName?: string;\n  applicationName?: string;\n  theme?: string;\n  templateFileUrl?: string;\n}\n\n\n/*export const basicStoreApiUrlConfig = (config:CommonLibConfig) => {\n  return config.storeUrl;\n};\n\nexport const basicDocumentApiUrlConfig = (config:CommonLibConfig) => {\n  return config.documentUrl;\n};*/\n\nexport const CHANNEL_CHANGE_NAME='preview-ui-changes';\n\n/**\n * Allows application to add any menu\n */\nexport interface MenuUpdater {\n  additionalMenus (): MenuItem[];\n}\n\nexport const SANDBOX_MENUS = new InjectionToken<MenuUpdater>('Allows addition of menus');\n","import {\n  createNgModule,\n  createNgModuleRef,\n  getNgModuleById,\n  Inject,\n  Injectable,\n  Injector,\n  NgModuleRef,\n  Optional,\n  Type,\n  ViewContainerRef,\n} from '@angular/core';\nimport {\n  ChangeHandlerConfig,\n  CommandProviderInterface,\n  Core,\n  DontCodeModelPointer,\n  DontCodePreviewManager,\n  PluginModuleInterface,\n  PreviewHandler,\n} from '@dontcode/core';\nimport {DynamicComponent} from '../common-ui/dynamic-component';\nimport {COMMAND_PROVIDER, DONT_CODE_CORE} from '../common-global/globals';\nimport {Mutex} from 'async-mutex';\n\n/**\n * Manages the dynamic loading of components able to display a data located at a specific pointer position\n * Depending on the plugins loaded, a different component can display the same value.\n *\n * It keeps in cache as well the component factory and module used for a pointer position\n */\n@Injectable({\n  providedIn: 'root',\n})\nexport class ComponentLoaderService {\n  protected moduleMap = new Map<string, NgModuleRef<PluginModuleInterface>>();\n  mutex = new Mutex();\n\n  constructor(\n    protected injector: Injector,\n    @Inject(DONT_CODE_CORE)\n    protected dontCodeCore: Core,\n    protected previewMgr: DontCodePreviewManager,\n    @Optional()\n    @Inject(COMMAND_PROVIDER)\n    protected provider?: CommandProviderInterface\n  ) {\n  }\n\n  /**\n   * Either creates or retrieves the module whose name is in parameter.\n   * @param moduleName\n   */\n  getOrCreatePluginModuleRef (moduleSource:string): Promise<NgModuleRef<PluginModuleInterface>> {\n    return this.mutex.acquire().then((release) => {\n      try {\n        let moduleRef = this.moduleMap.get(moduleSource);\n        if (!moduleRef) {\n          moduleRef = createNgModule(\n            getNgModuleById ('dontcode-plugin/' + moduleSource),\n            this.injector);\n          if (moduleRef) {\n            this.moduleMap.set(moduleSource, moduleRef);\n          }\n        }\n        return moduleRef;\n      } finally {\n        release();\n      }\n    });\n\n  }\n\n  loadPluginModule(\n    handlerConfig: ChangeHandlerConfig\n  ): Promise<NgModuleRef<PluginModuleInterface>> {\n    return this.getOrCreatePluginModuleRef(handlerConfig.class.source).then(moduleRef => {\n      if (moduleRef!=null) {\n        // Now init the newly loaded module\n        this.dontCodeCore.initPlugins();\n      }\n      return moduleRef;\n    })\n  }\n\n  insertComponentForFieldType (type: string,\n                               insertPoint: ViewContainerRef\n  ) {\n    return this.insertComponent('creation/entities/fields/type', insertPoint, type);\n  }\n\n  insertComponent(\n    schemaPosition: DontCodeModelPointer | string,\n    insertPoint: ViewContainerRef,\n    currentJson?: any\n  ): Promise<DynamicComponent | null> {\n    let schemaPos: string = (schemaPosition as DontCodeModelPointer)\n      .positionInSchema;\n    let isPointer: boolean;\n    if (schemaPos) {\n      isPointer = true;\n      if (!currentJson) {\n        currentJson = this.provider?.getJsonAt(\n          (schemaPosition as DontCodeModelPointer).position\n        );\n      }\n    } else {\n      isPointer=false;\n      schemaPos = schemaPosition as string;\n    }\n\n    const handlerConfig = this.previewMgr.retrieveHandlerConfig(\n      schemaPos,\n      currentJson\n    );\n\n    if (handlerConfig) {\n      //console.debug('Importing from ', handlerConfig.class.source);\n      // First lets try if the plugin is imported during the compilation\n\n      return this.loadPluginModule(handlerConfig)\n        .then((moduleRef) => {\n          const componentClass = moduleRef.instance\n            .exposedPreviewHandlers()\n            .get(handlerConfig.class.name);\n\n          return this.createComponent(componentClass, insertPoint, moduleRef, isPointer?schemaPosition as DontCodeModelPointer:null);\n        })\n        .catch((reason) => {\n          console.error (\"Cannot load module because of \", reason);\n          return Promise.reject(\n            'Cannot load module for source ' +\n              handlerConfig.class.source +\n              ' because of ' +\n              reason\n          );\n        });\n      //console.log (\"Applying component\");\n    } else {\n      return Promise.resolve(null);\n    }\n  }\n\n  createComponent(\n    componentClass: Type<DynamicComponent>,\n    insertPoint: ViewContainerRef,\n    moduleRef: NgModuleRef<PluginModuleInterface> | undefined,\n    position: DontCodeModelPointer | null\n  ): DynamicComponent {\n    let injector = this.injector;\n    const componentRef = insertPoint.createComponent(\n      componentClass, {\n      injector:injector,\n      ngModuleRef: moduleRef\n      }\n    );\n    const component = componentRef.instance as DynamicComponent;\n\n    if ((component as unknown as PreviewHandler).initCommandFlow) {\n      // It's a previewHandler\n      if (!position)\n        throw new Error(\n          'Component ' +\n            component.constructor.name +\n            ' is a PreviewHandler and parent position is missing.'\n        );\n      if (!this.provider)\n        throw new Error(\n          'Component ' +\n            component.constructor.name +\n            ' is a PreviewHandler and CommandProviderInterface is missing.'\n        );\n      (component as unknown as PreviewHandler).initCommandFlow(\n        this.provider,\n        position\n      );\n    }\n    return component;\n  }\n\n  /**\n   * For some reasons, during a Jest test, modules are not registered in Angular getNgModuleById(), so we let the possibility to do it by hand\n   * @param module\n   * @param source\n   */\n  registerModuleForTest (module:NgModuleRef<PluginModuleInterface>|Type<PluginModuleInterface>, source:string) {\n    if( (module as any).instance == null )  // It's not a NgModuleRef\n      this.moduleMap.set(source, createNgModule(module as Type<PluginModuleInterface>, this.injector));\n    else\n      this.moduleMap.set(source, module as NgModuleRef<PluginModuleInterface>);\n  }\n}\n","import {InjectionToken} from \"@angular/core\";\nimport {CommandProviderInterface, Core} from \"@dontcode/core\";\nimport { CommonLibConfig } from \"../common-config/common-lib-config\";\n\nexport let COMMAND_PROVIDER = new InjectionToken<CommandProviderInterface>('Inject the current command provider interface');\n\n/**\n * Enable the Dont-code Core interface to be injected\n */\nexport const DONT_CODE_CORE=new InjectionToken<Core>(\"Dont-code core object\");\n\n/**\n * Enable the injection of static config parameters (internal use only)\n */\nexport const DONT_CODE_COMMON_CONFIG = new InjectionToken<CommonLibConfig>('DontCodeCommonLibConfig');\n","import {\n  Action,\n  ActionHandler,\n  Change,\n  CommandProviderInterface,\n  DontCodeModelPointer,\n  PreviewHandler\n} from \"@dontcode/core\";\nimport {Subscription} from \"rxjs\";\nimport {PluginHandlerHelper} from \"./plugin-handler-helper\";\n\n/**\n * Helps develop a plugin handler that is not an Angular Component. For an Angular Component handling model changes, please use PluginBaseComponent\n */\nexport abstract class AbstractPluginHandler implements PreviewHandler, ActionHandler {\n  protected subscriptions = new Subscription();\n  protected pluginHelper = new PluginHandlerHelper();\n  protected entityPointer: DontCodeModelPointer | null = null\n  protected provider: CommandProviderInterface | null = null;\n\n  protected unsubscribe(): void {\n    this.pluginHelper.unsubscribe();\n    this.subscriptions.unsubscribe();\n  }\n\n  initCommandFlow(provider: CommandProviderInterface, pointer: DontCodeModelPointer): any {\n    this.entityPointer = pointer;\n    this.provider = provider;\n    this.pluginHelper.initCommandFlow(provider, pointer, this);\n  }\n\n  protected initChangeListening() {\n    this.pluginHelper.initChangeListening();\n  }\n\n  /**\n   * When the component is created for display, it receives the initial data as complete Json.\n   * If it wants, it can call this method who will call handleChange for each property.\n   * This will avoid to duplicate code (first time when a complete json is sent, second when subelements are sent)\n   * @protected\n   */\n  protected decomposeJsonToMultipleChanges(pointer: DontCodeModelPointer, json: any): void {\n    this.pluginHelper.decomposeJsonToMultipleChanges(pointer, json);\n  }\n\n  /**\n   * Updates the array of T elements by applying the changes received and calling the transform method\n   * @param cols\n   * @param colsMap\n   * @param change\n   * @param property\n   * @param transform\n   * @private\n   */\n  applyUpdatesToArray<T>(target: T[], targetMap: Map<string, number>, change: Change, property: string, transform: (position: DontCodeModelPointer, item: any) => T, applyProperty?: (target: T, key: string, value: any) => boolean): Promise<T[]> {\n    return this.applyUpdatesToArrayAsync(target, targetMap, change, property, (key, item) => {\n      return Promise.resolve( transform(key, item));\n    } );\n  }\n\n  /**\n   * Updates the array of T elements by applying the changes received and calling the transform method\n   * @param target\n   * @param targetMap\n   * @param change\n   * @param property\n   * @param transform\n   * @param parentPosition\n   * @param applyProperty\n   * @private\n   */\n  applyUpdatesToArrayAsync<T>(target: T[], targetMap: Map<string, number>, change: Change, property: string|null, transform: (position: DontCodeModelPointer, item: any) => Promise<T>,\n                              parentPosition?: string, applyProperty?: (target: T, key: string|null, value: any) => boolean): Promise<T[]> {\n    return this.pluginHelper.applyUpdatesToArrayAsync(target, targetMap, change, property, transform, parentPosition, applyProperty);\n  }\n\n  /**\n   * This is where components react to changes received\n   * @param change\n   * @protected\n   */\n  abstract handleChange(change: Change): void;\n\n  /**\n   * Called whenever an action needs to be performed on the data\n   * @param action\n   */\n  performAction(action: Action): Promise<void> {\n    return Promise.resolve(undefined);\n  }\n\n}\n","import {\n  Action,\n  ActionHandler,\n  Change,\n  ChangeType,\n  CommandProviderInterface,\n  DontCodeModelPointer,\n  PreviewHandler,\n} from '@dontcode/core';\nimport {catchError, first, flatMap, last, map, takeLast} from 'rxjs/operators';\nimport {firstValueFrom, from, Observable, of, Subscription} from 'rxjs';\nimport { Mutex } from 'async-mutex';\n\n/**\n * This class does all the hard work of managing changes and actions, so that your plugin only has to implement handleChange and performAction\n * As there is no one to one mapping between the position of the change and the position the plugin is interested in, we need to generate subevent to ensure the plugin is receiving updates.\n */\nexport class PluginHandlerHelper {\n  protected subscriptions = new Subscription();\n\n  entityPointer: DontCodeModelPointer | null = null;\n  provider: CommandProviderInterface | null = null;\n  changeHandler: PreviewHandler | null = null;\n  actionPerformer: ActionHandler | null = null;\n  mutex = new Mutex();\n\n  initCommandFlow(\n    provider: CommandProviderInterface,\n    pointer: DontCodeModelPointer,\n    changeHandler: PreviewHandler,\n    actionPerformer?: ActionHandler\n  ): any {\n    this.entityPointer = pointer;\n    this.provider = provider;\n    this.changeHandler = changeHandler;\n    if (actionPerformer!=null)\n      this.actionPerformer=actionPerformer;\n    else if ((changeHandler as any).performAction != null) {\n        // The changehandler is as well an action performer\n      this.actionPerformer= changeHandler as unknown as ActionHandler;\n    }\n  }\n\n  /**\n   * When the component is created for display, it receives the initial data as complete Json.\n   * If it wants, it can call this method who will call handleChange for each property.\n   * This will avoid to duplicate code (first when a complete json is sent, then when subelements are sent)\n   * @protected\n   */\n  decomposeJsonToMultipleChanges(\n    pointer: DontCodeModelPointer,\n    json: any\n  ): void {\n    // Do nothing as now the events are already splitted per subItems\n    if (typeof json === 'object' && this.provider) {\n      let change: Change;\n      const schemaManager = this.provider.getSchemaManager();\n      for (const prop in json) {\n        if (json.hasOwnProperty(prop)) {\n          const subPropertyPointer = schemaManager.generateSubSchemaPointer(\n            pointer,\n            prop\n          );\n          const propType = schemaManager.locateItem(\n            subPropertyPointer.positionInSchema\n          );\n          if (propType?.isArray() && subPropertyPointer.isProperty) {\n            this.decomposeJsonToMultipleChanges(subPropertyPointer, json[prop]);\n          } else {\n            change = new Change(\n              ChangeType.RESET,\n              pointer.position + '/' + prop,\n              json[prop],\n              subPropertyPointer\n            );\n            if (!propType && change.pointer) {\n              // This is not a sub property but a subItem of an array\n              //change.pointer.itemId = change.pointer.key;\n              change.pointer.isProperty = false;\n            }\n\n            if (this.changeHandler!=null) this.changeHandler.handleChange(change);\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Calls handleChange each time a change event for any element below this (as per the model's position) is received\n   * @protected\n   */\n  initChangeListening(subElement?: boolean):void {\n    this.initOtherChangeListening(subElement, this.entityPointer);\n  }\n\n  /**\n   * Calls handleChange each time a change event for any element of the model given in parameter\n   * @protected\n   */\n  initOtherChangeListening(subElement?: boolean, pointer?:DontCodeModelPointer|null):void {\n    if (this.provider && pointer) {\n      let filter = pointer.position;\n      if (subElement !== true) filter += '/?';\n      this.subscriptions.add(\n        this.provider\n          .receiveCommands(filter)\n          .pipe(\n            map((change) => {\n              if ((change as any).actionType!=null) // It's an action, not a change\n              {\n                if (this.actionPerformer) {\n                  const action = change as unknown as Action;\n\n                  action.running?.next(this.actionPerformer.performAction(action));\n                }\n              }\n              else if (this.changeHandler) {\n                this.changeHandler.handleChange(change);\n              }\n            })\n          )\n          .subscribe()\n      );\n    } else {\n      throw new Error(\n        'Cannot listen to change before initCommandFlow is called'\n      );\n    }\n  }\n\n  /**\n   * Updates the array of T elements by applying the changes received and calling the transform method\n   * @param cols\n   * @param colsMap\n   * @param change\n   * @param property\n   * @param transform\n   * @private\n   */\n  applyUpdatesToArray<T>(\n    target: T[],\n    targetMap: Map<string, number>,\n    change: Change,\n    property: string,\n    transform: (position: DontCodeModelPointer, item: any) => T,\n    applyProperty?: (target: T, key: string, value: any) => boolean\n  ): Promise<T[]> {\n    return this.applyUpdatesToArrayAsync(\n      target,\n      targetMap,\n      change,\n      property,\n      (key, item) => {\n        return Promise.resolve(transform(key, item));\n      }\n    );\n  }\n\n  /**\n   * Updates the array of T elements by applying the changes received and calling the transform method\n   * @param target\n   * @param targetMap\n   * @param change\n   * @param property\n   * @param transform\n   * @param parentPosition\n   * @param applyProperty\n   * @private\n   */\n  applyUpdatesToArrayAsync<T>(\n    target: T[],\n    targetMap: Map<string, number>,\n    change: Change,\n    property: string | null,\n    transform: (position: DontCodeModelPointer, item: any) => Promise<T>,\n    parentPosition?: string,\n    applyProperty?: (target: T, key: string | null, value: any) => boolean\n  ): Promise<T[]> {\n    // We have the mutex to avoid multiple changes checking the map and target array at the same time...\n    return this.mutex.runExclusive(()=> {\n      try {\n        if (!this.provider)\n          throw new Error(\n            'Cannot apply updates before initCommandFlow is called'\n          );\n        if (!change.pointer) {\n          change.pointer = this.provider.calculatePointerFor(change.position);\n        }\n        // If the change concerns the array, then calculates it's element (itemId)\n        parentPosition = parentPosition??this.entityPointer?.position;\n        if (property != null) parentPosition = parentPosition + '/' + property;\n        const subItem = change.pointer.containerPosition === parentPosition;\n        let itemId = subItem\n          ? change.pointer.lastElement\n          : DontCodeModelPointer.lastElementOf(\n              change.pointer.containerPosition\n            ) ?? null;\n\n        let propertyId = change.pointer.isProperty\n          ? change.pointer.lastElement\n          : null;\n        let futureTarget: Observable<T> | null = null;\n        let newTarget: T | null = null;\n        let pos = -1;\n        let targetPos = -1;\n\n        if (itemId != null && targetMap.has(itemId)) {\n          // Does the target item already exist ?\n          pos = targetMap.get(itemId) as number;\n          newTarget = target[pos];\n          futureTarget = of(newTarget);\n        }\n        if (change.beforeKey) {\n          targetPos = targetMap.get(change.beforeKey) as number;\n        }\n\n        switch (change.type) {\n          case ChangeType.ADD:\n          case ChangeType.UPDATE:\n          case ChangeType.RESET:\n            if (propertyId != null) {\n              // It's not a replacement of the item but a change in one of its property\n              // Can we try to update directly the sub property?\n              if (\n                !newTarget ||\n                (newTarget &&\n                  (!applyProperty ||\n                    !applyProperty(newTarget, propertyId, change.value)))\n              ) {\n                // It cannot be dynamically updated by the caller, so we do a full replacement\n                const fullValue = this.provider.getJsonAt(\n                  change.pointer.containerPosition as string\n                );\n                //if (change.value!==fullValue[propertyId]) { Don't check as the new value as already been set in the json\n                const parentPointer = this.provider.calculatePointerFor(\n                  change.pointer.containerPosition as string\n                );\n                if (parentPointer.isProperty)\n                  throw new Error(\n                    'A parent of a property ' +\n                      change.pointer.position +\n                      ' must be an array'\n                  );\n                futureTarget = from(transform(parentPointer, fullValue));\n                /*                      }else {\n                        // We set the same value, so nothing changed\n                        futureTarget = null;\n                      }*/\n              }\n            } else {\n              // The new value replace the old one\n              futureTarget = from(transform(change.pointer, change.value));\n            }\n            break;\n          case ChangeType.MOVE:\n            if (pos !== -1 && subItem && itemId) {\n              // We delete the element moved, it will be inserted at the right position later\n              if (targetPos !== -1 && targetPos > pos) targetPos--;\n              target.splice(pos, 1);\n              // Recalculate all indexes in targetMap\n              targetMap.forEach((value, key) => {\n                if (value > pos) {\n                  targetMap.set(key, value - 1);\n                }\n              });\n              targetMap.delete(itemId);\n              pos = -1;\n            }\n            break;\n          case ChangeType.DELETE:\n            if (pos !== -1 && subItem && itemId) {\n              target.splice(pos, 1);\n              // Recalculate all indexes in targetMap\n              targetMap.forEach((value, key) => {\n                if (value > pos) {\n                  targetMap.set(key, value - 1);\n                }\n              });\n              targetMap.delete(itemId);\n            }\n            futureTarget = null;\n            break;\n        }\n\n        if (futureTarget) {\n          return firstValueFrom(futureTarget\n            .pipe(\n              map((result) => {\n                if (pos !== -1) {\n                  // We just need to replace the new value at the same position\n                  target[pos] = result;\n                } else if (targetPos !== -1) {\n                  // Insert the element at the correct position\n                  target.splice(targetPos, 0, result);\n                  // Recalculate all indexes in targetMap\n                  targetMap.forEach((value, key) => {\n                    if (value >= targetPos) {\n                      targetMap.set(key, value + 1);\n                    }\n                  });\n                  if (itemId != null) targetMap.set(itemId, targetPos);\n                  else\n                    throw new Error(\n                      'Cannot set targetPos ' +\n                        targetPos +\n                        ' without knowing the itemId'\n                    );\n                } else {\n                  // Insert the element at the end\n                  target.push(result);\n                  if (itemId != null) targetMap.set(itemId, targetMap.size);\n                  else\n                    throw new Error(\n                      'Cannot set targetPos ' +\n                        targetPos +\n                        ' without knowing the itemId'\n                    );\n                }\n                return target;\n              }),\n              takeLast(1),\n              catchError((error) => {\n                return Promise.reject(error);\n              })\n            )\n          )\n        } else {\n          return Promise.resolve(target);\n        }\n      } catch (error) {\n        return Promise.reject(error);\n      }\n    });\n  }\n\n  unsubscribe() {\n    this.subscriptions.unsubscribe();\n  }\n\n  /**\n   * Sends the action to whatever component can perform it\n   * @param action\n   */\n  async performAction(action: Action): Promise<void> {\n    if( this.provider!=null)\n      await this.provider.sendCommand (action);\n    else return Promise.reject('No provider for the component at position '+this.entityPointer?.position );\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {\n  DontCodeModelManager, DontCodeModelPointer,\n  DontCodeReportGroupType,\n  DontCodeReportSortType,\n  DontCodeStoreCriteria,\n  DontCodeStoreGroupby,\n  DontCodeStoreManager,\n  DontCodeStorePreparedEntities,\n  StoreProviderHelper\n} from \"@dontcode/core\";\nimport {map} from \"rxjs/operators\";\nimport {firstValueFrom} from \"rxjs\";\nimport {DontCodeDataTransformer} from \"@dontcode/core\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class EntityStoreService {\n\n  protected listsByPosition = new Map<string, EntityListManager<any>> ();\n  constructor(protected storeMgr:DontCodeStoreManager, protected modelMgr:DontCodeModelManager) { }\n\n  retrieveListManager<T=never> (pointer:DontCodeModelPointer, description:any, ): EntityListManager<T> {\n    let newOne:EntityListManager<any>|undefined = this.listsByPosition.get(pointer.position);\n    if (newOne == null){\n      newOne = new EntityListManager<T>(pointer, description, this.storeMgr, this.modelMgr);\n      this.listsByPosition.set(pointer.position, newOne);\n    }\n    return newOne;\n  }\n}\n\n/**\n * Manages a list of any object stored by the Dont-Code StoreManager in a way that Angular detects the changes\n */\nexport class EntityListManager<T=never> {\n  protected pointer: DontCodeModelPointer;\n  protected description:any;\n  /**\n   * The array of entities to use\n   */\n  entities: T[]|null = null;\n  prepared : DontCodeStorePreparedEntities<T>|null = null;\n\n  constructor(pointer:DontCodeModelPointer, description: any, protected storeMgr:DontCodeStoreManager, protected modelMgr:DontCodeModelManager) {\n    this.pointer = pointer;\n    this.description = description;\n  }\n\n  push (element:T):void {\n    if (this.entities==null)\n      this.entities=new Array<T>(element);\n    else\n      this.entities = [...this.entities, element];\n  }\n\n  updateWithDetailedEntity (element:T):T {\n    const elementId=(element as any)._id;\n    const updated = new Array<T>();\n    if (this.entities!=null) {\n      this.entities.forEach(value => {\n        const valueId=(value as any)._id;\n        if( valueId==elementId) {\n          element={...element, ...value};\n          updated.push(element);\n        }else {\n          updated.push(value);\n        }\n      })\n      this.entities = [...updated];\n    } else {\n      this.entities = [element];\n    }\n    return element;\n  }\n\n  replace (element:T):boolean {\n    if (this.entities==null) return false;\n\n    const elementId=(element as any)._id;\n    let ret=false;\n    const updated = new Array<T>();\n    this.entities.forEach(value => {\n      const valueId=(value as any)._id;\n      if( valueId==elementId) {\n        updated.push(element);\n        ret = true;\n      }else {\n        updated.push(value);\n      }\n    })\n    this.entities = [...updated];\n    return ret;\n  }\n\n  remove (element:T): Promise<boolean> {\n    if (this.entities==null) return Promise.resolve(false);\n\n    const elementId=(element as any)._id;\n    if (elementId==null)  // Not saved yet, so just remove it from the list\n    {\n      return new Promise (resolve => {\n        if (this.entities!=null) {\n          this.entities = this.entities.filter(val => (val!==element));\n          this.prepared=null;\n          resolve( true);\n        } else resolve (false);\n      });\n    }else {\n    return this.storeMgr.deleteEntity(this.pointer.position, elementId).then(deleted => {\n      if( deleted) {\n        if (this.entities!=null) {\n          this.entities = this.entities.filter(val => (val!==element));\n          this.prepared=null;\n        }\n      }\n      return deleted;\n    }).catch((reason:Error) => {\n      console.error(reason.message);\n      return false;\n    });\n    }\n  }\n\n  reset (): void {\n    if( this.entities!=null)\n      this.entities.length=0;\n    this.prepared=null;\n  }\n\n  store (element:any): Promise<any> {\n    this.prepared=null;\n    return this.storeMgr.storeEntity(this.pointer.position, element);\n  }\n\n  /**\n   * Saves permanently all elements that have been changed\n   */\n  async storeAllChanged (): Promise<any> {\n    if (this.entities==null) return;\n\n    this.prepared=null;\n    for (const entity of this.entities) {\n      await this.storeMgr.storeEntity(this.pointer.position, entity);\n    }\n  }\n\n  loadAll (): Promise<void> {\n    return firstValueFrom(this.storeMgr.searchEntities(this.pointer.position).pipe(\n      map (values => {\n        this.prepared=null;\n        this.entities = [...values];\n      return;\n    })\n    ), {defaultValue:undefined});\n  }\n\n  searchAndPrepareEntities(\n    sort?:{[key:string]:DontCodeReportSortType}|undefined,\n    groupBy?:{[key:string]:DontCodeReportGroupType}|undefined,\n    dataTransformer?:DontCodeDataTransformer,\n    ...criteria: DontCodeStoreCriteria[]\n  ): Promise<void> {\n      // It only supports one groupby and one sortby for now, so just find one if any\n    let listOfValues:any[] = (sort!=null)?Object.values(sort):[];\n    const sortStore = (listOfValues.length>0)?listOfValues[0]:undefined;\n    listOfValues=(groupBy!=null)?Object.values(groupBy):[];\n    const groupByStore= (listOfValues.length>0)?new DontCodeStoreGroupby(listOfValues[0].of,listOfValues[0].display, listOfValues[0].show):undefined;\n    if (this.entities!=null) {\n      this.prepared=null;\n      // Already loaded, just sort & group\n      let sortedValues= this.entities;\n      let groupedValues=undefined;\n\n      if( criteria!=null)\n        sortedValues=StoreProviderHelper.applyFilters(sortedValues, ...criteria);\n      if( dataTransformer!=null) {\n        sortedValues= dataTransformer.postLoadingTransformation(sortedValues);\n      }\n      if (sortStore!=null){\n        sortedValues=StoreProviderHelper.multiSortArray(sortedValues,sortStore);\n      }\n      if (groupByStore!=null){\n        groupedValues=StoreProviderHelper.calculateGroupedByValues(sortedValues, groupByStore, this.modelMgr, this.pointer);\n      }\n      if ((criteria!=null) || (sort!=null) || (groupBy!=null)) {\n        this.prepared=new DontCodeStorePreparedEntities<any>(sortedValues, sortStore, groupedValues);\n      }\n      this.entities=sortedValues; // Updates the list with sorted and modified values\n      return Promise.resolve();\n    } else {\n      // Not loaded already, just ask the store to do it\n      return firstValueFrom(this.storeMgr.searchAndPrepareEntities(this.pointer.position, sortStore, groupByStore, dataTransformer, ...criteria).pipe(\n        map (value => {\n          this.prepared=value;\n          this.entities=this.prepared.sortedData;\n        }))\n      )\n    }\n  }\n\n\n  /**\n   * Loads the detail of an already loaded item. Makes sure it only add any additional fields without changing any values of the item in memory\n   * @param toLoad\n   */\n  loadDetailFromKey (key:any): Promise<any> {\n    if( key==null)\n      return Promise.reject(\"Cannot load entity with null key\");\n    return this.storeMgr.loadEntity(this.pointer.position, key).then(loaded => {\n      if (loaded!=null) {\n        return this.updateWithDetailedEntity(loaded);\n      }\n      return loaded;\n    });\n  }\n    /**\n   * Loads the detail of an already loaded item.\n   * @param toLoad\n   */\n  loadDetailOf (toLoad:any): Promise<any> {\n    return this.loadDetailFromKey(toLoad._id);\n  }\n}\n","import {DynamicComponent} from \"./dynamic-component\";\nimport {FormControl, FormGroup} from \"@angular/forms\";\nimport {PossibleTemplateList, TemplateList} from \"./template-list\";\nimport {DynamicEventSource, DynamicEventType} from \"./dynamic-event\";\nimport {Subscription} from \"rxjs\";\nimport {Component, OnDestroy} from \"@angular/core\";\n\n/**\n * A component that can be dynamically loaded by the dont-code framework.\n * It can integrate with a reactive form.\n * To dynamically load other Dont-code components for subFields, you should use AbstractDynamicLoaderComponent instead\n * To listen to model change, you have to derive from PluginBaseComponent instead.\n */\n@Component({template:''})\nexport abstract class AbstractDynamicComponent implements DynamicComponent, OnDestroy{\n\n  name!: string;\n  value: any;\n  form!: FormGroup;\n\n  parentPosition:string|null=null;\n\n  subscriptions = new Subscription();\n\n  setName(name: string): void {\n    this.name = name;\n  }\n\n  getValue(): any {\n    if (this.form!=null)\n      this.updateValueFromForm();\n    return this.value;\n  }\n\n  setValue(val: any): void {\n    this.value=val;\n\n    if (this.form!=null)\n      this.hydrateValueToForm ();\n  }\n\n  setParentPosition(position: string) {\n    this.parentPosition=position;\n  }\n\n  abstract providesTemplates(key?: string): TemplateList;\n  abstract canProvide(key?: string): PossibleTemplateList;\n\n  setForm(form: FormGroup): void {\n    this.form=form;\n    if ((this.form!=null) && (this.name!=null)) {\n      this.createAndRegisterFormControls();\n    }\n  }\n\n  getForm (): FormGroup {\n    return this.form;\n  }\n\n  /**\n   * By default registers a single control with the name this.name\n   * @protected\n   */\n  protected createAndRegisterFormControls (): void {\n    const control = new FormControl (null, {updateOn:'blur'});\n    this.form.registerControl(this.name, control);\n  }\n  /**\n   * This method allows components to generate a value manageable in FormControl from the original value (set by setValue ())\n   * By default the same value is used\n   * @param val\n   */\n  transformToFormGroupValue(val: any): any {\n    return val;\n  }\n\n  /**\n   * From the values in FormControl to a value manageable by the Dont-code Framework. Will be called by getValue\n   * By default the same value is used\n   * @param val\n   */\n  transformFromFormGroupValue(val: any): any {\n    return val;\n  }\n\n  /**\n   * Updates the form with the value\n   */\n  hydrateValueToForm ():void {\n    if (this.name!=null) {\n      const control = this.form.get(this.name);\n      if( control==null) {\n        throw new Error(\"No form control for the name \"+this.name);\n      } else {\n        const formValue = this.transformToFormGroupValue(this.value);\n        control.setValue(formValue, { emitEvent: false });\n      }\n    }\n  }\n\n  /**\n   * Retrieve value from the Angular form, and converts it to a value that can be stored\n   * @return true if value have been updated\n   */\n  updateValueFromForm ():boolean {\n    if (this.name==null)\n      return false;\n    const control = this.form.get(this.name);\n    if( control==null) {\n      throw new Error(\"No form control for the name \"+this.name);\n    } else {\n      if (control.dirty) {\n        this.value= this.transformFromFormGroupValue(control.value);\n        control.markAsPristine({onlySelf: true});\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Returns a string that can best display the value or null if it's already a string\n   * @param value\n   */\n  public static toBeautifyString (value:unknown, maxLength?:number): string|null {\n    if( value == null)\n      return null;\n\n    let ret=\"\";\n\n    if ( Array.isArray(value)) {\n      value = value[0];\n    }\n    // Try to see if we have json or Date or something else\n    switch (typeof value) {\n      case \"string\": {\n        ret = value;\n        break;\n      }\n      case \"object\": {\n        if (value instanceof Date) {\n          ret = value.toLocaleDateString();\n        } else {\n          ret = JSON.stringify(value, null, 2);\n        }\n        break;\n      }\n      case \"undefined\": {\n        break;\n      }\n      default: {\n        ret = (value as any).toLocaleString();\n      }\n    }\n\n    if( maxLength!=null) {\n      if (ret.length> maxLength) {\n        ret = ret.substring(0,maxLength-3)+'...';\n      }\n    }\n\n    return ret;\n  }\n\n  listEventSources(): DynamicEventSource[] {\n    return [];\n  }\n\n  selectEventSourceFor(type: DynamicEventType, name?: string): DynamicEventSource | null {\n    const sources=this.listEventSources();\n    for (const src of sources) {\n      if( src.type===type) {\n        if (name==null)\n          return src;\n        else if (src.name==name) {\n          return src;\n        }\n      }\n    }\n    return null;\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n\n}\n","import {AbstractDynamicComponent} from './abstract-dynamic-component';\nimport {DynamicComponent} from './dynamic-component';\nimport {\n  AfterViewInit,\n  ChangeDetectorRef,\n  Component,\n  Directive,\n  Injector,\n  TemplateRef,\n  ViewChild,\n  ViewContainerRef,\n} from '@angular/core';\nimport {DontCodeModelPointer} from '@dontcode/core';\nimport {FormGroup} from '@angular/forms';\nimport {ComponentLoaderService} from '../common-dynamic/component-loader.service';\nimport {ReplaySubject} from \"rxjs\";\n\n/** A component must be attached to a insertionpoint in the template **/\n@Directive({ selector: 'dtcde-dynamic' })\nexport class DynamicInsertPoint {}\n\n/**\n * A component that can be dynamically loaded by the dont-code framework, and can dynamically load subcomponents\n * It can integrate with the reactive form or not depending on calling setForm () or not.\n *\n * Components that dynamically loads other components must at least define an insertion point by using this <dtcde-dynamic></dtcde-dynamic>\n */\n@Component({ template: '' })\nexport abstract class AbstractDynamicLoaderComponent\n  extends AbstractDynamicComponent\n  implements AfterViewInit\n{\n  @ViewChild(DynamicInsertPoint, { read: ViewContainerRef, static: false })\n  dynamicInsertPoint!: ViewContainerRef;\n\n  /**\n   * Manages the components that are bound to the form\n   */\n  protected fields = new Array<SubFieldInfo>();\n  /**\n   * Stores the position of subField in fields depending on its name\n   * @protected\n   */\n  protected fieldsMap = new Map<string, number>();\n  protected parentForm: FormGroup|null = null;\n\n  /**\n   * Any action that needs to happen after ngAfterViewInit can be added to this.\n   * @protected\n   */\n  protected componentInited = new ReplaySubject<boolean> ();\n\n  protected constructor(\n    protected loader: ComponentLoaderService,\n    protected injector: Injector,\n    protected ref: ChangeDetectorRef\n  ) {\n    super();\n  }\n\n\n  /**\n   * Define that a subvalue named propertyAndFormName will be managed by a subcomponent of type type\n   * Example: defineSubFields ('currencyCode', 'Currency') will handle a plugin to manage the currency\n   * @param formName\n   * @param type\n   */\n  defineSubField (propertyAndFormName:string, type:string) {\n    const newSubField = new SubFieldInfo(propertyAndFormName, type);\n    this.addSubField(newSubField);\n  }\n\n  /**\n   * Retrieve the information of the subfield at the given name.\n   * @param propertyAndFormName\n   * @protected\n   */\n  protected getSubField (propertyAndFormName:string): SubFieldInfo|undefined {\n    const pos = this.fieldsMap.get(propertyAndFormName);\n    if (pos!=null)\n      return this.fields[pos];\n    else\n      return;\n  }\n\n  protected addSubField (toAdd:SubFieldInfo): number {\n    const pos = this.fields.push( toAdd);\n    this.fieldsMap.set(toAdd.name, pos-1);\n    return pos;\n  }\n\n  getSubFields (): SubFieldInfo[] {\n    return this.fields;\n  }\n\n  /**\n   * This component will load subfields, so unless it doesn't have a name, it creates a new FormGroup\n   * @param form\n   */\n  override setForm(form: FormGroup): void {\n      // Register a FormGroup for this component has it will have to manage values from subFields as well\n    if (this.name) {\n      const formGroup = new FormGroup({}, { updateOn: 'blur' });\n      form.registerControl(this.name, formGroup);\n      super.setForm(formGroup);\n      this.parentForm = form;\n    } else {\n      super.setForm(form);\n      this.parentForm = null;\n    }\n    this.preloadSubFields();\n  }\n\n  override hydrateValueToForm() {\n      // Don't try to update the form as if it is a standard component\n      // as most likely we have created a new FormGroup\n    if (this.parentForm==null)\n      super.hydrateValueToForm();\n    else {\n      let formValue = this.transformToFormGroupValue(this.value);\n      // Sets the form value that are not managed directly by a field\n      for (const key in this.form.controls) {\n        if (this.fieldsMap.get(key)==null) {\n          const control = this.form.get(key);\n          control?.setValue(formValue?formValue[key]:formValue, {emitEvent: false});\n        }\n      }\n    }\n  }\n\n  override updateValueFromForm(): boolean {\n    if (this.parentForm==null)\n      return super.updateValueFromForm();\n    else {\n      let isChanged = false;\n      // Sets the form value that are not managed directly by a field\n      for (const key in this.form.controls) {\n        if (this.fieldsMap.get(key) == null) {\n          const control = this.form.get(key);\n          if( control!=null) {\n            if( control.dirty) {\n              const value = this.transformFromFormGroupValue(control?.value);\n              if (this.value==null) {\n                this.value={};\n              }\n              this.value[key]=value;\n              isChanged=true;\n              control.markAsPristine({onlySelf: true});\n            }\n          }\n        }\n      }\n      return isChanged;\n    }\n  }\n\n  override setValue(val: any) {\n    super.setValue(val);\n\n      // Split the value into its subcomponents\n    for (const element of this.fields) {\n      if (val!=null)\n        this.setSubFieldValue(element, val[element.name]);\n      else\n        this.setSubFieldValue(element, undefined);\n    }\n  }\n\n\n  override getValue(): any {\n    let val = super.getValue();\n    // Adds subfield values into the main value\n    for (const element of this.fields) {\n      const subFieldValue = this.getSubFieldValue(element);\n      if( (subFieldValue!=null) && (val==null)) {\n        this.value={};\n        val=this.value;\n      }\n      if( val[element.name]!==subFieldValue)\n        val[element.name]=subFieldValue;\n    }\n    return val;\n  }\n\n\n  /**\n   * Retrieve the fulledittemplate for a subfield\n   * * @param formName\n   */\n  subFieldFullEditTemplate (subField:string|SubFieldInfo): TemplateRef<any> | null {\n    const subInfo = (typeof subField === 'string')?this.getSubField(subField as string):subField as SubFieldInfo;\n    const component = subInfo?.component;\n    let ret= null;\n    if (component!=null) {\n      ret = component.providesTemplates(subInfo?.type).forFullEdit;\n    }\n    if( subField==null)\n      throw new Error (\"No template for subField \"+subInfo?.name+\" of component \"+this.name);\n    else\n      return ret;\n  }\n\n  /**\n   * Retrieve the fulledittemplate for a subfield\n   * * @param formName\n   */\n  subFieldInlineViewTemplate (subField:string|SubFieldInfo): TemplateRef<any> | null {\n    const subInfo = (typeof subField === 'string')?this.getSubField(subField as string):subField as SubFieldInfo;\n    const component = subInfo?.component;\n    let ret= null;\n    if (component!=null) {\n      ret = component.providesTemplates(subInfo?.type).forInlineView;\n    }\n    if( subField==null)\n      throw new Error (\"No template for subField \"+subInfo?.name+\" of component \"+this.name);\n    else\n      return ret;\n  }\n\n  /**\n   * Retrieve the fullviewtemplate for a subfield\n   * * @param formName\n   */\n  subFieldFullViewTemplate (subField:string|SubFieldInfo): TemplateRef<any> | null {\n    const subInfo = (typeof subField === 'string')?this.getSubField(subField as string):subField as SubFieldInfo;\n    const component = subInfo?.component;\n    let ret= null;\n    if (component!=null) {\n      ret = component.providesTemplates(subInfo?.type).forFullView;\n    }\n    if( subField==null)\n      throw new Error (\"No template for subField \"+subInfo?.name+\" of component \"+this.name);\n    else\n      return ret;\n  }\n\n  /**\n   * Dynamically loads the component to handle the subfield\n   * @param formName\n   * @param type\n   * @param subValue\n   */\n  loadSubField(\n    subField: string | SubFieldInfo,\n    type: string,\n    subValue: any\n  ): Promise<DynamicComponent | null> {\n    const subInfo = (typeof subField === 'string')?this.getSubField(subField as string):subField as SubFieldInfo;\n    const component = subInfo?.component;\n    if (component == null) {\n      return this.loader\n        .insertComponentForFieldType(type, this.dynamicInsertPoint)\n        .then((component) => {\n          if (component!=null) {\n            this.prepareComponent(component, type,(subInfo!=null)?subInfo.name:null, subValue);\n            return component;\n          } else {\n            return null;\n          }\n        });\n    } else {\n      return Promise.resolve(component);\n    }\n  }\n\n  /**\n   * Retrieve the subField value from the component handling it\n   * @param formName\n   * @param type\n   */\n  getSubFieldValue(subField: string | SubFieldInfo): any {\n    const subInfo = (typeof subField === 'string')?this.getSubField(subField as string):subField as SubFieldInfo;\n    const component = subInfo?.component;\n    if (component!=null) {\n      return component.getValue();\n    } else {\n      // No component is handling this subField so we have to do it ourselves\n      if ((this.form!=null)&&(subInfo!=null)) {\n        return this.form.get(subInfo.name)?.value;\n      } else {\n        throw new Error(\n          'Cannot provide value for non existent subField ' + subField\n        );\n      }\n    }\n  }\n\n  /**\n   * Programmatically sets the value of the component handling the subfield\n   * @param formName\n   * @param type\n   * @param val\n   */\n  setSubFieldValue(subField: string|SubFieldInfo, val: any) {\n    const subInfo = (typeof subField === 'string')?this.getSubField(subField as string):subField as SubFieldInfo;\n    const component = subInfo?.component;\n    // Sometimes no subcomponent is loaded, for example when displaying value only\n    if (component!=null) {\n        component.setValue(val);\n    }  else {\n      // No components will manage the value, so let's transform it to a displayable string\n      if ((this.form!=null) && (subInfo!=null)) {\n        const singleVal: { [key: string]: any } = {};\n        let updatedValue = AbstractDynamicLoaderComponent.toBeautifyString(val);\n        if (updatedValue == undefined)  // You cannot set a value to undefined\n          updatedValue = null;\n        singleVal[subInfo.name] = updatedValue;\n        this.form.patchValue(singleVal, {emitEvent: false});\n      }\n    }\n  }\n\n  /**\n   * Loads the component that will handle the display and edit for the item at the specified position\n   * @param position: Either the schemaPosition as string or as DontCodeModelPointer\n   * @param currentJson\n   */\n  loadSubComponent(\n    position: DontCodeModelPointer,\n    type:string,\n    formName:string|null,\n    currentJson?: any\n  ): Promise<DynamicComponent | null> {\n      // Make sure you wait until the component itself is init (and the dynamicInsertPoint is valid)\n\n    return new Promise<void>((resolve, reject) => this.componentInited.subscribe({\n        complete: () => {\n          resolve();\n        },\n        error: (err) => {\n          reject(err);\n        }\n      })).then( () => {\n        //console.debug(\"LoadSubComponent:\"+position.position+' with type '+type+', dynamicInsertPoint is ', (this.dynamicInsertPoint!=null));\n        if (this.dynamicInsertPoint==null) {\n          return null;\n        }\n        return this.loader\n          .insertComponent(position, this.dynamicInsertPoint, currentJson)\n          .then((component) => {\n            if (component != null) {\n              return this.prepareComponent(component, type, formName, currentJson);\n            } else {\n              //console.warn('No ComponentFactory or missing <dtcde-dynamic></dtcde-dynamic> in template');\n              return null;\n            }\n          });\n      });\n  }\n\n  prepareComponent(\n    component: DynamicComponent,\n    type:string,\n    formName: string | null,\n    subValue: any\n  ): DynamicComponent {\n    // Manages dynamic forms if needed\n    if (formName) {\n      /*if (!this.form)\n        throw new Error(\n          'Cannot prepare a subField component without a FormGroup'\n        );*/\n      // Tells the component he's part of a form\n      if (this.form!=null) {\n        component.setName(formName);\n        component.setForm(this.form);\n      }\n      component.setValue(subValue);\n\n    }\n    return component;\n  }\n\n  applyComponentToSubField (component: DynamicComponent, type:string, formName:string): boolean {\n    let info =this.getSubField(formName);\n    if( info==null) {\n      info = new SubFieldInfo(formName, type, component);\n      this.addSubField (info);\n      return true;\n    }else {\n      info.component=component;\n      return false;\n    }\n  }\n\n  ngAfterViewInit(): void {\n//    console.debug (\"DynamicInsertPoint for \"+this.constructor.name, this.dynamicInsertPoint);\n    this.componentInited.complete();\n    this.preloadSubFields();\n  }\n\n  private preloadSubFields(): void {\n    if (this.dynamicInsertPoint!=null) {\n      let detectCheckDone=false;\n      for (const element of this.fields) {\n        if( element.component==null) {\n          const valueSafe =this.value?this.value[element.name]:undefined;\n          this.loadSubField(\n            element.name,\n            element.type,\n            valueSafe\n          ).then((component) => {\n            if (component!=null) {\n              this.applyComponentToSubField(component, element.type, element.name);\n            }\n            if( (this.value!=null)&&(!detectCheckDone))\n              {\n                this.ref.detectChanges();\n                detectCheckDone=true;\n              }\n          });\n        }\n      }\n    }\n  }\n\n}\n\n/**\n * Store information to configure a subfield\n */\nexport class SubFieldInfo {\n  name: string;\n  type: string;\n  component: DynamicComponent | undefined;\n\n  constructor(name:string, type:string, comp?:DynamicComponent) {\n    this.name = name;\n    this.type = type;\n    this.component = comp;\n  }\n\n}\n","import {\n  ChangeDetectionStrategy,\n  Component,\n  EventEmitter,\n  Optional,\n  Output,\n  TemplateRef,\n  ViewChild\n} from \"@angular/core\";\nimport {DontCodeModelManager, DontCodeStoreManager, dtcde} from \"@dontcode/core\";\nimport {AbstractDynamicComponent} from \"./abstract-dynamic-component\";\nimport {PossibleTemplateList, TemplateList} from \"./template-list\";\nimport {firstValueFrom, lastValueFrom, Observable} from \"rxjs\";\nimport {map} from \"rxjs/operators\";\nimport {\n  BaseDynamicEvent,\n  BaseDynamicEventSource,\n  DynamicEvent,\n  DynamicEventSource,\n  DynamicEventType\n} from \"./dynamic-event\";\n\n/**\n * A Component that let the user select from a list of entities\n */\n@Component({\n  selector: 'dontcode-reference',\n  templateUrl: './abstract-reference.component.html',\n  styleUrls: ['./abstract-reference.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n  }\n)\nexport class AbstractReferenceComponent extends AbstractDynamicComponent {\n\n  @ViewChild('inlineView',{static:true})\n  private inlineView!: TemplateRef<any>;\n\n  @ViewChild('fullEditView',{static:true})\n  private fullEditView!: TemplateRef<any>;\n\n  @Output()\n  valueChange = new EventEmitter<DynamicEvent>();\n\n  /**\n   * The json path to list the entities, ending with the property to use as a key and display (for example: $.creation.sources.name), to be provided by derived classes\n   * @protected\n   */\n  protected targetEntitiesPos:string|null = null;\n\n  protected targetEntitiesProperty:string|null = null;\n\n  options = new Array<string>();\n\n  constructor(@Optional() protected modelMgr:DontCodeModelManager, @Optional() protected storeMgr:DontCodeStoreManager) {\n    super();\n      // When loaded by Federation, sometimes the dtcde components are not injected.\n    if (modelMgr==null) this.modelMgr=dtcde.getModelManager();\n    if (storeMgr==null) this.storeMgr=dtcde.getStoreManager();\n  }\n\n  canProvide(key?: string): PossibleTemplateList {\n    return new PossibleTemplateList(true, false, true);\n  }\n\n  providesTemplates(key?: string): TemplateList {\n    return new TemplateList (this.inlineView, null, this.fullEditView);\n  }\n\n  protected setTargetEntitiesWithName (entityName:string, propertyName?:string): Promise<boolean> {\n\n    // We must find the list of possible shops\n    const queryResult=this.modelMgr.queryModelToSingle(\"$.creation.entities[?(@.name=='\"+entityName+\"')]\");\n    if( queryResult==null) {\n      console.error(\"Cannot find an entity with name \"+entityName+\" in the model.\");\n      throw new Error (\"Cannot find an entity with name \"+entityName+\" in the model.\");\n    }\n    this.targetEntitiesPos = queryResult.pointer;\n\n    if (this.targetEntitiesPos==null)  return Promise.resolve(false);\n    else {\n      this.targetEntitiesProperty= propertyName??null;\n      return firstValueFrom(this.possibleValues()).then(value => {\n        this.options=value;\n        return true;\n      });\n    }\n  }\n\n  possibleValues (): Observable<Array<string>> {\n    if (this.targetEntitiesPos==null)  throw new Error ('Missing query of target entity for class '+this.constructor.name);\n    const models=this.storeMgr.searchEntities(this.targetEntitiesPos);\n\n    if (this.targetEntitiesProperty!=null){\n      const property=this.targetEntitiesProperty;\n      return models.pipe(\n        map((loadedModels)=> {\n          return loadedModels.map((model) => model[property]);\n      }));\n    } else return models;\n  }\n\n  override listEventSources(): DynamicEventSource[] {\n    const ret= super.listEventSources();\n    ret.push(\n      new BaseDynamicEventSource (\"Value\", DynamicEventType.VALUE_CHANGE, this.valueChange.asObservable())\n    );\n    return ret;\n  }\n\n  valueChanged($event: any):void {\n    this.valueChange.emit(new BaseDynamicEvent(\"Value\", DynamicEventType.VALUE_CHANGE, $event.value));\n  }\n\n  override setValue(val: any) {\n   if ((val!=null) && (this.options!=null) && (this.options.findIndex((value) => {\n     return value == val;\n   })==-1)) {\n     if( this.options[0]!=='Error') {\n      // throw new Error (\"erferf\");\n     }\n     if ( this.options[1] != null) {\n       val=this.options[1].toString();\n     } else {\n       //throw new Error (\"ERerferf\");\n     }\n/*     if( (typeof val ==='string')&&(val!=='Shop EP')&&(val!=='Shop GW')) {\n       throw new Error (\"Error of the death\");\n     } else if (typeof val !== 'string') {\n       throw new Error (\"Error of the death\");\n     }*/\n     /*if( this.counter>=1) {\n     }*/\n    }\n    super.setValue(val);\n  }\n\n}\n","<ng-template #inlineView>{{this.value}}</ng-template>\n<ng-template #fullEditView>\n  <ng-container *ngIf=\"form\" [formGroup]=\"form!\">\n    <p-dropdown [options]=\"options\" [formControlName]=\"name\" [filter]=\"true\" [showClear]=\"true\" placeholder=\"Select a reference\" (onChange)=\"valueChanged ($event)\" [lazy]=\"true\">\n      <ng-template pTemplate=\"selectedItem\">\n        <div *ngIf=\"this.value\">\n          {{this.value}}\n        </div>\n      </ng-template>\n      <ng-template let-reference pTemplate=\"item\">\n        {{reference}}\n      </ng-template>\n    </p-dropdown>\n  </ng-container>\n</ng-template>\n","import {Observable} from \"rxjs\";\n\n/**\n * An interface used by a component to describe what dynamic event it can send\n */\nexport interface DynamicEventSource {\n  name:string;\n  type:DynamicEventType;\n  eventSource:Observable<DynamicEvent>;\n}\n\nexport class BaseDynamicEventSource implements DynamicEventSource{\n\n  constructor(public name:string, public type:DynamicEventType, public eventSource:Observable<DynamicEvent>) {\n  }\n}\n\nexport enum DynamicEventType {\n  VALUE_CHANGE = 'VALUE_CHANGE',\n  SELECTION_CHANGE='SELECTION_CHANGE'\n}\n\n/**\n * A dynamic event sent by one component to another\n */\nexport interface DynamicEvent {\n  name:string;\n  type:DynamicEventType;\n  value:any;\n}\n\nexport class BaseDynamicEvent implements DynamicEvent{\n\n  constructor(public name:string, public type:DynamicEventType, public value:any) {\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport {PluginBaseComponent} from \"../plugin-base.component\";\n\n/**\n * Converts any object to a nice string to be displayed in html\n */\n@Pipe({\n  name: 'beautifier',\n  pure:true\n})\nexport class BeautifierPipe implements PipeTransform {\n\n  transform(value: unknown, ...args: unknown[]): unknown {\n    return PluginBaseComponent.toBeautifyString(value, args[0] as number);\n  }\n\n}\n","import {ChangeDetectorRef, Component, Injector, OnDestroy} from '@angular/core';\nimport {\n  Change,\n  CommandProviderInterface, DontCodeModel,\n  DontCodeModelPointer,\n  PreviewHandler,\n} from '@dontcode/core';\nimport { ComponentLoaderService } from '../common-dynamic/component-loader.service';\nimport {AbstractDynamicLoaderComponent, SubFieldInfo} from './abstract-dynamic-loader-component';\nimport { PluginHandlerHelper } from '../common-handler/plugin-handler-helper';\nimport {debounceTime, Subscription} from 'rxjs';\nimport {DynamicComponent} from \"./dynamic-component\";\nimport {FormControl, Validators} from \"@angular/forms\";\nimport {map} from \"rxjs/operators\";\n\n/**\n * A component that can be loaded by the framework, load subcomponents, listen to model changes, and so on...\n * It can as well dynamically manage a list of subcomponents and a form together with its mapping to a value.\n */\n@Component({ template: '' })\nexport abstract class PluginBaseComponent\n  extends AbstractDynamicLoaderComponent\n  implements PreviewHandler, OnDestroy\n{\n  protected pluginHelper = new PluginHandlerHelper();\n  entityPointer: DontCodeModelPointer | null = null;\n  protected provider: CommandProviderInterface | null = null;\n\n  constructor(loader: ComponentLoaderService, injector: Injector,ref: ChangeDetectorRef) {\n    super(loader, injector, ref);\n  }\n\n  override ngOnDestroy(): void {\n    this.pluginHelper.unsubscribe();\n    super.ngOnDestroy();\n  }\n\n  /**\n   * Listen to this.form updates and update this.value accordingly\n   * @protected\n   */\n  protected updateValueOnFormChanges():void {\n    this.subscriptions.add(this.form.valueChanges.pipe(\n      map (value => {\n        //console.debug(\"Value changed\", value);\n        // Force the recalculation of the data from the form\n        this.getValue();\n        return value;\n      })\n      ).subscribe()\n    );\n  }\n\n  initCommandFlow(\n    provider: CommandProviderInterface,\n    pointer: DontCodeModelPointer\n  ): any {\n    this.entityPointer = pointer;\n    this.provider = provider;\n    this.pluginHelper.initCommandFlow(provider, pointer, this);\n  }\n\n  protected initChangeListening(subElement?: boolean) {\n    this.pluginHelper.initChangeListening(subElement);\n  }\n\n  /**\n   * When the component is created for display, it receives the initial data as complete Json.\n   * If it wants, it can call this method who will call handleChange for each property.\n   * This will avoid to duplicate code (first time when a complete json is sent, second when subelements are sent)\n   * @protected\n   */\n  protected decomposeJsonToMultipleChanges(\n    pointer: DontCodeModelPointer,\n    json: any\n  ): void {\n    this.pluginHelper.decomposeJsonToMultipleChanges(pointer, json);\n  }\n\n  /**\n   * Retrieve the value of the key property if the change concerns it\n   * @param change\n   * @param key\n   */\n  decodeStringField(change: Change, key: string): string | undefined {\n    if (change.pointer?.lastElement === key) {\n      return change.value;\n    } else return undefined;\n  }\n\n  /**\n   * Updates the array of T elements by applying the changes received and calling the transform method\n   * @param target\n   * @param targetMap\n   * @param change\n   * @param property\n   * @param transform\n   * @param parentPosition\n   * @param applyProperty\n   * @private\n   */\n  applyUpdatesToArray<T>(\n    target: T[],\n    targetMap: Map<string, number>,\n    change: Change,\n    property: string,\n    transform: (position: DontCodeModelPointer, item: any) => T,\n    parentPosition?: string,\n    applyProperty?: (target: T, key: string, value: any) => boolean\n  ): Promise<T[]> {\n    return this.applyUpdatesToArrayAsync(\n      target,\n      targetMap,\n      change,\n      property,\n      (key, item) => {\n        return Promise.resolve(transform(key, item));\n      },\n      parentPosition\n    );\n  }\n\n  /**\n   * Updates the array of T elements by applying the changes received and calling the transform method\n   * @param target\n   * @param targetMap\n   * @param change\n   * @param property\n   * @param transform\n   * @param parentPosition\n   * @param applyProperty\n   * @private\n   */\n  applyUpdatesToArrayAsync<T>(\n    target: T[],\n    targetMap: Map<string, number>,\n    change: Change,\n    property: string | null,\n    transform: (position: DontCodeModelPointer, item: any) => Promise<T>,\n    parentPosition?: string,\n    applyProperty?: (target: T, key: string | null, value: any) => boolean\n  ): Promise<T[]> {\n    return this.pluginHelper.applyUpdatesToArrayAsync(\n      target,\n      targetMap,\n      change,\n      property,\n      transform,\n      parentPosition,\n      applyProperty\n    );\n  }\n\n  abstract handleChange(change: Change): void;\n\n  /**\n   * Dynamically manages the list of subFields (and sub components) based on the change.\n   * @param change\n   * @protected\n   */\n  protected updateSubFieldsWithChange(change: Change, subProperty:string|null, parentPosition?: string): Promise<SubFieldInfo[]|null> {\n      return this.applyUpdatesToArrayAsync(\n        this.fields,\n        this.fieldsMap,\n        change,\n        subProperty,\n        (position, value) => {\n          return this.loadSubComponent(position, value.type, value.name).then((component) => {\n            return new SubFieldInfo(value.name, value.type, component??undefined);\n          });\n        },\n        parentPosition,\n        (elt, key, newVal) => {\n          switch (key) {\n            case DontCodeModel.APP_FIELDS_NAME_NODE:\n              elt.name = newVal;\n              break;\n            default:\n              return false;\n          }\n          return true;\n        }\n      ).then((updatedFields) => {\n        this.fields = updatedFields;\n        this.rebuildForm();\n        return updatedFields;\n      });\n  }\n\n  /**\n   * Rebuild the Reactive form from the list of fields configured with the entity\n   * @protected\n   */\n  protected rebuildForm() {\n\n    if (this.form==null)  // Ignore if the component doesn't have a form\n      return;\n    // Updates the formgroup with new fields and remove old fields if necessary\n    const toRemove = new Set<string>();\n    // tslint:disable-next-line:forin\n    for (const formKey in this.form.controls) {\n      toRemove.add(formKey);\n    }\n\n    for (const field of this.fields) {\n      let val = null;\n      if (this.value && this.value[field.name]) {\n        val = this.value[field.name];\n      }\n      toRemove.delete(field.name);\n\n      // Check if the component manages the FormControl itself or if it relies on us\n      if (field.component!=null) {\n        field.component?.setValue(val);\n      } else {\n        val = PluginBaseComponent.toBeautifyString(val);\n        this.form.registerControl(\n          field.name,\n          new FormControl(val, Validators.required)\n        );\n      }\n    }\n\n    toRemove.forEach((key) => {\n      this.form.removeControl(key);\n    });\n  }\n\n}\n","import {TemplateRef} from \"@angular/core\";\n\nexport class TemplateList {\n  forInlineView: TemplateRef<any>|null;\n  forFullView: TemplateRef<any>|null;\n  forFullEdit: TemplateRef<any>|null;\n\n\n  constructor(forInlineView: TemplateRef<any>|null, forFullView: TemplateRef<any>|null, forFullEdit: TemplateRef<any>|null) {\n    this.forInlineView = forInlineView;\n    this.forFullView = forFullView;\n    this.forFullEdit = forFullEdit;\n  }\n}\n\nexport class PossibleTemplateList {\n  forInlineView: boolean;\n  forFullView: boolean;\n  forFullEdit: boolean;\n\n\n  constructor(forInlineView: boolean, forFullView: boolean, forFullEdit: boolean) {\n    this.forInlineView = forInlineView;\n    this.forFullView = forFullView;\n    this.forFullEdit = forFullEdit;\n  }\n}\n","import {Change, DontCodeModelManager, DontCodeSchemaItem, ModelQuerySingleResult} from \"@dontcode/core\";\nimport {Injectable} from \"@angular/core\";\n\n/**\n * Stores and constantly updates the json (as an instance of the DontCodeSchema) as it is being edited / modified through Change events\n * It's a wrapper around DontCodeModelManager\n * It does not store the entity values but the description of entities, screens... as defined in the Editor\n */\n@Injectable({\n  providedIn: 'root'\n})\nexport class ValueService {\n\n  constructor(protected modelMgr:DontCodeModelManager) {\n  }\n\n  getContent(): any {\n    return this.modelMgr.getContent();\n  }\n\n  /**\n   * Resets the current json content to the one given in parameter\n   * @param newContent\n   */\n  resetContent(newContent: any): void {\n    this.modelMgr.resetContent(newContent);\n  }\n  /**\n   * Subscribes to the Subject in parameter to receive model updates through changes.\n   * Changes are generated by the Editor as the user modifies the application.\n   * It then modifies it's internal json to be up to date.\n   * @param receivedCommands\n   * @deprecated in favor of applyChange\n   */\n/*  receiveUpdatesFrom(receivedCommands: Subject<Change>): void {\n    this.model.receiveUpdatesFrom(receivedCommands);\n  }\n*/\n  /**\n   * Apply the change to the model and returns the list of subchanges implied by it\n   * @param chg\n   */\n/*  applyChange (chg: Change): Change[] {\n    return this.modelMgr.applyChange(chg);\n  }*/\n  /**\n   * Provides the json extract at the given position.\n   * For example, findAtPosition ('creation/entities/a') will returns the description (fields...) of the first entity created with the editor\n   * @param position\n   * @param create\n   */\n  findAtPosition(position: string, create?: boolean): any {\n    return this.modelMgr.findAtPosition(position, create);\n  }\n\n  /**\n   * Enable querying the model for any value, following jsonPath model\n   * To use when potentially you expect multiple values\n   * @param query: the query as a jsonPath\n   * @param position: in case the jsonPath is relative\n   */\n  queryModelToArray(query: string, position?: string): Array<any> {\n    return this.modelMgr.queryModelToArray(query, position);\n  }\n\n  /**\n   * Enable querying the model for any value, following jsonPath model\n   * To use when potentially you expect a single value.\n   * @param query: the query as a  jsonPath\n   * @param position: in case the jsonPath is relative\n   */\n  queryModelToSingle(query: string, position?: string): ModelQuerySingleResult|null {\n    return this.modelMgr.queryModelToSingle(query, position);\n  }\n\n  /**\n   * Returns the list of values that are possible target of a given property path. With this the Builder User Interface can display to the user a combo-box will all targets\n   * For example, with the following model:\n   * \"from\": {\n   *           \"type\": \"string\",\n   *           \"format\": \"$.creation.sources.name\"\n   *         }\n   *\n   * findAllPossibleTargetsOrProperty (\"from\", ...) will returns all sources names.\n   * @param property\n   * @param position\n   * @param schemaItem\n   */\n  findAllPossibleTargetsOfProperty(\n    property: string,\n    position: string,\n    schemaItem?: DontCodeSchemaItem\n  ): Array<any> {\n    return this.modelMgr.findAllPossibleTargetsOfProperty(property, position, schemaItem);\n  }\n\n  /**\n   * Returns the exact element that matches the target of a given property path.\n   *\n   * For example, with the following Dont-code model:\n   * \"from\": {\n   *           \"type\": \"string\",\n   *           \"format\": \"$.creation.sources.name\"\n   *         }\n   *\n   * and an instantiated model like this:\n   * {\n   *   \"from\": \"EntityName\"\n   * }\n   * findAllPossibleTargetsOrProperty (\"from\", ...) will return only the source named \"EntityName\".\n   * @param property\n   * @param position\n   * @param schemaItem\n   */\n  findTargetOfProperty(\n    property: string,\n    position: string,\n    schemaItem?: DontCodeSchemaItem\n  ): ModelQuerySingleResult|null {\n    return this.modelMgr.findTargetOfProperty(property, position, schemaItem);\n    }\n\n  }\n","import {ModuleWithProviders, NgModule} from '@angular/core';\nimport {DynamicInsertPoint} from \"./common-ui/abstract-dynamic-loader-component\";\nimport {\n  DontCodeChangeManager,\n  DontCodeModelManager,\n  DontCodePreviewManager,\n  DontCodeSchemaManager,\n  DontCodeStoreManager,\n  dtcde\n} from \"@dontcode/core\";\nimport {DONT_CODE_CORE} from \"./common-global/globals\";\nimport {BeautifierPipe} from './common-ui/pipes/beautifier.pipe';\nimport {DropdownModule} from \"primeng/dropdown\";\nimport {ReactiveFormsModule} from \"@angular/forms\";\nimport {CommonModule} from \"@angular/common\";\nimport {AbstractReferenceComponent} from \"./common-ui/abstract-reference.component\";\n\n@NgModule({\n  imports: [CommonModule, DropdownModule, ReactiveFormsModule],\n  declarations: [DynamicInsertPoint, BeautifierPipe, AbstractReferenceComponent],\n  exports: [DynamicInsertPoint, BeautifierPipe, AbstractReferenceComponent]\n})\nexport class PluginCommonModule {\n  /**\n   * Injects the DontCode core components into Angular's Dependency injection\n   * @param config\n   */\n  static forRoot(): ModuleWithProviders<PluginCommonModule> {\n    return {\n      ngModule: PluginCommonModule,\n      providers: [\n        {provide:DONT_CODE_CORE, useValue: dtcde},\n        {provide:DontCodeSchemaManager, useValue:dtcde.getSchemaManager()},\n        {provide:DontCodeModelManager, useValue:dtcde.getModelManager()},\n        {provide:DontCodePreviewManager, useValue:dtcde.getPreviewManager()},\n        {provide:DontCodeStoreManager, useValue:dtcde.getStoreManager()},\n        {provide:DontCodeChangeManager, useValue:dtcde.getChangeManager()},\n        BeautifierPipe\n      ]\n    }\n  }\n}\n\nexport * from './common-global/globals';\nexport * from './common-handler/abstract-plugin-handler';\nexport * from './common-handler/plugin-handler-helper';\nexport * from './common-ui/plugin-base.component';\nexport * from './common-ui/template-list';\nexport * from './common-ui/dynamic-component';\nexport * from './common-ui/dynamic-event';\nexport * from './common-ui/abstract-dynamic-component';\nexport * from './common-ui/abstract-dynamic-loader-component';\nexport * from './common-ui/abstract-reference.component';\nexport * from './common-ui/pipes/beautifier.pipe';\nexport * from './common-storage/entity-store.service';\nexport * from './common-dynamic/component-loader.service';\nexport * from './common-values/value.service';\nexport * from './common-config/common-lib-config';\nexport * from './common-config/common-config.service';","import {ChangeDetectorRef, Component, Inject, Injector, OnDestroy, OnInit,} from '@angular/core';\nimport {\n  Core,\n  RepositorySchema,\n} from '@dontcode/core';\nimport {Subscription, firstValueFrom} from 'rxjs';\nimport {CommonLibConfig, DONT_CODE_CORE} from \"@dontcode/plugin-common\";\nimport { HttpClient } from '@angular/common/http';\nimport { CommonConfigService } from '@dontcode/plugin-common';\nimport { SandboxRepositorySchema } from '../../shared/definitions';\n\n/**\n * An AppComponent that loads dynamically the repository configuration\n */\n@Component({\n  template: '',\n})\nexport abstract class LightAppComponent implements OnInit, OnDestroy {\n  protected subscription = new Subscription();\n\n  protected runtimeConfig = new DontCodeRuntimeConfig();\n\n  protected defaultRepositoryUrl = 'assets/repositories/default.json';\n\n  constructor(\n    protected configService: CommonConfigService,\n    protected httpClient: HttpClient,\n    protected injector: Injector,\n    protected ref: ChangeDetectorRef,\n    @Inject(DONT_CODE_CORE)\n    protected dontCodeCore: Core,\n  ) {\n  }\n\n  /**\n   * Reads configuration from the repository file\n   */\n  ngOnInit(): void {\n    // First load the repository \n    const repoUrl = this.runtimeConfig.repositoryUrl || this.defaultRepositoryUrl;\n\n    firstValueFrom (this.httpClient.get<RepositorySchema>(repoUrl, {observe:'body', responseType:'json'}))\n      .then((config:SandboxRepositorySchema) => {\n        const updates: {[P in keyof CommonLibConfig]:any}={};\n        if( config.documentApiUrl!=null) updates.documentApiUrl=config.documentApiUrl;\n        if( config.storeApiUrl!=null) updates.storeApiUrl = config.storeApiUrl;\n        if( config.webSocketUrl!=null) updates.webSocketUrl = config.webSocketUrl;\n        if( config.ideWebSocketUrl!=null) updates.ideWebSocketUrl = config.ideWebSocketUrl;\n        if( config.projectApiUrl!=null) updates.projectApiUrl = config.projectApiUrl;\n\n        this.configService.batchUpdateConfig (updates);\n\n          // Once everything is finalized, let's give a chance to the caller to do something.\n        return this.afterInitialization (config, repoUrl);\n      }).then ( () => {\n        this.ref.markForCheck();\n        this.ref.detectChanges();\n\n      });\n\n}\n\n  /**\n   * This is called after all plugins are loaded and inited, and the store provider configured\n   */\n  protected afterInitialization (config:SandboxRepositorySchema, repoUrl:string): Promise<void> {\n    return Promise.resolve();\n  }\n\n\n  ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n  }\n}\n\nexport class DontCodeRuntimeConfig {\n  sessionId?:string;\n  projectId?:string;\n  runtime=false;\n  forceRepositoryLoading=false;\n  repositoryUrl?:string;\n}\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {PriceComponent} from './preview/price/price.component';\nimport {CommercePlugin} from \"./declaration/commerce-plugin\";\nimport {dtcde} from '@dontcode/core';\nimport {PluginCommonModule} from '@dontcode/plugin-common';\nimport {FormsModule, ReactiveFormsModule} from \"@angular/forms\";\nimport {PriceCompareComponent} from \"./preview/price/price-compare.component\";\nimport {InputTextModule} from \"primeng/inputtext\";\nimport {FieldsModule} from \"@dontcode/plugin-std\";\nimport {ShopHandlerComponent} from \"./preview/shop/shop-handler.component\";\nimport {DropdownModule} from \"primeng/dropdown\";\nimport {RippleModule} from \"primeng/ripple\";\nimport {ButtonModule} from \"primeng/button\";\nimport {ProductSelectionComponent} from \"./shared/ui/product-selection.component\";\nimport {DataViewModule} from \"primeng/dataview\";\nimport {CardModule} from \"primeng/card\";\nimport {BasicModule} from \"@dontcode/plugin-std\";\nimport {TooltipModule} from \"primeng/tooltip\";\nimport {ShopTypeHandlerComponent} from \"./preview/shop/shop-type-handler.component\";\nimport {MessageModule} from \"primeng/message\";\nimport {MessagesModule} from \"primeng/messages\";\n\n@NgModule({\n    imports: [CommonModule, PluginCommonModule.forRoot(), BasicModule, FieldsModule, ReactiveFormsModule, InputTextModule, FormsModule, DropdownModule, RippleModule, ButtonModule, DataViewModule, CardModule, TooltipModule, MessageModule, MessagesModule],\n  declarations: [\n    PriceCompareComponent,\n    PriceComponent,\n    ShopHandlerComponent,\n    ShopTypeHandlerComponent,\n    ProductSelectionComponent\n  ],\n  id:'dontcode-plugin/commerce' // A module containing previewer components must have an id to be found by the dont-code platform.\n})\nexport class CommerceModule {\n  constructor() {\n    console.log('Commerce Plugin registering');   // Look for this log to make sure your plugin has been loaded\n    dtcde.registerPlugin(new CommercePlugin ());  // When created a module must register to the platform.\n  }\n\n  // We declare the components referenced by the CommercePlugin configuration\n  exposedPreviewHandlers(): Map<string, any> {\n    return new Map<string, any> ([\n      ['PriceComponent', PriceComponent],\n      ['PriceCompareComponent', PriceCompareComponent],\n      ['ShopHandlerComponent', ShopHandlerComponent],\n      ['ShopTypeHandlerComponent', ShopTypeHandlerComponent]\n    ]);\n  }\n}\n\nexport * from './preview/price/price.component';\nexport * from './preview/shop/shop-handler.component';\nexport * from './preview/shop/shop-type-handler.component';\nexport * from './preview/price/price-compare.component';\nexport * from './shared/price-model';\nexport * from './shared/services/price-finder.service';\nexport * from './shared/online-shop-scrapper';\nexport * from './shared/dynamic-proxy-scrapper';\n","import {Plugin, DontCodeModel, PluginConfig, Core} from '@dontcode/core';\n\n/**\n * This plugin demonstrate 2 things:\n * - how to declare a new field type that can be selected in the Builder and how to manage the display and edition of this new type in the Previewer.\n * - As well it adds a new attribute 'seed' to any Entity and provides a viewer for the Previewer when its value is Yes or Maybe.\n */\nexport class CommercePlugin implements Plugin {\n\n  public static readonly SHOP_ENTITY_NAME='Online Shop';\n\n  getConfiguration(): PluginConfig {\n    return {\n      plugin: {\n        id: 'CommercePlugin',\n        'display-name': 'Commerce Plugin for anything related to products, prices, shops.',\n        version: '1.0.0'\n      },\n      'schema-updates': [{\n        id: 'price-field',\n        description: 'A price of a product in a shop',\n        changes: [{\n          location: {\n            parent: '#/$defs/field',\n            id: 'type'\n          },\n          update: {\n            enum: [{\n              Commerce: {\n                enum: [\n                  'Price',\n                  'Shop',\n                  'Shop type'\n                ]}\n              }\n            ]\n          },\n          replace: false\n        }]\n      }],\n      'preview-handlers': [\n        {\n          location: {\n            parent: DontCodeModel.APP_FIELDS,\n            id: 'type',\n            values: [{\n                Commerce: {\n                  enum: [\n                    'Price'\n                  ]}\n            }]\n          },\n          class: {\n            name: 'PriceComponent',\n            source: 'commerce'\n          }\n        },\n        {\n          location: {\n            parent: DontCodeModel.APP_FIELDS,\n            id: 'type',\n            values: [{\n              Commerce: {\n                enum: [\n                  'Shop'\n                ]}\n            }]\n          },\n          class: {\n            name: 'ShopHandlerComponent',\n            source: 'commerce'\n          }\n        },\n        {\n          location: {\n            parent: DontCodeModel.APP_FIELDS,\n            id: 'type',\n            values: [{\n              Commerce: {\n                enum: [\n                  'Shop type'\n                ]}\n            }]\n          },\n          class: {\n            name: 'ShopTypeHandlerComponent',\n            source: 'commerce'\n          }\n        }\n      ]\n    }\n  }\n\n  pluginInit(dontCode: Core): void {\n    // Nothing to do here\n  }\n}\n","import {ChangeDetectorRef, Component, Injector} from '@angular/core';\nimport {ComponentLoaderService, PluginBaseComponent, PossibleTemplateList, TemplateList} from '@dontcode/plugin-common';\nimport {Change} from \"@dontcode/core\";\n\n@Component({\n  selector: 'dontcode-commerce-price-compare',\n  templateUrl: './price-compare.component.html',\n  styleUrls: ['./price-compare.component.scss']\n})\nexport class PriceCompareComponent extends PluginBaseComponent {\n\n  constructor(loader: ComponentLoaderService,\n              injector: Injector,ref: ChangeDetectorRef) {\n    super (loader, injector, ref);\n  }\n\n  providesTemplates(key?: string): TemplateList {\n    throw new Error('Method not implemented.');\n  }\n  canProvide(key?: string): PossibleTemplateList {\n    throw new Error('Method not implemented.');\n  }\n\n  handleChange(change: Change): void {\n  }\n\n}\n","<h1>Hello from PriceCompareComponent !</h1>\n","import {ChangeDetectorRef, Component, Injector, TemplateRef, ViewChild} from '@angular/core';\nimport {\n  AbstractDynamicLoaderComponent,\n  ComponentLoaderService,\n  DynamicComponent,\n  DynamicEventType,\n  PossibleTemplateList,\n  TemplateList\n} from '@dontcode/plugin-common';\nimport {FormControl} from \"@angular/forms\";\nimport {PriceFinderService} from \"../../shared/services/price-finder.service\";\nimport {AbstractOnlineShopScrapper, ScrappedProduct} from \"../../shared/online-shop-scrapper\";\nimport {PriceModel} from \"../../shared/price-model\";\nimport {Action, ActionHandler, ActionType, DontCodeModelManager} from \"@dontcode/core\";\n\n/**\n * Displays and refresh a price of a product in a shop.\n * When the price is new, it tries to fill the name with the shop and the product name\n */\n@Component({\n  selector: 'dontcode-commerce-price',\n  templateUrl: './price.component.html',\n  styleUrls: ['./price.component.scss']\n})\nexport class PriceComponent extends AbstractDynamicLoaderComponent implements ActionHandler {\n\n  static readonly baseUpdatePriceIcons='pi pi-refresh';\n  updatePriceIcon = PriceComponent.baseUpdatePriceIcons;\n\n  @ViewChild('inlineView', {static: true})\n  private inlineView!: TemplateRef<any>;\n\n  @ViewChild('fullEditView', {static: true})\n  private fullEditView!: TemplateRef<any>;\n\n  override value: PriceModel;\n\n  parsingError: { message?: string, url?: string, status?: number, content?: string } | null = null;\n\n  productSelectionMode = false;\n  productNameLinked = false;\n\n  listOfSelectableProducts = new Array<ScrappedProduct>();\n\n  constructor(loader: ComponentLoaderService, protected priceFinder: PriceFinderService,\n              injector: Injector, ref: ChangeDetectorRef) {\n    super(loader, injector, ref);\n    this.defineSubField('cost', 'Other currency');\n    this.defineSubField('priceDate', 'Date & Time');\n    this.defineSubField('shop', 'Shop');\n    this.defineSubField('urlInShop', 'Website (url)');\n    this.value = {};\n  }\n\n  providesTemplates(key?: string): TemplateList {\n    return new TemplateList(this.inlineView, null, this.fullEditView);\n  }\n\n  canProvide(key?: string): PossibleTemplateList {\n    return new PossibleTemplateList(true, false, true);\n  }\n\n  override setValue(val: any) {\n    super.setValue(val);\n    /*if( val!=null) {\n      this.priceFinder.updatePriceIfPossible(val, this.parentPosition??'').then(() => {\n        this.parsingError=null;\n      }).catch(() => {\n        val.inError=true;\n      });\n    }*/\n\n    // Eventually set default product name\n    this.enableProductNameLookup();\n\n  }\n\n  override createAndRegisterFormControls (): void {\n    let control = new FormControl (null, {updateOn:'blur'});\n    this.form.registerControl('nameInShop', control);\n    control = new FormControl ({value:null, disabled:true}, {updateOn:'blur'});\n    this.form.registerControl('idInShop', control);\n  }\n\n  cannotUpdatePrice():boolean {\n    if ((this.value!=null) && (this.value.shop!=null) && (this.value.nameInShop!=null)) {\n      return false;\n    }\n    return true;\n  }\n\n  async updatePrice(): Promise<void> {\n    this.parsingError=null;\n    if( this.value==null) return;\n\n    try {\n      if( this.value.idInShop==null) {\n        this.updatePriceIcon = PriceComponent.baseUpdatePriceIcons+ ' pi-spin'\n  /*      const testProduct = new ScrappedProduct();\n        testProduct.productName=\"Test Product\";\n        testProduct.productId=\"TEST-PRODUCT\";\n        testProduct.currencyCode=\"EUR\";\n        testProduct.productPrice=12;\n        this.selectedProduct(testProduct);*/\n        if ((this.value.nameInShop!=null) && (this.value.shop!=null)) {\n          // The user defined the product name, let's find the matching ones and let the user select only one of them\n          await this.priceFinder.searchProducts(this.value.nameInShop, this.value.shop).then(value => {\n            if( value!=null) {\n              this.listOfSelectableProducts = value;\n              this.productSelectionMode=true;\n              this.ref.markForCheck();\n              this.ref.detectChanges();\n            }\n          }).catch(reason => {\n            this.parsingError=this.translateToError(reason);\n            this.ref.markForCheck();\n            this.ref.detectChanges();\n          });\n        }\n      } else if (this.value.shop!=null) {\n        // We know the product id and the shop, let's update the price directly\n        await this.priceFinder.findPrice(this.value, this.value.shop, this.parentPosition??\"\").then (newPrice => {\n          if (newPrice!=null) {\n            this.value.inError=false;\n            this.setSubFieldValue('cost', newPrice.cost);\n            this.setSubFieldValue('priceDate', new Date());\n          }\n        }).catch ((reason) => {\n          this.value.inError=true;\n          this.parsingError=this.translateToError(reason);\n          this.ref.markForCheck();\n          this.ref.detectChanges();\n        });\n      }\n    } finally {\n      this.updatePriceIcon=PriceComponent.baseUpdatePriceIcons;\n      this.ref.markForCheck();\n      this.ref.detectChanges();\n\n    }\n  }\n\n  /**\n   * The user has selected one product amongst the list found with its keyword\n   * @param product\n   */\n  selectedProduct(product: ScrappedProduct|null) {\n    this.productSelectionMode=false;\n    if( product!=null) {\n      this.value.idInShop=product.productId;\n//      this.value.nameInShop=product.productName??undefined;\n      this.hydrateValueToForm();\n      this.setSubFieldValue(\"cost\", AbstractOnlineShopScrapper.toMoneyAmount(product));\n      this.setSubFieldValue('priceDate', new Date());\n      this.setSubFieldValue('urlInShop', product.productUrl);\n      this.value.cost=this.getSubFieldValue(\"cost\");\n      this.value.priceDate = this.getSubFieldValue('priceDate');\n      this.value.urlInShop = this.getSubFieldValue('urlInShop');\n    } else {\n      this.clearProduct();\n    }\n/*    this.ref.markForCheck();\n    this.ref.detectChanges();*/\n  }\n\n  /**\n   * Override this method to listen to shop name change\n   * @param component\n   * @param type\n   * @param formName\n   */\n  override applyComponentToSubField(component: DynamicComponent, type: string, formName: string): boolean {\n    const ret = super.applyComponentToSubField(component, type, formName);\n    if (formName=='shop') {\n      const valueChange = component.selectEventSourceFor(DynamicEventType.VALUE_CHANGE);\n      if (valueChange!=null) {\n        this.subscriptions.add(valueChange.eventSource.subscribe({\n          next: (event) => {\n            this.clearProduct ();\n          }\n        }));\n      }\n    }\n    return ret;\n  }\n\n  clearProduct ():void {\n    this.productSelectionMode=false;\n    this.parsingError=null;\n    if( this.value){\n      delete this.value.inError;\n      delete this.value.cost;\n    }\n    this.setSubFieldValue('cost', undefined);\n    if( this.value)\n      delete this.value.priceDate;\n    this.setSubFieldValue('priceDate', undefined);\n    if( this.value)\n      delete this.value.urlInShop;\n    this.setSubFieldValue('urlInShop', undefined);\n    if( this.value)\n      delete this.value.idInShop;\n    (this.form.get(\"idInShop\") as FormControl)?.setValue(null, {emitEvent:false});\n  }\n\n  productNameChanged(event: Event) {\n  //    const inputEvent = event as InputEvent;\n    this.clearProduct();\n  }\n\n  /**\n   * In case the product name is not defined, just try to pick-it up from parent form\n   * In this case listen to all changes of parent form\n   */\n  enableProductNameLookup () {\n    // In case the name in shop is not defined, then try to pick-up a name from the parent form\n    if( (this.value?.nameInShop == null) && (this.parentForm!=null)) {\n      if (!this.productNameLinked) {\n      const parentNameControl = this.guessProductParentComponent ();\n      if( parentNameControl!=null) {\n        this.productNameLinked=true;\n        this.subscriptions.add(parentNameControl.valueChanges.subscribe(newValue => {\n          const nameInShopControl = this.form.get('nameInShop') as FormControl<string|null>;\n          if ((nameInShopControl.value==null) || (nameInShopControl.value=='') || (newValue.startsWith(nameInShopControl.value))) {\n            if( this.value == null) this.value={};\n            this.value.nameInShop=newValue;\n            nameInShopControl.setValue(newValue, {emitEvent:false, emitModelToViewChange:true});\n            }\n          }));\n        }\n      }\n    }\n\n  }\n\n  guessProductParentComponent (): FormControl|null {\n    if (this.parentForm!=null) {\n      const nameProp = DontCodeModelManager.guessNamePropertyOfObject(this.parentForm.controls);\n      if (nameProp!=null)\n        return this.parentForm.controls[nameProp] as FormControl;\n    }\n    return null;\n  }\n\n  protected translateToError(reason: any): any {\n\n    const ret:any={};\n    if( typeof reason === 'string') {\n      ret.message=reason;\n      return ret;\n    }\n\n    if (reason.status!=null) {\n      ret.status=reason.status;\n    }\n    if (reason.statusText!=null) {\n      ret.message=reason.statusText;\n    } else if (reason.message!=null) {\n      ret.message=reason.message;\n    }\n    if (reason.url!=null) {\n      ret.url=reason.url;\n    }\n    if (reason.error!=null) {\n      ret.content=reason.error;\n    }\n    if( ret.message==null)  {\n      // Nothing found\n      ret.message=reason.toString();\n    }\n    return ret;\n  }\n\n  async performAction(action: Action): Promise<void> {\n    if (action.actionType==ActionType.EXTRACT) {\n      await this.priceFinder.updatePriceIfPossible(this.value, this.parentPosition??'').then (newPrice => {\n        if (newPrice!=null) {\n          this.value.inError=false;\n          this.setSubFieldValue('cost', newPrice.cost);\n          this.setSubFieldValue('priceDate', new Date());\n        }\n      }).catch ((reason) => {\n        this.value.inError=true;\n        this.parsingError=this.translateToError(reason);\n        this.ref.markForCheck();\n        this.ref.detectChanges();\n      });\n    }\n  }\n\n  isInError (): boolean {\n    return this.parsingError!=null;\n  }\n\n  errorMessage (): string {\n    if (this.parsingError==null) return '';\n    else {\n      let ret= (this.parsingError.status)?this.parsingError.status+':':'';\n      ret = ret+this.parsingError.message;\n      return ret;\n    }\n  }\n\n}\n","<dtcde-dynamic></dtcde-dynamic>\n<ng-template #inlineView><ng-container *ngIf=\"value\"><span pTooltip=\"Price Date: {{value.priceDate??'Unknown'}}<br/>Shop:{{value.shop??'Unknown'}}\" [escape]=\"false\">\n  <ng-container *ngIf=\"value?.urlInShop\">\n    <a href=\"{{value.urlInShop}}\" target=\"_blank\">\n      <ng-container *ngTemplateOutlet=\"priceView\" ></ng-container>\n    </a>\n  </ng-container>\n  <ng-container *ngIf=\"!value?.urlInShop\">\n    <ng-container *ngTemplateOutlet=\"priceView\" ></ng-container>\n  </ng-container>\n  </span>\n  </ng-container>\n</ng-template>\n\n<ng-template #priceView>\n  <button *ngIf=\"value?.inError\" pButton type=\"button\" class=\"p-button-rounded p-button-outlined p-button-danger\" icon=\"pi pi-exclamation-triangle\" pTooltip=\"Error reading this product price\"></button>\n  <ng-container *ngTemplateOutlet=\"subFieldInlineViewTemplate('cost')\"></ng-container>&nbsp;\n</ng-template>\n\n<ng-template #fullEditView>\n  <ng-container *ngIf=\"form\" [formGroup]=\"form\">\n    <div class=\"formgrid grid\">\n      <div class=\"field col-12 md:col-6\">\n        <span class=\"p-float-label\">\n          <input [id]=\"name+'-name'\" type=\"text\" pInputText formControlName=\"nameInShop\" class=\"w-full\" (input)=\"productNameChanged($event)\">\n          <label [for]=\"name+'-name'\">Product Name</label>\n        </span>\n      </div>\n      <div class=\"field col-12 md:col-6\">\n        <ng-container *ngTemplateOutlet=\"subFieldFullEditTemplate('shop')\"></ng-container>\n      </div>\n      <div class=\"field col-12 md:col-6\">\n        <div class=\"flex align-items-center\">\n          <button *ngIf=\"value?.inError\" pButton type=\"button\" class=\"p-button-rounded p-button-outlined p-button-danger\" icon=\"pi pi-exclamation-triangle\" pTooltip=\"Error reading this product price\"></button>\n          <button name=\"FetchPrice\" class=\"flex flex-initial align-items-center p-button-rounded p-button-text\" pButton pRipple type=\"button\" [icon]=\"updatePriceIcon\" [disabled]=\"cannotUpdatePrice ()\" (click)=\"updatePrice()\"></button>\n          <div class=\"flex align-items-center flex-1\" style=\"margin-top: 0.5rem\">Price:&nbsp;\n            <ng-container *ngTemplateOutlet=\"subFieldFullEditTemplate('cost')\"></ng-container>\n          </div>\n        </div>\n      </div>\n      <div class=\"field col-12 md:col-6\">Date of Price:&nbsp;\n        <ng-container *ngTemplateOutlet=\"subFieldFullEditTemplate('priceDate')\"></ng-container>\n      </div>\n      <div class=\"field col-12 md:col-6\">Product Id:\n          <input type=\"text\" pInputText formControlName=\"idInShop\" class=\"w-full\">\n      </div>\n      <div class=\"field col-12 md:col-6\">Product url:\n          <ng-container *ngTemplateOutlet=\"subFieldFullEditTemplate('urlInShop')\"></ng-container>\n      </div>\n      <ng-container *ngIf=\"isInError ()\">\n        <p-messages severity=\"error\">\n          <ng-template pTemplate>Error : {{errorMessage()}}\n            <a *ngIf=\"parsingError?.url\" [href]=\"parsingError?.url\" target=\"_blank\">Try in the browser</a>\n          </ng-template>\n        </p-messages>\n      </ng-container>\n      <ng-container *ngIf=\"productSelectionMode\">\n        <div [id]=\"name+'-select'\" class=\"field col-12\"><dontcode-commerce-product-selection [listOfProducts]=\"listOfSelectableProducts\" (selected)=\"selectedProduct ($event)\"></dontcode-commerce-product-selection>\n        </div>\n      </ng-container>\n    </div>\n  </ng-container>\n</ng-template>\n","import {ChangeDetectorRef, Component, OnInit, Optional} from '@angular/core';\nimport {AbstractReferenceComponent} from '@dontcode/plugin-common';\nimport {DontCodeModelManager, DontCodeStoreManager} from \"@dontcode/core\";\nimport {CommercePlugin} from \"../../declaration/commerce-plugin\";\n\n/**\n * Display and enable selection of a shop.\n * Shops are found by listing all entities that are managed with the Entity definition 'Online Shop'\n */\n@Component({\n  selector: 'dontcode-commerce-shop',\n  templateUrl: './shop-handler.component.html',\n  styleUrls: ['./shop-handler.component.scss']\n})\nexport class ShopHandlerComponent extends AbstractReferenceComponent implements OnInit {\n\n  constructor(@Optional() modelMgr:DontCodeModelManager, @Optional() storeMgr:DontCodeStoreManager, protected ref:ChangeDetectorRef) {\n    super (modelMgr, storeMgr);\n  }\n\n  ngOnInit () {\n    // Manages the list of Shops\n    this.setTargetEntitiesWithName(CommercePlugin.SHOP_ENTITY_NAME, 'Shop').then(value => {\n      if (value) {\n        this.ref.markForCheck();\n        this.ref.detectChanges();\n      }\n    }).catch (reason => {\n      console.error (\"Cannot set list of shops\", reason);\n    });\n  }\n\n  override setValue(val: any) {\n/*    const cyLogger=(window as any).Cypress.cy.log;\n    console.log(cyLogger);\n    if (typeof cyLogger === 'function') {\n      try {\n        cyLogger.call(\"erferfre\");\n      } catch (err) {\n        //console.log(\"err\");\n      }\n    }*/\n   // (window as any).Cypress.cy.log(\"TestERFE\");\n    if( val == null) {\n      // No value set, let's try to guess one\n      const form=this.getForm();\n      const parentForm=form?.parent;\n      if( (parentForm != null) && (!Array.isArray(parentForm.controls))) {\n          // The parent is a FormGroup and not a FormArray\n        for (const controlKey in parentForm.controls) {\n\n          if( parentForm.controls[controlKey]===form) {\n            // The name of the price is this one\n//            throw new Error (\"Error\");\n            val=controlKey;\n            break;\n          }\n        }\n      }\n\n    }\n    super.setValue(val);\n  }\n\n}\n","<ng-template #inlineView>{{this.value}}</ng-template>\n<ng-template #fullEditView>\n  <ng-container *ngIf=\"form\" [formGroup]=\"form!\">\n    <p-dropdown [options]=\"options\" [formControlName]=\"name\" [filter]=\"true\" [showClear]=\"true\" (onChange)=\"valueChanged ($event)\" placeholder=\"Select a shop\" [lazy]=\"true\">\n      <ng-template pTemplate=\"selectedItem\">\n        <div *ngIf=\"this.value\">\n          {{this.value}}\n        </div>\n      </ng-template>\n      <ng-template let-reference pTemplate=\"item\">\n        {{reference}}\n      </ng-template>\n    </p-dropdown>\n  </ng-container>\n</ng-template>\n","import {Component, EventEmitter, Output, TemplateRef, ViewChild} from '@angular/core';\nimport {\n  AbstractDynamicComponent,\n  BaseDynamicEvent,\n  BaseDynamicEventSource,\n  DynamicEvent,\n  DynamicEventSource,\n  DynamicEventType,\n  PossibleTemplateList,\n  TemplateList\n} from '@dontcode/plugin-common';\nimport {FormControl} from \"@angular/forms\";\nimport {PriceFinderService} from \"../../shared/services/price-finder.service\";\n\n@Component({\n  selector: 'dontcode-commerce-shop-type',\n  templateUrl: './shop-type-handler.component.html',\n  styleUrls: ['./shop-type-handler.component.scss']\n})\nexport class ShopTypeHandlerComponent extends AbstractDynamicComponent {\n\n  @ViewChild('inlineView', { static: true })\n  private inlineView!: TemplateRef<any>;\n\n  @ViewChild('fullEditView', { static: true })\n  private fullEditView!: TemplateRef<any>;\n  shopTypes = new Array<string>();\n\n  @Output()\n  valueChange = new EventEmitter<DynamicEvent>();\n\n  constructor(protected priceFinder:PriceFinderService) {\n    super ();\n    this.shopTypes=this.priceFinder.getListOfShopTypes();\n  }\n\n  override createAndRegisterFormControls (): void {\n    this.form.registerControl(this.name, new FormControl(null, {updateOn:\"change\"}));\n  }\n\n  providesTemplates(key?: string): TemplateList {\n    return new TemplateList(this.inlineView, null, this.fullEditView);\n  }\n\n  canProvide(key?: string): PossibleTemplateList {\n    return new PossibleTemplateList(true, false, true);\n  }\n\n  displayableValue():string {\n    const ret= AbstractDynamicComponent.toBeautifyString (this.value);\n    if (ret==null)  return \"\";\n    else return ret;\n  }\n\n  override listEventSources(): DynamicEventSource[] {\n    const ret= super.listEventSources();\n    ret.push(\n      new BaseDynamicEventSource (\"Value\", DynamicEventType.VALUE_CHANGE, this.valueChange.asObservable())\n    );\n    return ret;\n  }\n\n  valueChanged($event: any):void {\n    this.valueChange.emit(new BaseDynamicEvent(\"Value\", DynamicEventType.VALUE_CHANGE, $event.value));\n  }\n}\n","<ng-template #inlineView >{{displayableValue()}}</ng-template>\n<ng-template #fullEditView>\n  <ng-container *ngIf=\"form\" [formGroup]=\"form\">\n    <span class=\"p-float-label\">\n      <p-dropdown [options]=\"shopTypes\" name=\"shop\" [formControlName]=\"name\" placeholder=\"Please select a Shop\" class=\"w-full\" (onChange)=\"valueChanged ($event)\"></p-dropdown>\n    </span>\n  </ng-container>\n</ng-template>\n","import {HttpClient, HttpResponse} from \"@angular/common/http\";\nimport {AbstractOnlineShopScrapper, ProxyEngine, ScrappedProduct} from \"./online-shop-scrapper\";\n\nexport class DynamicProxyScrapper extends AbstractOnlineShopScrapper{\n  constructor(http: HttpClient) {\n    super(http);\n  }\n  searchProductsForNameOrId(nameOrId: string, isId: boolean): Promise<Array<ScrappedProduct>> {\n    return Promise.reject(\"Not implemented\");\n  }\n\n  async callUrlWithProxy (url:string, engine:ProxyEngine|string): Promise<HttpResponse<string>> {\n    const proxyEngine= (typeof engine === 'string' )?engine as ProxyEngine:engine as ProxyEngine;\n\n    return await this.requestWithProxy(\"GET\", url, proxyEngine, {observe: 'response', responseType:'text'});\n  }\n\n}\n","import {MoneyAmount} from \"@dontcode/core\";\nimport {HttpClient, HttpContext, HttpHeaders, HttpParams} from \"@angular/common/http\";\nimport {firstValueFrom} from \"rxjs\";\n\n\n/**\n * The description of a product in an online shop\n */\nexport class ScrappedProduct {\n  productId?: string;\n  productName: string|null=null;\n  productDescription?: string;\n  productUrl?: string;\n  productImageUrl?: string;\n  productPrice?: number;\n  currencyCode?: string;\n  outOfStock?:boolean = false;\n  marketPlace?:boolean;\n\n}\n\n/**\n * Defines the method an OnlineShopScrapper must support\n */\nexport interface OnlineShopScrapper {\n\n  getOnlineShopName ():string;\n  /**\n   * Given a name returns all products that the onlineshop found\n   * @return empty array if no product matches the criteria, a rejected promise in case of any type of error getting the list\n   * @param name\n   */\n  searchProductsForNameOrId (nameOrId:string, isId:boolean): Promise<Array<ScrappedProduct>>;\n\n  /**\n   * Retrieve the price of the given product.\n   * @return null if product is not found, throw an error if scrapping went wrong for any reason\n   * @param productId\n   */\n  updatePrice (product: ScrappedProduct, useProductName?:boolean): Promise<ScrappedProduct|null>;\n\n}\n\nexport abstract class AbstractOnlineShopScrapper implements OnlineShopScrapper {\n\n  public static readonly CORS_PROXY_URL='https://corsproxy.io/?';\n  public static readonly CORS_PROXY_ORG_URL='https://corsproxy.org/?';\n\n  public static readonly WEBSCRAPING_PROXY_URL='https://api.webscraping.ai/html';\n  public static readonly WEBSCRAPING_PROXY_API_KEY='f4fe0d0b-bfa9-49bd-a3f7-404be7bcad85';\n\n  //public static readonly CORS_DONTCODE_PROXY_URL='http://localhost:3000/proxy/debug';\n  public static readonly CORS_DONTCODE_PROXY_URL='https://shared.collin.best/proxy/debug';\n  //public static readonly CORS_DONTCODE_PROXY_URL='https://yolo.test/proxy/debug';\n\n  protected onlineShopName=\"Unknown\";\n\n  /**\n   * Helper method to convert a scrappedProduct to a MoneyAmount.\n   * @param scrappedProduct\n   */\n  static toMoneyAmount(scrappedProduct: ScrappedProduct):MoneyAmount {\n    const ret = new MoneyAmount();\n    ret.amount=scrappedProduct.productPrice;\n    ret.currencyCode=scrappedProduct.currencyCode;\n    return ret;\n  }\n\n  constructor(protected http:HttpClient) {\n  }\n\n  getOnlineShopName(): string {\n    return this.onlineShopName;\n  }\n\n  getShopTypeName (): string {\n    return this.onlineShopName;\n  }\n\n  protected requestWithProxy<T extends {\n    body?: any;\n    headers?: HttpHeaders | {\n      [header: string]: string | string[];\n    };\n    context?: HttpContext;\n    reportProgress?: boolean;\n    observe: 'body'|'response';\n    params?: HttpParams | {\n      [param: string]: string | number | boolean | ReadonlyArray<string | number | boolean>;\n    };\n    responseType?: 'text' | 'json';\n    withCredentials?: boolean;\n  }> (method:string, url:string, engine:ProxyEngine, options: T): Promise<any>\n  {\n    return firstValueFrom(this.http.request(method,\n      this.encodeUrlForCors(url, engine),\n      this.updateOptionsForCors(method, url, engine, options))\n    ).catch ( (reason) => {\n      return Promise.reject ({\n        url: url,\n        engine: engine,\n        error: reason\n      })\n    });\n  }\n\n  /**\n   * Avoid Cors issue by running the url through a Cors manager proxy\n   * @param url the non uri encoded url to reach. Urlencoding will be done by the function\n   */\n  protected encodeUrlForCors(url:string, engine:ProxyEngine):string {\n    let ret = url;\n    switch (engine) {\n      case ProxyEngine.CORSPROXY_IO:\n        ret = AbstractOnlineShopScrapper.CORS_PROXY_URL + encodeURIComponent(url);\n        break;\n      case ProxyEngine.CORSPROXY_ORG:\n        ret = AbstractOnlineShopScrapper.CORS_PROXY_ORG_URL + encodeURIComponent(url);\n        break;\n      case ProxyEngine.CHROME_ENGINE:\n      case ProxyEngine.DONT_CODE:\n        ret = AbstractOnlineShopScrapper.CORS_DONTCODE_PROXY_URL;\n        break;\n      case ProxyEngine.WEBSCRAPING_IA:\n        ret = AbstractOnlineShopScrapper.WEBSCRAPING_PROXY_URL\n        break;\n    }\n    return ret;\n  }\n\n  /**\n   * Adapts the http options for the proxy...\n   * @param url\n   * @param engine\n   * @param httpOptions\n   * @protected\n   */\nprotected updateOptionsForCors<T extends {\n    body?: any;\n    headers?: HttpHeaders | {\n      [header: string]: string | string[];\n    };\n    context?: HttpContext;\n    reportProgress?: boolean;\n    observe: 'body'|'response';\n    params?: HttpParams | {\n      [param: string]: string | number | boolean | ReadonlyArray<string | number | boolean>;\n    };\n    responseType?: 'text' | 'json';\n    withCredentials?: boolean;\n  }> (method:string, url:string, engine:ProxyEngine, options: T): T\n  {\n    switch (engine) {\n      case ProxyEngine.CORSPROXY_IO:\n        options.withCredentials=false;\n        break;\n      case ProxyEngine.CORSPROXY_ORG:\n        options.withCredentials=false;\n        break;\n      case ProxyEngine.CHROME_ENGINE:\n      case ProxyEngine.DONT_CODE:\n        this.addToHttpParams (options, {\n          url: encodeURIComponent(url)\n          }\n        );\n        if (engine === ProxyEngine.CHROME_ENGINE) {\n          this.addToHttpParams(options, {\n            engine: 'chrome'\n            }\n          );\n        }\n      break;\n      case ProxyEngine.WEBSCRAPING_IA:\n        this.addToHttpParams (options, {\n          proxy:'datacenter',\n          js:false,\n          api_key:AbstractOnlineShopScrapper.WEBSCRAPING_PROXY_API_KEY,\n          url:url\n          }\n        );\n      break;\n    }\n    return options;\n  }\n\n  abstract searchProductsForNameOrId(nameOrId: string, isId:boolean): Promise<Array<ScrappedProduct>>;\n\n  /**\n   * By default we do a search with the productId and returns the price\n   * @param prod\n   * @param useProductName\n   */\n  updatePrice(prod: ScrappedProduct, useProductName?:boolean): Promise<ScrappedProduct|null> {\n    let productToFind = prod.productId;\n    if( useProductName==null) useProductName=false;\n\n    if (useProductName||(productToFind==null)) {\n      productToFind=prod.productName??undefined;\n      useProductName=true;\n    }\n    if (productToFind==null) {\n      return Promise.reject(\"You must define a product with a name or id \");\n    } else {\n      return this.searchProductsForNameOrId(productToFind, !useProductName).then(listOfAllElements => {\n        for (const product of listOfAllElements) {\n          if (product.productId == prod.productId) {\n            return product;\n          }\n        }\n\n        return null;\n      }).then (value => {\n          // Let's try a seach with the name if possible\n        if( (value == null)&&(!useProductName)&& (prod.productName!=null)) {\n          return this.searchProductsForNameOrId(prod.productName, false).then(listOfAllElements => {\n            for (const product of listOfAllElements) {\n              if (product.productId == prod.productId) {\n                return product;\n              }\n            }\n\n            return Promise.reject(\"Product \" + productToFind + \" not found in shoptype \" + this.onlineShopName);\n          });\n        }\n        if( value!=null)\n          return value;\n        else {\n          return Promise.reject(\"Product \" + productToFind + \" not found in shoptype \" + this.onlineShopName);\n        }\n      });\n    }\n  }\n\n  /**\n   * Generates standard headers as a browser would do\n   * @protected\n   */\n  protected standardHeaders (): HttpHeaders {\n    const ret= new HttpHeaders ({\n      //'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8',\n      /*'Accept-Encoding': 'gzip, deflate, br',\n      'user-agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36'*/\n    });\n\n    return ret;\n  }\n\n  /**\n   * Throws an exception if the product scrapped is incorrect\n   * @param product\n   */\n  checkScrappedProduct (productSearch:string, product:ScrappedProduct): void {\n    if ((product.productId==null)||(product.productId.length==0)) {\n      throw new Error (\"No Product Id scrapped by shop \"+this.getOnlineShopName()+\" for product search \"+productSearch);\n    }\n    if ((product.productName==null)||(product.productName.length==0)) {\n      throw new Error (\"No Product Name scrapped by shop \"+this.getOnlineShopName()+\" for product search \"+productSearch);\n    }\n    if (((product.productPrice==null)||(isNaN(product.productPrice))) && (product.outOfStock!=true)) {\n      throw new Error (\"Incorrect Product Price \"+product.productPrice+\" scrapped by shop \"+this.getOnlineShopName()+\" for product search \"+productSearch);\n    }\n  }\n\n  /**\n   * Throw an exception if the itemPos is -1 (not found) or after the next product position\n   * @param itemPos\n   * @param nextStartPos\n   * @private\n   */\n  protected checkStringPosition(itemPos: number, limitPos: number) {\n    if ((itemPos==-1)||((limitPos!=-1)&&(itemPos>limitPos)) ) {\n      throw new Error (\"Error decoding product for Scrapper \"+ this.getOnlineShopName());\n    }\n  }\n\n  protected indexOf(htmlResult: string, toFind: string, startPos: number, limitPos?:number, endIndex:boolean=true): number {\n    const result=htmlResult.indexOf(toFind, startPos);\n    if( result==-1)\n      return result;\n    else if ((limitPos!=null) && (limitPos!=-1) && (result>limitPos))\n      return -1;\n\n    if (endIndex)\n      return result+toFind.length;\n    else\n      return result;\n\n  }\n\n  protected safeIndexOf(htmlResult: string, toFind: string, startPos: number, limitPos?:number, endIndex:boolean=true): number {\n    const result=htmlResult.indexOf(toFind, startPos);\n    if( result==-1)\n      throw new Error(\"Cannot find \"+toFind+\" for \"+this.getOnlineShopName());\n    else if ((limitPos!=null) && (limitPos!=-1) && (result>limitPos))\n      throw new Error (\"The product content does not contains \"+toFind+' for '+this.getOnlineShopName());\n\n    if (endIndex)\n      return result+toFind.length;\n    else\n      return result;\n  }\n\n  protected addToHttpParams (options:{\n    params?: HttpParams | {\n      [param: string]: string | number | boolean | ReadonlyArray<string | number | boolean>;\n    };\n  }, toAdd: {\n    [param: string]: string | number | boolean | ReadonlyArray<string | number | boolean>;\n  }):void\n  {\n    if (options.params==null) {\n      options.params=toAdd;\n    } else {\n      if (options.params.appendAll!=null) {\n        options.params = (options.params as HttpParams).appendAll(toAdd);\n      } else {\n        options.params = {...options.params, ...toAdd};\n      }\n    }\n  }\n}\n\nexport enum ProxyEngine {\n  CORSPROXY_IO= \"CORSPROXY.IO\",\n  CORSPROXY_ORG= \"CORSPROXY.ORG\",\n  WEBSCRAPING_IA=\"WEBSCRAPING.IA\",\n  DONT_CODE=\"DONT-CODE.PROXY\",\n  CHROME_ENGINE= \"DONT-CODE.CHROME\",\n}\n","import {AbstractOnlineShopScrapper, ProxyEngine, ScrappedProduct} from \"../online-shop-scrapper\";\nimport {HttpClient} from \"@angular/common/http\";\n\nexport class AmazonScrapper extends AbstractOnlineShopScrapper {\n\n  //static readonly SEARCH_ONLINE_URL=\"https://www.amazon.fr/s?__mk_fr_FR=C3%85M%C3%85%C5%BD%C3%95%C3%91&crid=1KL4W8UW3UJH4&i=aps&field-keywords=QUERY_STRING&ref=nb_sb_noss_2&url=search-alias=aps\";\n  static readonly SEARCH_ONLINE_URL = \"https://www.amazon.fr/s?k=QUERY_STRING\";\n  protected static readonly PRODUCT_START_STRING='<div data-asin=\"';\n\n  protected static readonly BASE_URL='https://www.amazon.fr'\n\n  override onlineShopName=\"Amazon\";\n\n\n  constructor(http: HttpClient) {\n    super(http);\n  }\n\n  override searchProductsForNameOrId(nameOrId: string, isId:boolean): Promise<Array<ScrappedProduct>> {\n    // remove accents\n    const query = AmazonScrapper.SEARCH_ONLINE_URL.replace(\"QUERY_STRING\", encodeURIComponent(nameOrId));\n\n    return this.requestWithProxy(\"GET\", query, ProxyEngine.DONT_CODE,{headers:{Accept:'text/html'}, responseType:\"text\", observe:\"body\"})\n      .catch(reason => {\n        console.error('Error getting amazon price with DontCode Proxy', reason);\n        if ((reason.status!=null) && (reason.status>=500)) {\n          return this.requestWithProxy(\"GET\", query, ProxyEngine.CORSPROXY_IO,{headers:{Accept:'text/html'}, responseType:\"text\", observe:\"body\"});\n        } else {\n          return Promise.reject(reason);\n        }\n      }).catch (reason => {\n        console.error('Error getting amazon price with CorsProxyIO', reason);\n        if ((reason.status!=null) && (reason.status>=500)) {\n          return this.requestWithProxy(\"GET\", query, ProxyEngine.WEBSCRAPING_IA,{headers:{Accept:'text/html'}, responseType:\"text\", observe:\"body\"});\n        } else {\n          return Promise.reject(reason);\n        }\n      })\n      .then (completeHtml => {\n\n          const ret= new Array<ScrappedProduct>();\n          let startPos = completeHtml.indexOf(AmazonScrapper.PRODUCT_START_STRING);\n          while (startPos>=0) {\n            const endPos=completeHtml.indexOf(AmazonScrapper.PRODUCT_START_STRING, startPos+1);\n              // Just extract the product bits\n            const htmlResult=completeHtml.substring(startPos, endPos);\n\n            const newProduct = new ScrappedProduct();\n            const middlePos = htmlResult.indexOf('data-component-type=\"s-product-image\"');\n            let itemPos = htmlResult.indexOf('data-asin=\"')+11;\n            if( (htmlResult.charAt(itemPos)=='\"') || (middlePos==-1)) {\n              startPos = completeHtml.indexOf(AmazonScrapper.PRODUCT_START_STRING, startPos+1);\n              continue; // Ignore the non products\n            }\n            newProduct.productId=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n            itemPos = htmlResult.indexOf('href=\"', middlePos)+6;\n            let url=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n            if (url.startsWith('/sspa/click'))  // It'href=\"/sspas a sponsored link\n            {\n              const urlPos=url.indexOf('url=')+4;\n              url = url.substring(urlPos);\n              url = url.replace(/%2F/g, '/');\n            }\n\n            newProduct.productUrl=AmazonScrapper.BASE_URL+url;\n            itemPos = htmlResult.indexOf('src=\"', middlePos+1)+5;\n            newProduct.productImageUrl=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n            itemPos = htmlResult.indexOf('a-text-normal\">', middlePos)+15;\n            newProduct.productDescription=htmlResult.substring(itemPos, htmlResult.indexOf('<', itemPos+1));\n            if( (newProduct.productDescription!=null) && (newProduct.productDescription?.length>60)) {\n              newProduct.productName=newProduct.productDescription.substring(0,60);\n            } else {\n              newProduct.productName=newProduct.productDescription||null;\n            }\n            itemPos = htmlResult.indexOf('data-asin=\"')+11;\n            newProduct.productId=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n\n            this.extractPrice(htmlResult, middlePos, newProduct);\n            this.checkScrappedProduct(nameOrId, newProduct);\n            ret.push(newProduct);\n\n            startPos = htmlResult.indexOf(AmazonScrapper.PRODUCT_START_STRING, startPos+1);\n          }\n\n          return ret;\n        });\n  }\n\n  extractPrice (htmlResult:string, startPos:number, newProduct:ScrappedProduct): void {\n      const itemPos = htmlResult.indexOf('<span class=\"a-price-whole\">', startPos)+28;\n\n      let price = htmlResult.substring(itemPos, htmlResult.indexOf('</span>', itemPos+1));\n      price = price.replace(',','.');\n      newProduct.productPrice=Number.parseFloat(price);\n      newProduct.currencyCode=\"EUR\"\n\n  }\n\n}\n","import {AbstractOnlineShopScrapper, ProxyEngine, ScrappedProduct} from \"../online-shop-scrapper\";\nimport {HttpClient} from \"@angular/common/http\";\n\nexport class BoulangerScrapper extends AbstractOnlineShopScrapper {\n\n  static readonly SEARCH_ONLINE_URL=\"https://www.boulanger.com/resultats?tr=QUERY_STRING\"\n  protected static readonly PRODUCT_START_STRING=\"<article\";\n\n  protected static readonly BASE_URL='https://www.boulanger.com'\n\n  override onlineShopName=\"Boulanger\";\n\n  constructor(httpClient:HttpClient) {\n    super(httpClient);\n  }\n\n  override searchProductsForNameOrId(nameOrId: string, isId:boolean): Promise<Array<ScrappedProduct>> {\n    // remove accents\n    nameOrId = nameOrId.normalize(\"NFD\").replace(/\\p{Diacritic}/gu, \"\");\n\n    const query = BoulangerScrapper.SEARCH_ONLINE_URL.replace(\"QUERY_STRING\", nameOrId);\n\n    // Let's first try with the free CorsProxy, and only if it doesn't work then we'll use the non-free Webscraping\n    return this.requestWithProxy(\"GET\", query, ProxyEngine.CORSPROXY_IO, {observe: 'body', responseType: 'text'})\n      .then(htmlResult => {\n        return this.analysePageResult(nameOrId, htmlResult);\n      }).catch(reason => {\n        if ((reason.code==null) || (reason.statusText==='Unknown Error'))  // Cors error due to a redirect\n        {\n          return this.requestWithProxy(\"GET\", query, ProxyEngine.WEBSCRAPING_IA, {observe: 'body', responseType: 'text'})\n            .then(htmlResult => {\n              return this.analysePageResult(nameOrId, htmlResult)\n            });\n        }else {\n          return reason;\n        }\n      });\n  }\n\n  analysePageResult (nameOrId:string, htmlResult:string): Array<ScrappedProduct> {\n    const ret= new Array<ScrappedProduct>();\n    let startPos = htmlResult.indexOf(BoulangerScrapper.PRODUCT_START_STRING);\n    while (startPos >= 0) {\n      const newProduct = new ScrappedProduct();\n      let itemPos = htmlResult.indexOf('href=\"', startPos) + 6;\n      newProduct.productUrl = BoulangerScrapper.BASE_URL + htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos + 1));\n      itemPos = htmlResult.indexOf('data-product-label=\"', startPos) + 20;\n      newProduct.productName = htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos + 1));\n      newProduct.productDescription = undefined;\n      itemPos = htmlResult.indexOf('<img src=\"', startPos + 1) + 10;\n      newProduct.productImageUrl = htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos + 1));\n      itemPos = htmlResult.indexOf('data-product-id=\"', startPos) + 17;\n      newProduct.productId = htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos + 1));\n\n      this.extractPrice(htmlResult, startPos, newProduct);\n      this.checkScrappedProduct(nameOrId, newProduct);\n      ret.push(newProduct);\n\n      startPos = htmlResult.indexOf(BoulangerScrapper.PRODUCT_START_STRING, startPos + 1);\n    }\n\n    return ret;\n\n  }\n\n  extractPrice (htmlResult:string, startPos:number, newProduct:ScrappedProduct): void {\n      const itemPos = htmlResult.indexOf('data-analytics_product_unitprice_ati=\"', startPos)+38;\n      const price = Number.parseFloat(htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1)));\n\n      newProduct.productPrice=price;\n      newProduct.currencyCode=\"EUR\"\n\n  }\n\n\n}\n","import {AbstractOnlineShopScrapper, ProxyEngine, ScrappedProduct} from \"../online-shop-scrapper\";\nimport {firstValueFrom, map} from \"rxjs\";\nimport {HttpClient} from \"@angular/common/http\";\n\nexport class CDiscountScrapper extends AbstractOnlineShopScrapper {\n\n  static readonly SEARCH_ONLINE_URL=\"https://www.cdiscount.com/search/10/QUERY_STRING.html\";\n  protected static readonly PRODUCT_START_STRING='<li data-sku=\"';\n\n  protected static readonly BASE_URL='https://www.cdiscount.com'\n\n  override onlineShopName=\"CDiscount\";\n\n  constructor(httpClient:HttpClient) {\n    super(httpClient);\n  }\n\n  override searchProductsForNameOrId(nameOrId: string, isId:boolean): Promise<Array<ScrappedProduct>> {\n    // remove accents\n/*    const words=nameOrId.split(\" \");\n    let encodedName = \"\";\n    for (const word of words) {\n      encodedName+=encodeURIComponent(word)+\"+\";\n    }\n    if( words.length>=1) {\n      // Remove the last +\n      encodedName=encodedName.substring(0, encodedName.length-1);\n    }*/\n    const query = CDiscountScrapper.SEARCH_ONLINE_URL.replace(\"QUERY_STRING\", encodeURIComponent(nameOrId));\n\n    return this.requestWithProxy(\"GET\", query, ProxyEngine.CORSPROXY_ORG,{headers:{Accept:'text/html'}, responseType:\"text\", observe:\"body\"})\n      .then(htmlResult => {\n\n          const ret= new Array<ScrappedProduct>();\n          let startPos = htmlResult.indexOf(CDiscountScrapper.PRODUCT_START_STRING);\n          // We ignore the first one as its the template\n          startPos = htmlResult.indexOf(CDiscountScrapper.PRODUCT_START_STRING, startPos+1);\n\n          while (startPos>=0) {\n            const nextStartPos =htmlResult.indexOf(CDiscountScrapper.PRODUCT_START_STRING, startPos+1);\n            const newProduct = new ScrappedProduct();\n            let itemPos = this.safeIndexOf(htmlResult,'href=\"', startPos, nextStartPos);\n            newProduct.productUrl=htmlResult.substring(itemPos, this.safeIndexOf(htmlResult, '\"', itemPos+1, nextStartPos,false));\n            itemPos = this.indexOf(htmlResult,'<h2 class=\"prdtTit\">', startPos, nextStartPos);\n            if (itemPos==-1) {\n              // style is different in product page\n              itemPos = this.indexOf(htmlResult,'<h2 class=\"prdtBILTit\">', startPos, nextStartPos);\n            }\n            newProduct.productName=htmlResult.substring(itemPos, this.safeIndexOf(htmlResult,'</h2>', itemPos+1, nextStartPos,false));\n            newProduct.productDescription=undefined;\n            itemPos = this.safeIndexOf(htmlResult, 'src=\"', startPos+1, nextStartPos);\n            newProduct.productImageUrl=htmlResult.substring(itemPos, this.safeIndexOf(htmlResult, '\"', itemPos+1, nextStartPos,false));\n            itemPos = this.safeIndexOf(htmlResult, 'data-productid=\"', startPos, nextStartPos);\n            newProduct.productId=htmlResult.substring(itemPos, this.safeIndexOf(htmlResult, '\"', itemPos+1, nextStartPos, false));\n\n            this.extractPrice(htmlResult, startPos, nextStartPos, newProduct);\n            this.checkScrappedProduct(nameOrId, newProduct);\n            ret.push(newProduct);\n\n            startPos = htmlResult.indexOf(CDiscountScrapper.PRODUCT_START_STRING, startPos+1);\n          }\n\n          return ret;\n        });\n  }\n\n  extractPrice (htmlResult:string, startPos:number, nextStartPos:number, newProduct:ScrappedProduct): void {\n      let itemPos = this.indexOf(htmlResult,'<span class=\"price priceColor hideFromPro\">', startPos, nextStartPos);\n    if (itemPos!=-1) {\n      const commaPos = this.safeIndexOf(htmlResult, ',', itemPos + 1, nextStartPos, false);\n      const price = Number.parseInt(htmlResult.substring(itemPos, commaPos));\n      const cents = Number.parseInt(htmlResult.substring(\n        commaPos + 1,\n        this.safeIndexOf(htmlResult, '&euro;', commaPos + 1, nextStartPos, false)));\n\n      newProduct.productPrice = price + cents / 100;\n    } else {\n      itemPos = this.safeIndexOf(htmlResult,'<span class=\"hideFromPro priceColor price\">', startPos, nextStartPos);\n      const price = Number.parseInt(htmlResult.substring(itemPos, this.safeIndexOf(htmlResult,'<sup>', itemPos+1, nextStartPos,false)));\n      const cents = Number.parseInt(htmlResult.substring(this.safeIndexOf(htmlResult,'</sup>', itemPos+1, nextStartPos, false)-2\n        ,this.safeIndexOf(htmlResult,'</sup>', itemPos+1, nextStartPos,false) ));\n      newProduct.productPrice = price + cents / 100;\n\n    }\n    newProduct.currencyCode = \"EUR\"\n  }\n\n}\n","import {AbstractOnlineShopScrapper, ProxyEngine, ScrappedProduct} from \"../online-shop-scrapper\";\nimport {HttpClient} from \"@angular/common/http\";\n\nexport class DartyScrapper extends AbstractOnlineShopScrapper {\n\n  static readonly SEARCH_ONLINE_URL=\"https://z0ypi1plpq-dsn.algolia.net/1/indexes/*/queries?x-algolia-agent=Algolia+for+JavaScript+%284.17.0%29%3B+Browser\";\n/**\nstatic readonly SEARCH_ONLINE_URL=\"https://www.darty.com/nav/recherche/QUERY_STRING.html\"\n  protected static readonly PRODUCT_START_STRING=\"<div class=\\\"product_detail\";\n*/\n  protected static JSON_QUERY= {\n  \"requests\": [{\n    \"indexName\": \"darty_prod_es6\",\n    \"query\": \"QUERY_STRING\",\n    \"params\": \"hitsPerPage=4&tagFilters=%5B%22dcom%22%5D\"\n  }, {\n    \"indexName\": \"darty_prod_es6_query_suggestions\",\n    \"query\": \"QUERY_STRING\",\n    \"params\": \"hitsPerPage=5\"}]\n};\n\n  protected static readonly BASE_URL='https://www.darty.com'\n  protected static readonly BASE_IMAGE_URL='https://image.darty.com/darty?type=image&source=IMAGE_URL&width=120&heigth=180&quality=80'\n\n  override onlineShopName=\"Darty\";\n  private httpHeaders= {\n    \"x-algolia-api-key\":\"740b60dee22b6ca679462288f6cd9c7b\",\n    \"x-algolia-application-id\":\"Z0YPI1PLPQ\"\n  };\n\n\n  constructor(http: HttpClient) {\n    super(http);\n  }\n\n  override searchProductsForNameOrId(nameOrId: string, isId:boolean): Promise<Array<ScrappedProduct>> {\n    let postContent=JSON.stringify(DartyScrapper.JSON_QUERY);\n\n    postContent = postContent.replace(\"QUERY_STRING\", nameOrId);\n    postContent = postContent.replace(\"QUERY_STRING\", nameOrId);  // QUERY_STRING appears twice\n    postContent=JSON.parse(postContent);\n    return this.requestWithProxy(\"POST\",DartyScrapper.SEARCH_ONLINE_URL\n      ,ProxyEngine.CORSPROXY_IO, {body: postContent,headers: this.httpHeaders,responseType:\"json\", observe:\"body\"})\n      .then(jsonResult => {\n\n          if( typeof jsonResult == \"string\")\n            jsonResult = JSON.parse(jsonResult);\n\n          const ret= new Array<ScrappedProduct>();\n          const result=(jsonResult as any).results as Array<any>;\n          if (result.length>0) {\n            const hits=result[0].hits as Array<any>;\n            if( hits!=null) {\n              for (const aResult of hits) {\n                const newProduct = new ScrappedProduct();\n\n                newProduct.productPrice=this.extractPrice (aResult);\n                newProduct.currencyCode=\"EUR\";\n                newProduct.productName=aResult.reference;\n                newProduct.productDescription=undefined;\n                newProduct.productId=aResult.codic;\n                newProduct.productUrl=DartyScrapper.BASE_URL+\"/nav/codic/\"+aResult.codic;\n                //if( aResult.rewriteUrl==null) {\n                if (aResult.pictures?.length>0)\n                  newProduct.productImageUrl=DartyScrapper.BASE_IMAGE_URL.replace(\"IMAGE_URL\", aResult.pictures[0].algoliaPict);\n                //} else {\n                //  newProduct.productImageUrl=\"https://image.darty.com/\"+aResult.rewriteUrl+\"_n\"+aResult.pictures[0].name;\n                //}\n\n                this.checkScrappedProduct(nameOrId, newProduct);\n                ret.push(newProduct);\n              }\n            }\n          }\n\n          return ret;\n        });\n  }\n\n/**  extractPrice (htmlResult:string, startPos:number, newProduct:ScrappedProduct): void {\n      const itemPos = htmlResult.indexOf('data-automation-id=\"product_price\">', startPos)+35;\n      const priceAsString = htmlResult.substring(itemPos, htmlResult.indexOf('<', itemPos+1));\n\n      let decodedPrice = \"\";\n      for (let car of priceAsString) {\n        if (car==='0' || car==='1' || car==='2' || car==='3' || car==='4' ||\n        car==='5' || car==='6' || car==='7' || car==='8' || car==='9' || car===',' || car==='.') {\n          if (car===',') car = '.';\n          decodedPrice+=car;\n        }\n      }\n\n      newProduct.productPrice=Number.parseFloat(decodedPrice);\n      newProduct.currencyCode=\"EUR\"\n  }\n*/\n  /**\n   * We have to go directly to the product page, otherwise there may be a redirect\n   * @param product\n   */\n  override updatePrice(product:ScrappedProduct, useProductName?:boolean): Promise<ScrappedProduct|null> {\n    return super.updatePrice(product, true);  // If the product url is not found, let's try with the product name\n  }\n\n\nprivate extractPrice(response: any): number {\n  if (response.priceSort!=null)\n    return response.priceSort/100;\n  if (response.dartyExclusivePriceSort!=null)\n    return response.dartyExclusivePriceSort/100;\n  let ret=0;\n  for (const key in response.prices.stores) {\n    if( key==='000000') {\n      ret= response.prices.stores[key]/100;\n    } else if ((key==='dartyExclusive') && ( ret===0)) {\n    ret = response.prices.stores[key]/100;\n    }else if (ret===0) {\n      ret = response.prices.stores[key]/100;\n    }\n  }\n\n  return ret;\n}\n}\n","import {AbstractOnlineShopScrapper, ProxyEngine, ScrappedProduct} from \"../online-shop-scrapper\";\nimport {map} from \"rxjs\";\nimport {HttpClient} from \"@angular/common/http\";\n\nexport class EasyParaScrapper extends AbstractOnlineShopScrapper {\n\n  static readonly SEARCH_ONLINE_URL=\"https://jhu6zvksfy-dsn.algolia.net/1/indexes/*/queries?x-algolia-agent=Algolia+for+JavaScript+%283.35.1%29%3B+Browser%3B+Magento2+integration+%283.6.0%29%3B+autocomplete.js+0.38.0&x-algolia-application-id=JHU6ZVKSFY&x-algolia-api-key=YTYyYzkyNzgyZDliZTZlMDk1OGE1MDQwNjRkYWY1ZmY4ZTE5OWZhYmU4ZGUyNTM2NDFjNmU4YjllNWMwNmJmNXRhZ0ZpbHRlcnM9\\n\"\n\n  protected static JSON_QUERY=\n    {\"requests\":[{\"indexName\":\"prod_magento2_fr_products\",\"params\":\"query=QUERY_STRING&hitsPerPage=6&analyticsTags=autocomplete&clickAnalytics=true&facets=%5B%22categories.level0%22%5D&numericFilters=visibility_search%3D1&ruleContexts=%5B%22magento_filters%22%2C%22%22%5D\"},{\"indexName\":\"prod_magento2_fr_section_manufacturer\",\"params\":\"query=chardon%20marie&hitsPerPage=6&analyticsTags=autocomplete&clickAnalytics=true\"},{\"indexName\":\"prod_magento2_fr_categories\",\"params\":\"query=chardon%20marie&hitsPerPage=4&analyticsTags=autocomplete&clickAnalytics=true&numericFilters=include_in_menu%3D1\"}]}\n\n  override onlineShopName=\"EasyParapharmacie\";\n\n\n  constructor(http: HttpClient) {\n    super(http);\n  }\n\n override searchProductsForNameOrId(nameOrId: string, isId:boolean): Promise<Array<ScrappedProduct>> {\n      // We copy the content\n    let postContent=JSON.stringify(EasyParaScrapper.JSON_QUERY);\n\n    postContent = postContent.replace(\"QUERY_STRING\", encodeURIComponent(nameOrId));\n    postContent=JSON.parse(postContent);\n    return this.requestWithProxy(\"POST\", EasyParaScrapper.SEARCH_ONLINE_URL,\n      ProxyEngine.CORSPROXY_IO,\n    {body:postContent, responseType:\"json\", observe:\"body\"})\n      .then(jsonResult => {\n          if( typeof jsonResult == \"string\")\n            jsonResult = JSON.parse(jsonResult);\n\n          const ret= new Array<ScrappedProduct>();\n          const result=(jsonResult as any).results as Array<any>;\n          if (result.length>0) {\n            const hits=result[0].hits as Array<any>;\n            if( hits!=null) {\n              for (const aResult of hits) {\n                const newProduct = new ScrappedProduct();\n\n                newProduct.productPrice=aResult.price.EUR.default;\n                newProduct.currencyCode=\"EUR\";\n                newProduct.productName=aResult.name;\n                newProduct.productDescription=aResult.short_description??aResult.description;\n                newProduct.productId=aResult.ean_code?.toString();\n                if (newProduct.productId==null) {\n                  console.warn(\"Product \"+newProduct.productName+\" searched by \"+nameOrId+\" for Shop \"+this.getOnlineShopName()+\" has no ean_code, getting objectId instead\");\n                  newProduct.productId=aResult.objectID;\n                }\n                newProduct.productUrl=aResult.url;\n                newProduct.productImageUrl=aResult.image_url;\n\n                this.checkScrappedProduct(nameOrId, newProduct);\n                ret.push(newProduct);\n              }\n            }\n          }\n\n          return ret;\n        });\n  }\n\n}\n","import {AbstractOnlineShopScrapper, ProxyEngine, ScrappedProduct} from \"../online-shop-scrapper\";\nimport {map} from \"rxjs\";\n\nexport class FnacScrapper extends AbstractOnlineShopScrapper {\n\n  static readonly SEARCH_ONLINE_URL=\"https://www.fnac.com/SearchResult/ResultList.aspx?SCat=0&Search=QUERY_STRING&sft=1&sa=0\";\n  protected static readonly PRODUCT_START_STRING='<div class=\"clearfix Article-item';\n\n  protected static readonly BASE_URL='https://www.fnac.com'\n\n  override onlineShopName=\"Fnac\";\n\n  /**\n   * Avoid Cors issue by running the url through a Cors manager proxy\n   * @param url\n   */\n/*  encodeUrlForCors(url:string):string {\n    return FnacScrapper.CORS_FNAC_PROXY_URL+(url.startsWith('/')?'':'/')+url;\n  }*/\n\n  override searchProductsForNameOrId(nameOrId: string, isId:boolean): Promise<Array<ScrappedProduct>> {\n    // remove accents\n    const words=nameOrId.split(\" \");\n    let encodedName = \"\";\n    for (const word of words) {\n      encodedName+=encodeURIComponent(word)+\"+\";\n    }\n    if( words.length>=1) {\n      // Remove the last +\n      encodedName=encodedName.substring(0, encodedName.length-1);\n    }\n    const query = FnacScrapper.SEARCH_ONLINE_URL.replace(\"QUERY_STRING\", encodedName);\n\n    return this.requestWithProxy(\"GET\", query, ProxyEngine.DONT_CODE\n    ,{headers:{Accept:'text/html'}, responseType:\"text\", observe:\"body\", withCredentials:true})\n      .then(htmlResult=> {\n\n          const ret= new Array<ScrappedProduct>();\n          let startPos = htmlResult.indexOf(FnacScrapper.PRODUCT_START_STRING);\n          let nextStartPos = htmlResult.indexOf(FnacScrapper.PRODUCT_START_STRING, startPos+1);\n          while (startPos>=0) {\n            const newProduct = new ScrappedProduct();\n            let itemPos = this.safeIndexOf (htmlResult,'id=\"', startPos, nextStartPos);\n            newProduct.productId=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n            let middlePos = this.safeIndexOf(htmlResult, '<img class=\"Article-itemVisualImg', startPos, nextStartPos);\n\n            itemPos = this.indexOf(htmlResult, 'data-lazyimage=\"', middlePos);\n            if( itemPos==-1) {\n              itemPos = this.safeIndexOf(htmlResult, 'src=\"', middlePos, nextStartPos);\n            }\n            newProduct.productImageUrl=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n            itemPos = this.safeIndexOf(htmlResult,'alt=\"', middlePos, nextStartPos);\n            newProduct.productName=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n            newProduct.productDescription=undefined;\n\n            middlePos = this.safeIndexOf(htmlResult, '<p class=\"Article-desc', startPos, nextStartPos);\n            itemPos = this.safeIndexOf(htmlResult, 'href=\"', middlePos, nextStartPos);\n            newProduct.productUrl=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n\n            itemPos = htmlResult.indexOf('vendeur partenaire', startPos);\n            if( (itemPos!=-1) && ((nextStartPos==-1) || (itemPos<nextStartPos))) {\n              newProduct.marketPlace=true;\n            } else {\n              newProduct.marketPlace=false;\n            }\n\n            itemPos = htmlResult.indexOf('En stock', startPos);\n            if( (itemPos!=-1) && ((nextStartPos==-1) || (itemPos<nextStartPos))) {\n              newProduct.outOfStock=false;\n            } else {\n              newProduct.outOfStock=true;\n            }\n\n            this.extractPrice(htmlResult, startPos, newProduct, nextStartPos);\n            if( newProduct.productPrice==undefined) {\n               newProduct.outOfStock=true;\n            }\n            this.checkScrappedProduct(nameOrId, newProduct);\n            ret.push(newProduct);\n\n            startPos = htmlResult.indexOf(FnacScrapper.PRODUCT_START_STRING, startPos+1);\n            nextStartPos = htmlResult.indexOf(FnacScrapper.PRODUCT_START_STRING, startPos+1);\n          }\n\n          return ret;\n        });\n  }\n\n\n  extractPrice (htmlResult:string, startPos:number, newProduct:ScrappedProduct, nextStartPos:number): void {\n      const itemPos = this.indexOf(htmlResult, 'class=\"userPrice\">', startPos, nextStartPos);\n      if( itemPos==-1) {\n        newProduct.productPrice=undefined;\n        return;\n      }\n\n      const supIndex=this.indexOf( htmlResult,'<sup>', itemPos+1, nextStartPos, false);\n      let price=0;\n      if (supIndex==-1) // No cents\n      {\n        price = Number.parseInt(htmlResult.substring(itemPos, this.safeIndexOf(htmlResult, '&euro;', itemPos+1,nextStartPos,false)));\n        newProduct.productPrice=price;\n      } else {\n        price = Number.parseInt(htmlResult.substring(itemPos, supIndex));\n        const cents = Number.parseInt(htmlResult.substring(this.safeIndexOf(htmlResult, '</sup>', itemPos+1, nextStartPos, false)-2,this.safeIndexOf(htmlResult, '</sup>', itemPos+1, nextStartPos) ));\n        newProduct.productPrice=price+cents/100;\n      }\n      newProduct.currencyCode=\"EUR\"\n  }\n\n  /**\n   * We have to go directly to the product page, otherwise there may be a redirect\n   * @param product\n   */\n  override updatePrice(product:ScrappedProduct, useProductName?:boolean): Promise<ScrappedProduct|null> {\n    if (product.productUrl==null) {\n      return super.updatePrice(product, true);\n    }\n    return this.requestWithProxy(\"GET\",product.productUrl, ProxyEngine.DONT_CODE,\n      {headers:{Accept:'text/html'}, responseType:\"text\", observe:\"body\"})\n      .then(htmlResult => {\n        const newProduct:ScrappedProduct = {productId:product.productId,\n          productName:product.productName};\n\n        const middlePos = this.safeIndexOf(htmlResult, 'userPrice',0 );\n\n        const itemPos = this.safeIndexOf(htmlResult, 'data-price=\"', middlePos);\n        newProduct.productPrice=Number.parseFloat(htmlResult.substring(itemPos, this.safeIndexOf(htmlResult, '\"', itemPos+1))\n          .replace(',','.'));\n        newProduct.currencyCode='EUR';\n        this.checkScrappedProduct(product.productName??\"\", newProduct);\n        product.productPrice=newProduct.productPrice;\n        product.currencyCode=newProduct.currencyCode;\n        return product;\n      })\n    .catch(error => {\n      console.error(\"Error trying to access page for product \"+product.productName, error);\n      return super.updatePrice(product, true);\n    });\n\n  }\n}\n","import {AbstractOnlineShopScrapper, ProxyEngine, ScrappedProduct} from \"../online-shop-scrapper\";\nimport {map} from \"rxjs\";\nimport {HttpClient} from \"@angular/common/http\";\n\nexport class GreenWeezScrapper extends AbstractOnlineShopScrapper {\n\n  static readonly SEARCH_ONLINE_URL=\"https://54m7x8foua-dsn.algolia.net/1/indexes/*/queries?x-algolia-agent=Algolia for JavaScript (4.14.2); Browser (lite); instantsearch.js (4.48.0); react (17.0.2); react-instantsearch (6.36.0); react-instantsearch-hooks (6.36.0); JS Helper (3.11.1)&x-algolia-api-key=52441d0a775f924291679b7c224d6782&x-algolia-application-id=54M7X8FOUA\"\n  static readonly BASE_URL=\"https://greenweez.com\";\n\n  protected static JSON_QUERY=\n    {\n      \"requests\": [{\n        \"indexName\": \"france_prod_offers_genepi_fr_FR\",\n        \"params\": \"attributesToRetrieve=%5B%22main_category%22%2C%22attributes%22%2C%22capacity%22%2C%22discount.percent%22%2C%22flags%22%2C%22ObjectID%22%2C%22name%22%2C%22options.color.available_colors%22%2C%22seller%22%2C%22shop_data.id%22%2C%22shop_data.variant.images%22%2C%22shop_data.variant.product.id%22%2C%22shop_data.variant.product.legacyId%22%2C%22shop_data.variant.product.slug%22%2C%22shop_data.variant.product.brand.name%22%2C%22shop_data.variant.code%22%2C%22shop_data.sellerCatalog.seller%22%2C%22shop_data.pricing%22%2C%22shop_data.offerData%22%2C%22shop_data.onHand%22%2C%22stats%22%5D&clickAnalytics=true&facets=%5B%5D&filters=has_parent_objectID%3D0&highlightPostTag=__%2Fais-highlight__&highlightPreTag=__ais-highlight__&hitsPerPage=20&query=QUERY_STRING&tagFilters=\"\n      }, {\n        \"indexName\": \"france_prod_brands_genepi_fr_FR\",\n        \"params\": \"attributesToRetrieve=%5B%22name%22%2C%22slug%22%5D&clickAnalytics=true&facets=%5B%5D&filters=&highlightPostTag=__%2Fais-highlight__&highlightPreTag=__ais-highlight__&hitsPerPage=6&query=QUERY_STRING&tagFilters=\"\n      }, {\n        \"indexName\": \"france_prod_categories_genepi_fr_FR\",\n        \"params\": \"attributesToRetrieve=%5B%22parent%22%2C%22name%22%2C%22slug%22%2C%22level%22%5D&clickAnalytics=true&facets=%5B%5D&filters=&highlightPostTag=__%2Fais-highlight__&highlightPreTag=__ais-highlight__&hitsPerPage=6&query=QUERY_STRING&tagFilters=\"\n      }]\n    }\n\n  override onlineShopName=\"GreenWeez\";\n\n  constructor(http: HttpClient) {\n    super(http);\n  }\n\n  override searchProductsForNameOrId(nameOrId: string, isId:boolean): Promise<Array<ScrappedProduct>> {\n      // We copy the content\n    let postContent=JSON.stringify(GreenWeezScrapper.JSON_QUERY);\n\n      // 3 replacements to do\n    postContent = postContent.replace(\"QUERY_STRING\", encodeURIComponent(nameOrId));\n    postContent = postContent.replace(\"QUERY_STRING\", encodeURIComponent(nameOrId));\n    postContent = postContent.replace(\"QUERY_STRING\", encodeURIComponent(nameOrId));\n    postContent=JSON.parse(postContent);\n    return this.requestWithProxy(\"POST\",GreenWeezScrapper.SEARCH_ONLINE_URL, ProxyEngine.DONT_CODE,\n    {body:postContent, responseType:\"json\", observe:\"body\"})\n      .then(jsonResult => {\n          if( typeof jsonResult == \"string\")\n            jsonResult = JSON.parse(jsonResult);\n\n          const ret= new Array<ScrappedProduct>();\n          const result=(jsonResult as any).results as Array<any>;\n          if (result.length>0) {\n            const hits=result[0].hits as Array<any>;\n            if( hits!=null) {\n              for (const aResult of hits) {\n                const newProduct = new ScrappedProduct();\n\n                newProduct.productPrice=aResult.shop_data.pricing.priceIncludedVat/100;\n                newProduct.currencyCode=\"EUR\";\n                newProduct.productName=aResult.name;\n                newProduct.productDescription=undefined;\n                newProduct.productId=aResult.shop_data.variant.code;\n                newProduct.productUrl= this.calculateProductUrl (aResult.shop_data);\n                newProduct.productImageUrl=this.findImageUrl (aResult.shop_data.variant.images);\n                newProduct.marketPlace=aResult.flags.marketPlace===true;\n\n                this.checkScrappedProduct(nameOrId, newProduct);\n                ret.push(newProduct);\n              }\n            }\n          }\n\n          return ret;\n        });\n  }\n\n  calculateProductUrl (shopData:any): string {\n    return GreenWeezScrapper.BASE_URL+'/produit/'+shopData.variant.product.slug+'/'+shopData.variant.code+'/'+shopData.id;\n  }\n\n  findImageUrl (images:Array<any>): string|undefined {\n    for (const image of images) {\n      if (image.type==\"variant\")\n        return GreenWeezScrapper.BASE_URL+\"/_next/image?url=https%3A%2F%2Fcdn.greenweez.com%2Fproducts%2F\"+image.path+\"&w=640&q=75\"\n    }\n    return;\n  }\n}\n","import {AbstractOnlineShopScrapper, ProxyEngine, ScrappedProduct} from \"../online-shop-scrapper\";\nimport {HttpClient} from \"@angular/common/http\";\n\nexport class MaxicoffeeScrapper extends AbstractOnlineShopScrapper {\n\n  static readonly SEARCH_ONLINE_URL=\"https://na.search.sensefuel.live/searchf/4147d2a1-7a21-4697-8a4c-0e25183f3ce9\"\n\n  protected static JSON_QUERY = {\n    \"acp\": {},\n    \"suggest\": {},\n    \"key\": \"1678529428523-0-AskResult\",\n    \"parentKey\": null,\n    \"terms\": {\"expression\": \"QUERY_STRING\", \"inputSource\": \"keyboard\", \"intentDetection\": {}},\n    \"trackFingerPrint\": {\"tracks\": [], \"environmentId\": \"333\"},\n    \"items\": {\"from\": 0, \"size\": 30, \"bypassSpellcheck\": false},\n    \"prefixQuery\": {},\n    \"filters\": {},\n    \"scopes\": [],\n    \"spotlights\": [],\n    \"sort\": null,\n    \"needShortcuts\": true,\n    \"userIds\": {\"id\": null, \"previousId\": null, \"custId\": null, \"isAuthenticated\": false},\n    \"sellerId\": \"France mtropolitaine\",\n    \"kickerContents\": {\"size\": 6},\n    \"contents\": {\"from\": 0, \"size\": 30, \"playOnIntent\": [\"nlu|content\"]},\n    \"references\": {\"size\": 32}\n  };\n\n  override onlineShopName=\"Maxicoffee\";\n\n\n  constructor(http: HttpClient) {\n    super(http);\n  }\n\n override searchProductsForNameOrId(nameOrId: string, isId:boolean): Promise<Array<ScrappedProduct>> {\n      // We copy the content\n    let postContent=JSON.stringify(MaxicoffeeScrapper.JSON_QUERY);\n\n    postContent = postContent.replace(\"QUERY_STRING\", nameOrId);\n    postContent=JSON.parse(postContent);\n    return this.requestWithProxy(\"POST\", MaxicoffeeScrapper.SEARCH_ONLINE_URL,\n      ProxyEngine.CORSPROXY_IO,\n    {body:postContent, responseType:\"json\", observe:\"body\"})\n      .then(jsonResult => {\n          if( typeof jsonResult == \"string\")\n            jsonResult = JSON.parse(jsonResult);\n\n          const ret= new Array<ScrappedProduct>();\n          const results=(jsonResult as any).data.items.p as Array<any>;\n          if (results.length>0) {\n            for (const aResult of results) {\n              const newProduct = new ScrappedProduct();\n\n              newProduct.productPrice=aResult.prcn;\n              newProduct.currencyCode=\"EUR\";\n              newProduct.productName=aResult.ttl;\n              newProduct.productDescription=undefined;\n              newProduct.productId=aResult.id;\n              newProduct.productUrl=aResult.lnk;\n              newProduct.productImageUrl=aResult.img;\n              newProduct.outOfStock= aResult.avl === \"in stock\";\n\n                this.checkScrappedProduct(nameOrId, newProduct);\n              ret.push(newProduct);\n            }\n          }\n\n          return ret;\n        });\n  }\n\n}\n","import {AbstractOnlineShopScrapper, ProxyEngine, ScrappedProduct} from \"../online-shop-scrapper\";\nimport {map} from \"rxjs\";\nimport {HttpClient} from \"@angular/common/http\";\n\nexport class NewPharmaScrapper extends AbstractOnlineShopScrapper {\n\n  static readonly SEARCH_ONLINE_URL=\"https://www.newpharma.fr/search-results/search.html?q=QUERY_STRING\"\n  protected static readonly PRODUCT_START_STRING=\"<div class=\\\"product js-product-row product--desktop\";\n\n  override onlineShopName=\"NewPharma\";\n\n  constructor(httpClient: HttpClient) {\n    super(httpClient);\n  }\n\n  override searchProductsForNameOrId(nameOrId: string, isId:boolean): Promise<Array<ScrappedProduct>> {\n    const query = NewPharmaScrapper.SEARCH_ONLINE_URL.replace(\"QUERY_STRING\", encodeURIComponent(nameOrId));\n    const headers = this.standardHeaders ();\n\n    return this.requestWithProxy(\"GET\", query, ProxyEngine.CHROME_ENGINE,\n    {headers, withCredentials:false, responseType:\"text\", observe:\"body\"})\n      .then(htmlResult => {\n\n          const ret= new Array<ScrappedProduct>();\n          let startPos = htmlResult.indexOf(NewPharmaScrapper.PRODUCT_START_STRING);\n          while (startPos>=0) {\n            const newProduct = new ScrappedProduct();\n            let itemPos = htmlResult.indexOf('data-productid=\"', startPos)+16;\n            newProduct.productId=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n            itemPos = htmlResult.indexOf('<a class=\"details__title', startPos)+24;\n            itemPos = htmlResult.indexOf('title=\"', itemPos+1)+7;\n            newProduct.productName=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n            newProduct.productDescription=undefined;\n            itemPos = htmlResult.indexOf('href=\"', startPos)+6;\n            newProduct.productUrl=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n            itemPos = htmlResult.indexOf('<img src=\"', startPos+1)+10;\n            newProduct.productImageUrl=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n\n            this.extractPrice(htmlResult, startPos, newProduct);\n            this.checkScrappedProduct(nameOrId, newProduct);\n            ret.push(newProduct);\n\n            startPos = htmlResult.indexOf(NewPharmaScrapper.PRODUCT_START_STRING, startPos+1);\n          }\n\n          return ret;\n        });\n  }\n\n  extractPrice (htmlResult:string, startPos:number, newProduct:ScrappedProduct): void {\n    let startPricePos = htmlResult.indexOf('data-content_ids=\"['+newProduct.productId+']\"', startPos+1);\n    if( startPricePos==-1) {\n      startPricePos = htmlResult.indexOf('data-content_ids=\"'+newProduct.productId+'\"', startPos+1);\n    }\n    if (startPricePos!=-1) { // It may be unavailable\n      let itemPos = htmlResult.indexOf('data-currency=\"', startPricePos)+15;\n      newProduct.currencyCode=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n      itemPos = htmlResult.indexOf('data-value=\"', startPricePos)+12;\n      newProduct.productPrice=parseFloat(htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1)));\n    }\n\n  }\n\n  /**\n   * We have to go directly to the product page, otherwise there may be a redirect\n   * @param product\n   */\n  override updatePrice(product:ScrappedProduct, useProductName?:boolean): Promise<ScrappedProduct|null> {\n    if (product.productUrl==null) {\n      return super.updatePrice(product, true);\n    }\n    return this.requestWithProxy(\"GET\",product.productUrl, ProxyEngine.CHROME_ENGINE,\n      {headers:{Accept:'text/html'}, withCredentials:false, responseType:\"text\", observe:\"body\"})\n      .then(htmlResult => {\n        const newProduct:ScrappedProduct = {productId:product.productId,\n          productName:product.productName};\n          this.extractPrice(htmlResult, 0, newProduct);\n          this.checkScrappedProduct(product.productName??\"\", newProduct);\n          product.productPrice=newProduct.productPrice;\n          product.currencyCode=newProduct.currencyCode;\n          return product;\n      })\n    .catch(error => {\n      console.error(\"Error trying to access page for product \"+product.productName, error);\n      return super.updatePrice(product, true);\n    });\n\n  }\n}\n","import {AbstractOnlineShopScrapper, ProxyEngine, ScrappedProduct} from \"../online-shop-scrapper\";\nimport {map} from \"rxjs\";\nimport {HttpClient} from \"@angular/common/http\";\n\nexport class OnateraScrapper extends AbstractOnlineShopScrapper {\n\n  static readonly SEARCH_ONLINE_URL=\"https://f75bb6q2sy-dsn.algolia.net/1/indexes/*/queries?x-algolia-agent=Algolia+for+JavaScript+%284.11.0%29%3B+Browser+%28lite%29%3B+instantsearch.js+%284.41.0%29%3B+Vue+%282.6.14%29%3B+Vue+InstantSearch+%284.3.3%29%3B+JS+Helper+%283.8.2%29&x-algolia-api-key=f319f4e4b15d239ba0509b3c6c4a0ecd&x-algolia-application-id=F75BB6Q2SY\"\n  static readonly BASE_URL=\"https://onatera.com\";\n\n  static readonly  IMAGE_BASE_URL='https://media.onatera.com/cache/product_image_listing_DM/'\n\n  protected static JSON_QUERY=\n    {\n      \"requests\": [{\n        \"indexName\": \"intl.product.fr.fr\",\n        \"params\": \"clickAnalytics=true&facets=%5B%5D&hitsPerPage=0&query=QUERY_STRING&tagFilters=&userToken=anonymous_09f81bae3a73d5bcb1582423816110b7\"\n      }, {\n        \"indexName\": \"intl.product.fr.fr\",\n        \"params\": \"clickAnalytics=true&facets=%5B%5D&highlightPostTag=__%2Fais-highlight__&highlightPreTag=__ais-highlight__&hitsPerPage=6&query=QUERY_STRING&tagFilters=&userToken=anonymous_09f81bae3a73d5bcb1582423816110b7\"\n      }, {\n        \"indexName\": \"intl.category.fr.fr\",\n        \"params\": \"clickAnalytics=true&facets=%5B%5D&highlightPostTag=__%2Fais-highlight__&highlightPreTag=__ais-highlight__&hitsPerPage=3&numericFilters=ref_count%20%3E%200&query=QUERY_STRING&tagFilters=&userToken=anonymous_09f81bae3a73d5bcb1582423816110b7\"\n      }, {\n        \"indexName\": \"intl.brand.fr.fr\",\n        \"params\": \"clickAnalytics=true&facets=%5B%5D&highlightPostTag=__%2Fais-highlight__&highlightPreTag=__ais-highlight__&hitsPerPage=3&numericFilters=product_count%20%3E%200&query=QUERY_STRING&tagFilters=&userToken=anonymous_09f81bae3a73d5bcb1582423816110b7\"\n      }, {\n        \"indexName\": \"intl.active.fr.fr\",\n        \"params\": \"clickAnalytics=true&facets=%5B%5D&highlightPostTag=__%2Fais-highlight__&highlightPreTag=__ais-highlight__&hitsPerPage=3&numericFilters=product_count%20%3E%200&query=QUERY_STRING&tagFilters=&userToken=anonymous_09f81bae3a73d5bcb1582423816110b7\"\n      }, {\n        \"indexName\": \"intl.content.for_recipes.fr.fr\",\n        \"params\": \"clickAnalytics=true&facetFilters=%5B%22type%3Adiy%22%5D&facets=%5B%5D&highlightPostTag=__%2Fais-highlight__&highlightPreTag=__ais-highlight__&hitsPerPage=3&query=QUERY_STRING&tagFilters=&userToken=anonymous_09f81bae3a73d5bcb1582423816110b7\"\n      }]\n    }\n  override onlineShopName=\"Onatera\";\n\n  constructor(http: HttpClient) {\n    super(http);\n  }\n\n  override searchProductsForNameOrId(nameOrId: string, isId:boolean): Promise<Array<ScrappedProduct>> {\n      // We copy the content\n    let postContent=JSON.stringify(OnateraScrapper.JSON_QUERY);\n\n      // And add the query\n    postContent=postContent.replace (/QUERY_STRING/g, encodeURIComponent(nameOrId));\n\n    postContent=JSON.parse(postContent);\n    return this.requestWithProxy(\"POST\", OnateraScrapper.SEARCH_ONLINE_URL, ProxyEngine.CORSPROXY_IO\n    ,{body:postContent, responseType:\"json\", observe:\"body\"})\n      .then(jsonResult => {\n          if( typeof jsonResult == \"string\")\n            jsonResult = JSON.parse(jsonResult);\n\n          const ret= new Array<ScrappedProduct>();\n          const results=(jsonResult as any).results as Array<any>;\n          if (results.length>0) {\n            for (const result of results) {\n              const hits=result.hits as Array<any>;\n              if( hits!=null) {\n                for (const aResult of hits) {\n                  if( aResult.is_active==true) {\n                  const productName=aResult.name+' '+aResult.brand_name+' ';\n                  if (aResult.variants!=null) {\n                      for (const variant of aResult.variants) {\n                        const newProduct = new ScrappedProduct();\n\n                        newProduct.productPrice=variant.price/100;\n                        newProduct.outOfStock=!variant.hasStock;\n                        newProduct.currencyCode=\"EUR\";\n                        newProduct.productName=productName+variant.name;\n                        newProduct.productDescription=variant.shortDescription??variant.description;\n                        newProduct.productId=variant.productVariantId.toString();\n                        newProduct.productUrl=OnateraScrapper.BASE_URL+variant.url;\n                        newProduct.productImageUrl=OnateraScrapper.IMAGE_BASE_URL+variant.picture_path;\n\n                        this.checkScrappedProduct(nameOrId, newProduct);\n                        ret.push(newProduct);\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n\n          return ret;\n        });\n  }\n\n}\n","import {AbstractOnlineShopScrapper, ProxyEngine, ScrappedProduct} from \"../online-shop-scrapper\";\nimport {map} from \"rxjs\";\nimport {HttpClient} from \"@angular/common/http\";\n\nexport class WebEcologieScrapper extends AbstractOnlineShopScrapper {\n\n  static readonly SEARCH_ONLINE_URL=\"https://www.webecologie.com/rechercher?search_query=QUERY_STRING\"\n  protected static readonly PRODUCT_START_STRING=\"<a class=\\\"product_img_link\\\"\";\n\n  override onlineShopName=\"WebEcologie\";\n\n\n  constructor(http: HttpClient) {\n    super(http);\n  }\n\n  override searchProductsForNameOrId(nameOrId: string, isId:boolean): Promise<Array<ScrappedProduct>> {\n    const query = WebEcologieScrapper.SEARCH_ONLINE_URL.replace(\"QUERY_STRING\", encodeURIComponent(nameOrId));\n\n    return this.requestWithProxy(\"GET\", query, ProxyEngine.DONT_CODE\n    ,{headers:{Accept:'text/html'}, responseType:\"text\", observe:\"body\"})\n      .then(htmlResult => {\n\n          const ret= new Array<ScrappedProduct>();\n          let startPos = htmlResult.indexOf(WebEcologieScrapper.PRODUCT_START_STRING);\n          while (startPos>=0) {\n            const newProduct = new ScrappedProduct();\n            let itemPos = htmlResult.indexOf('href=\"', startPos)+6;\n            newProduct.productUrl=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n            itemPos = htmlResult.indexOf('title=\"', startPos)+7;\n            newProduct.productName=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n            newProduct.productDescription=undefined;\n            itemPos = htmlResult.indexOf('src=\"', startPos+1)+5;\n            newProduct.productImageUrl=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n            const startWishlistPos = htmlResult.indexOf('<a class=\"addToWishlist', startPos)+23;\n            itemPos = htmlResult.indexOf('rel=\"', startWishlistPos)+5;\n            newProduct.productId=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n\n            this.extractPrice(htmlResult, startPos, newProduct);\n            this.checkScrappedProduct(nameOrId, newProduct);\n            ret.push(newProduct);\n\n            startPos = htmlResult.indexOf(WebEcologieScrapper.PRODUCT_START_STRING, startPos+1);\n          }\n\n          return ret;\n        });\n  }\n\n  extractPrice (htmlResult:string, startPos:number, newProduct:ScrappedProduct): void {\n      let itemPos = htmlResult.indexOf('class=\"price-first-part\">', startPos)+25;\n      let price = Number.parseInt(htmlResult.substring(itemPos, htmlResult.indexOf('<', itemPos+1)));\n\n      itemPos = htmlResult.indexOf('class=\"price-last-part\">', startPos)+24;\n      price = price + Number.parseInt(htmlResult.substring(itemPos, htmlResult.indexOf('<', itemPos+1)))/100;\n      newProduct.productPrice=price;\n\n      itemPos = htmlResult.indexOf(\"itemprop=\\\"priceCurrency\\\"\", startPos)+24;\n      itemPos = htmlResult.indexOf(\"content=\\\"\", itemPos)+9;\n      newProduct.currencyCode=htmlResult.substring(itemPos, htmlResult.indexOf('\"', itemPos+1));\n\n  }\n\n  /**\n   * We have to go directly to the product page, otherwise there may be a redirect\n   * @param product\n   */\n  override updatePrice(product:ScrappedProduct, useProductName?:boolean): Promise<ScrappedProduct|null> {\n    if (product.productUrl==null) {\n      return super.updatePrice(product, true);  // If the product url is not found, let's try with the product name\n    }\n    return this.requestWithProxy(\"GET\", product.productUrl,ProxyEngine.DONT_CODE\n      ,{headers:{Accept:'text/html'}, responseType:\"text\", observe:\"body\"})\n      .then(htmlResult => {\n        const newProduct:ScrappedProduct = {productId:product.productId,\n          productName:product.productName};\n          this.extractPrice(htmlResult, 0, newProduct);\n          this.checkScrappedProduct(product.productName??\"Unknown\", newProduct);\n          product.productPrice=newProduct.productPrice;\n          product.currencyCode=newProduct.currencyCode;\n          return product;\n      }).catch(error => {\n      console.error(\"Error trying to access page for product \"+product.productName, error);\n      return super.updatePrice(product, true);\n    });\n\n  }\n}\n","import {Injectable, Optional} from '@angular/core';\nimport {AbstractOnlineShopScrapper, OnlineShopScrapper, ScrappedProduct} from \"../online-shop-scrapper\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {EasyParaScrapper} from \"../scrappers/easy-para-scrapper\";\nimport {\n  DontCodeEntityType,\n  DontCodeModelManager,\n  DontCodeStoreCriteriaOperator,\n  DontCodeStoreManager,\n  dtcde\n} from \"@dontcode/core\";\nimport {PriceModel} from \"../price-model\";\nimport {GreenWeezScrapper} from \"../scrappers/greenweez-scrapper\";\nimport {CommercePlugin} from \"../../declaration/commerce-plugin\";\nimport {firstValueFrom} from \"rxjs\";\nimport {NewPharmaScrapper} from \"../scrappers/new-pharma-scrapper\";\nimport {WebEcologieScrapper} from \"../scrappers/web-ecologie-scrapper\";\nimport {BoulangerScrapper} from \"../scrappers/boulanger-scrapper\";\nimport {DartyScrapper} from \"../scrappers/darty-scrapper\";\nimport {CDiscountScrapper} from \"../scrappers/cdiscount-scrapper\";\nimport {AmazonScrapper} from \"../scrappers/amazon-scrapper\";\nimport {FnacScrapper} from \"../scrappers/fnac-scrapper\";\nimport {OnateraScrapper} from \"../scrappers/onatera-scrapper\";\nimport {MaxicoffeeScrapper} from \"../scrappers/maxicoffee-scrapper\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PriceFinderService {\n\n  private static DONT_UPDATE_UNTIL_DELAY_MS = 1000*60*10; // Don't update price until 10mn has passed since the last one\n  protected listOfScrappers = new Map<string, OnlineShopScrapper> ();\n  protected shopTypeNames = new Array<string>();\n\n  constructor(protected httpClient:HttpClient, @Optional() protected modelMgr:DontCodeModelManager,\n              @Optional() protected storeMgr:DontCodeStoreManager) {\n    if (this.modelMgr==null)  this.modelMgr=dtcde.getModelManager();\n    if (this.storeMgr==null) this.storeMgr=dtcde.getStoreManager();\n\n    this.addScrapper (new EasyParaScrapper(httpClient));\n    this.addScrapper (new GreenWeezScrapper(httpClient));\n    this.addScrapper(new NewPharmaScrapper(httpClient));\n    this.addScrapper(new WebEcologieScrapper(httpClient));\n    this.addScrapper(new OnateraScrapper(httpClient));\n    this.addScrapper(new BoulangerScrapper(httpClient));\n    this.addScrapper(new DartyScrapper(httpClient));\n    this.addScrapper(new CDiscountScrapper(httpClient));\n    this.addScrapper(new FnacScrapper(httpClient));\n    this.addScrapper(new AmazonScrapper(httpClient));\n    this.addScrapper(new MaxicoffeeScrapper(httpClient));\n  }\n\n  addScrapper (newScrapper: OnlineShopScrapper): void {\n    this.listOfScrappers.set(newScrapper.getOnlineShopName(), newScrapper);\n    this.shopTypeNames.push(newScrapper.getOnlineShopName());\n  }\n\n  getListOfShopTypes (): Array<string> {\n    return this.shopTypeNames;\n  }\n\n  /**\n   * Finds the list of products corresponding to the productInfo given for the shopTypeName given at the model position given.\n   * @param productInfo\n   * @param position\n   * @param shopName\n   * @param model\n   */\n  async searchProducts (productName: string, shopName:string): Promise<Array<ScrappedProduct>> {\n    const scrapper = this.listOfScrappers.get(await this.getShopTypeNameOf (shopName));\n    if (scrapper==null)\n      throw new Error (\"Shop type \"+shopName+\" not found\");\n\n    return scrapper.searchProductsForNameOrId(productName,false);\n  }\n\n  /**\n   * Finds the price of a product in parameter for a shop in parameter. It looks for a Price element in the product info given.\n   * and updates it\n   * @param productValue\n   * @param position\n   * @param shopName\n   * @param model\n   */\n  async findPrice (productValue: any, shopName:string, position:string, model?:DontCodeEntityType): Promise<PriceModel|null> {\n    if (productValue == null) {\n      throw new Error(\"No product to get price for\");\n    }\n    const scrapper = this.listOfScrappers.get(await this.getShopTypeNameOf(shopName));\n    if (scrapper == null)\n      throw new Error(\"Shop type \" + shopName + \" not found\");\n\n    if (model == null) {\n      model = this.modelMgr.findAtPosition(position, false);\n    }\n    // We're looking for a Price that points to the shopType given in parameter\n    let priceField = null;\n    let productPrice: PriceModel | null = null;\n    if (model?.fields!=null) {\n      for (const field of Object.values(model.fields)) {\n        if (field.type === \"Price\") {\n          // We found one, is it the correct one ?\n          priceField = field;\n          productPrice = productValue[priceField.name];\n          break;\n          /*if (productPrice?.shop!==shopTypeName) {\n            priceField=null;\n            productPrice=null;\n          }else {\n            break;\n          }*/\n        }\n      }\n    }\n\n    // In case we didn't find anything, we assume the value in parameter is the price\n    if (priceField == null) {\n      priceField = model;\n      productPrice = productValue;\n    }\n\n    // Let's see if we already have the id of the item, then we can get the price very quickly\n    const productId = this.findProductId(productPrice);\n    if ((productId == null) || (productPrice == null)) {\n      return Promise.reject(\"Product Id not found in \" + productValue);\n    } else {\n\n      if (productPrice != null) {\n        // First update the lastCheckDate to avoid continuously retrying to get the price in case of error\n        productPrice.lastCheckDate = new Date();\n        return scrapper.updatePrice({\n          productId,\n          productName: productPrice.nameInShop ?? null,\n          productUrl: productPrice.urlInShop\n        }).then(updated => {\n          if ((updated != null) && (productPrice != null)) {\n            productPrice.cost = AbstractOnlineShopScrapper.toMoneyAmount(updated);\n            productPrice.outOfStock = updated.outOfStock;\n            productPrice.priceDate=new Date();\n            productPrice.inError = false;\n            return productPrice;\n          }\n          return null;\n        }).catch(reason => {\n          console.error(\"Cannot update price for \" + productPrice?.nameInShop + \" because of \", reason);\n          if (productPrice!=null)\n            productPrice.inError=true;\n          throw reason;\n        });\n      } else {\n        return Promise.reject(\"Impossible to be there...\");\n      }\n    }\n  }\n\n  protected findProductId (info:any):string|null {\n      // Try to find if we have a list of shop per product\n    if (info?.idInShop!=null) {\n      return info?.idInShop;\n    } else {\n      if (info?.productId!=null)\n        return info?.productId;\n      else if (info?.id!=null) {\n        return info?.id;\n      }\n    }\n    return null;\n  }\n\n  protected findProductName (info:any):string|null {\n    // Try to find if we have a list of shop per product\n    if (info?.nameInShop!=null) {\n      return info?.nameInShop;\n    } else {\n      if (info?.productName!=null)\n        return info?.productName;\n      else if (info?.name!=null) {\n        return info?.name;\n      }\n    }\n    return null;\n  }\n\n  async updatePriceIfPossible(val: PriceModel, position:string):Promise<PriceModel|null> {\n    if( (val.idInShop!=null)&& (val.shop!=null)) {\n      if( typeof val.lastCheckDate === 'string') {\n        val.lastCheckDate= new Date(val.lastCheckDate);\n      }\n      if ((val.lastCheckDate==null) ||\n          (val.lastCheckDate.getTime()+PriceFinderService.DONT_UPDATE_UNTIL_DELAY_MS < new Date().getTime())\n      ) {\n        // Yes we can update\n        //console.debug(\"Need to update price for \", val.nameInShop);\n        const newPrice = await this.findPrice(val, val.shop, position);\n\n        if( newPrice!=null)\n          newPrice.priceDate=new Date();\n        return newPrice;\n      }\n    }\n    return null;\n\n  }\n\n  private getShopTypeNameOf(shopName: string):Promise<string> {\n    const query=\"$.creation.entities[?(@.name=='\"+CommercePlugin.SHOP_ENTITY_NAME+\"')]\";\n    const targetEntitiesPos = this.modelMgr.queryModelToSingle(query)?.pointer;\n\n    if (targetEntitiesPos==null)  return Promise.resolve(shopName);\n\n    return firstValueFrom(this.storeMgr.searchEntities(targetEntitiesPos, {\n      name:'Shop',\n      value:shopName,\n      operator:DontCodeStoreCriteriaOperator.EQUALS\n    })).then((loaded) => {\n      if (loaded?.length!=1) return shopName;\n      if( (loaded[0] as any).Type!=null)\n        return (loaded[0] as any).Type;\n      else\n        return shopName;\n    });\n  }\n}\n","import {ChangeDetectorRef, Component, EventEmitter, Input, Output} from '@angular/core';\nimport {ScrappedProduct} from \"../online-shop-scrapper\";\n\n@Component({\n  selector: 'dontcode-commerce-product-selection',\n  templateUrl: './product-selection.component.html',\n  styleUrls: ['./product-selection.component.scss']\n})\nexport class ProductSelectionComponent {\n  @Input()\n  listOfProducts=new Array<ScrappedProduct>();\n\n  @Output()\n  selected = new EventEmitter<ScrappedProduct|null>();\n\n  constructor(protected ref: ChangeDetectorRef) {\n  }\n\n  selectionOf(product: ScrappedProduct):void {\n    this.selected.next(product);\n  }\n\n  localizedAmount (product:ScrappedProduct): string {\n    if( product.productPrice==null || (product.currencyCode==null))\n      return product.currencyCode??\"\";\n    return Intl.NumberFormat(globalThis?.window?.navigator.language ?? 'en-US', { style:'currency', currency:product.currencyCode})\n      .format(product.productPrice);\n  }\n\n  notFound() {\n    this.selected.next(null);\n  }\n}\n","<p-dataView [value]=\"listOfProducts\" [rows]=\"4\" [paginator]=\"true\" layout=\"grid\">\n  <ng-template pTemplate=\"header\">Select product, or <button label=\"Not found\" icon=\"pi pi-delete-left\" pButton (click)=\"notFound ()\"></button></ng-template>\n  <ng-template let-product pTemplate=\"gridItem\">\n    <div class=\"col-6 md:col-3 flex align-items-stretch\">\n      <p-card [header]=\"product.productName\">\n        <ng-template pTemplate=\"header\">\n          <img *ngIf=\"product.productImageUrl!==null\" [src]=\"product.productImageUrl\" />&nbsp;\n        </ng-template>\n        <p><small>{{product.productDescription}}</small></p>\n        <p><h2>{{localizedAmount(product)}}</h2>\n        <ng-template pTemplate=\"footer\">\n          <button label=\"Select\" icon=\"pi pi-check\" pButton (click)=\"selectionOf (product)\"></button>\n        </ng-template>\n      </p-card>\n    </div>\n  </ng-template>\n</p-dataView>\n","import {Core, DontCodeModel, Plugin, PluginConfig} from '@dontcode/core';\nimport {_adapters, Chart} from \"chart.js\";\nimport {StdDateAdapter} from \"chartjs-adapter-date-std\";\nimport autocolorPlugin from \"chartjs-plugin-autocolors-typescript\";\n/**\n * This plugin demonstrate 2 things:\n * - how to declare a new field type that can be selected in the Builder and how to manage the display and edition of this new type in the Previewer.\n * - As well it adds a new attribute 'seed' to any Entity and provides a viewer for the Previewer when its value is Yes or Maybe.\n */\nexport class ReportPlugin implements Plugin {\n\n  constructor() {\n    Chart.register(autocolorPlugin);\n    _adapters._date.override( StdDateAdapter.chartJsStandardAdapter());\n  }\n\n  getConfiguration(): PluginConfig {\n    return {\n      plugin: {\n        id: 'ReportPlugin',\n        'display-name':\n          'Implements the Dont-code standard report model.',\n        version: '1.0.0',\n      },\n      'preview-handlers': [\n        {\n          location: {\n            parent: DontCodeModel.APP_REPORTS,\n            id: ''\n          },\n          class: {\n            name: 'ReportEntityComponent',\n            source: 'report',\n          },\n        },\n        {\n          location: {\n            parent: DontCodeModel.APP_REPORTS_DISPLAY,\n            id: 'type',\n            values: ['Table']\n          },\n          class: {\n            name: 'ReportTableComponent',\n            source: 'report',\n          },\n        },\n        {\n          location: {\n            parent: DontCodeModel.APP_REPORTS_DISPLAY\n          },\n          class: {\n            name: 'ReportDisplayComponent',\n            source: 'report',\n          },\n        }\n      ]\n    };\n  }\n\n  pluginInit(dontCode: Core): void {\n    // Nothing to do here\n  }\n}\n","import {DontCodeDataTransformer} from \"@dontcode/core\";\nimport {\n  DataTransformationInfo,\n  DontCodeEntityType,\n  DontCodeModel,\n  DontCodeModelManager,\n  DontCodeModelPointer,\n  DontCodeReportGroupShowType,\n  DontCodeReportGroupType\n} from \"@dontcode/core\";\n\n/**\n * Transform columns values into rows depending on the graph configuration\n */\nexport class CrossDataTransformer<T=never> implements DontCodeDataTransformer<T>{\n  constructor(protected modelMgr: DontCodeModelManager, protected affectedColumns:string[], protected groupType: DontCodeReportGroupType, protected entityPosition:DontCodeModelPointer) {\n  }\n  postLoadingTransformation(source: any[]): T[] {\n    if (this.groupType.show==null) return source;\n\n    const ret = new Array<T>();\n    const fieldMapping = this.calculateFieldMapping();\n    const metadataPerField=new Map<string, DataTransformationInfo>();\n    // Adds the groupBy Column to each element so that standard groupBy works\n    for (const srcItem of source) {\n      const newItem = structuredClone(srcItem);\n       // Let's calculate the relevant column\n      newItem[this.groupType.show.valueOf()]=this.calculateRelevantColumn(srcItem, fieldMapping, metadataPerField);\n      ret.push(newItem);\n    }\n    return ret;\n  }\n\n  private calculateRelevantColumn(srcItem: any, fieldMapping:Map<string, string>, metadataPerField:Map<string, DataTransformationInfo>):string|undefined {\n    let value=undefined;\n    let extractValue=undefined;\n    let column=undefined;\n\n      const fieldsPosition=this.entityPosition.subItemPointer(DontCodeModel.APP_FIELDS_NODE);\n      for (const field of this.affectedColumns) {\n        let metadata = metadataPerField.get(field);\n        if (metadata==null) {\n          metadata=new DataTransformationInfo();\n          metadataPerField.set(field, metadata);\n        }\n        const fieldId=fieldMapping.get(field);\n        if (fieldId==null) return undefined;\n        const valueField=this.modelMgr.extractValue(srcItem[field], metadata, fieldsPosition.subItemPointer(fieldId));\n        if ((value == null) || (extractValue==null)) {\n          value = srcItem[field]\n          extractValue=valueField;\n          column=field;\n        }\n        else {\n          if (this.groupType.show==DontCodeReportGroupShowType.OnlyLowest) {\n            if (valueField < extractValue) {\n              value = srcItem[field];\n              extractValue=valueField;\n              column=field;\n            }\n          }else { // Keep only Highest values\n            if (valueField > extractValue) {\n              value = srcItem[field];\n              extractValue=valueField;\n              column=field;\n            }\n          }\n        }\n\n      }\n      return column;\n    }\n\n  private calculateFieldMapping(): Map<string, string> {\n    const entityDesc = this.modelMgr.findAtPosition(this.entityPosition.position, false) as DontCodeEntityType;\n    const ret = new Map<string, string>();\n    if (entityDesc.fields!=null) {\n      for (const field of Object.entries(entityDesc.fields)) {\n        if (field[1].name!=null) {\n          ret.set(field[1].name,field[0]);\n        }\n      }\n    }\n    return ret;\n  }\n}\n","import {DataTransformationInfo, DontCodeModelManager, DontCodeReportDisplayType} from \"@dontcode/core\";\nimport {Observable, ReplaySubject} from \"rxjs\";\nimport {ChartData, ChartOptions, ChartType, DefaultDataPoint, TooltipItem} from \"chart.js\";\nimport {EntityListManager} from \"@dontcode/plugin-common\";\n\n/**\n * Calculates the correct data to generate a graph based on the configuration of the model\n */\nexport class GraphDataTransformer {\n\n  protected config?: DontCodeReportDisplayType;\n\n  protected labelFieldName?:string;\n\n  protected data = new ReplaySubject<ChartData<ChartType, DefaultDataPoint<ChartType>>>(1);\n  protected option = new ReplaySubject<ChartOptions<ChartType>>(1);\n\n  protected targetType:string|null=null;\n\n  constructor(protected modelMgr:DontCodeModelManager, graphConfig?: DontCodeReportDisplayType) {\n    this.config=graphConfig;\n  }\n\n  setConfig (graphConfig?: DontCodeReportDisplayType) : void {\n    this.config = graphConfig;\n  }\n\n  setTargetType (newType:string|null): void {\n    this.targetType=newType;\n  }\n\n  translatedGraphType (): string|undefined {\n    if( this.config?.type!=null) {\n      return this.config.type.toLowerCase();\n    }\n    return;\n  }\n\n  changeGraphType (newType:string) {\n    if (this.config==null)\n      throw new Error (\"No config to change type to \"+ newType);\n    this.config.type=newType;\n  }\n\n  dataObservable (): Observable<ChartData<ChartType, DefaultDataPoint<ChartType>>> {\n    return this.data.asObservable();\n  }\n\n  optionObservable():Observable<ChartOptions<ChartType>> {\n    return this.option.asObservable();\n  }\n\n  updateSourceData (srcData:EntityListManager): void {\n    if (this.config==null) {\n      throw new Error (\"Cannot process source data without graph configuration\");\n    }\n\n    const isAmount = this.targetType == 'Dollar' || this.targetType == 'Euro' || this.targetType == 'Other currency';\n    let byDate = false;\n\n    if (this.config.type!=\"Table\") {\n      const data: any[] = [];\n      const labels = [];\n      let count = 1;\n\n      const metaData = new DataTransformationInfo();\n      const isBiDirectional = this.config.type!='Pie';\n\n      let xFieldName=this.labelFieldName;\n      if( this.config.by!=null)\n        xFieldName = this.config.by;\n      for (const elt of (srcData.entities as any[])) {\n\n        let label;\n        if (xFieldName != null) {\n          if (elt[xFieldName] instanceof Date) byDate=true;\n          label = this.translateDateValue (elt[xFieldName]);\n        }\n        else {\n          label = count;\n          count++;\n        }\n\n        const newVal = this.translateDateValue (this.modelMgr.extractValue (elt[this.config.of], metaData));\n          // Aggregates values for same label\n        let posLabel = labels.indexOf(label);\n        if (posLabel==-1)\n          labels.push(label);\n\n        if (!isBiDirectional) {\n          if (posLabel==-1) {\n            data.push(newVal);\n          } else {\n            if (typeof data[posLabel]=='number')  // Aggregate values for the same label\n              data[posLabel]=(newVal!=null)?data[posLabel]+newVal:data[posLabel];\n            else if (data[posLabel]==null) {\n              data[posLabel]=newVal;\n            } else {\n              // We cannot add values, so we create a separate data point\n              posLabel=-1;\n              labels.push(label);\n              data.push(newVal);\n            }\n          }\n        } else {\n          if (posLabel==-1) {\n            // We store the complete object in src field in case it's an amount with currency for example\n            data.push({x: label, y: newVal, src: elt[this.config.of]});\n          } else {\n            if (typeof (data[posLabel].y)=='number') { // Aggregate values for the same label\n              data[posLabel].y=(newVal!=null)?data[posLabel].y+newVal:data[posLabel].y;\n              data[posLabel].src= this.modelMgr.modifyValues (data[posLabel].src, elt[this.config.of], metaData, \n                (first, second) => {\n                  if (first==null) return second;\n                  if (second==null) return first;\n                  return first+second;\n                });\n            } else if (data[posLabel].y == null) {\n              data[posLabel].y=newVal;\n              data[posLabel].src = elt[this.config.of];\n            } else {\n              // There is no numeric values to sum up, so let's create a separate data point\n              data.push({x: label, y:newVal, src: elt[this.config.of]});\n            }\n          }\n        }\n      }\n\n      const chartData: ChartData<ChartType, DefaultDataPoint<ChartType>> = {\n        datasets: [\n          {\n            label: this.config.of,\n            data\n          }\n        ]\n      };\n\n      const chartOption: ChartOptions<ChartType> = {}\n\n      chartOption.plugins = {};\n      chartOption.plugins.title = {\n        align: \"center\",\n        position: \"top\",\n        display: true,\n        text: this.config.title\n      }\n\n      if (!isAmount || !isBiDirectional) {\n        chartData.labels = labels;\n      }\n\n      if( byDate) {\n        chartOption.scales = {\n            x: {\n              type: 'time'\n          }\n        }\n      }\n      if( this.config.type!=\"Line\") {\n        chartOption.plugins.autocolors = {\n            mode: 'data',\n            offset:2\n        }\n      } else {\n        chartOption.plugins.autocolors = {\n          mode: 'dataset',\n          offset:2\n        }\n\n      }\n\n      if (isAmount)\n      {\n        chartOption.plugins.tooltip = {\n          callbacks: {\n            label: function (context: TooltipItem<any>): string {\n              if ((context.raw as any)?.src?.currencyCode != null) {\n                return Intl.NumberFormat(undefined, {\n                  style: 'currency',\n                  currency: (context.raw as any).src.currencyCode\n                }).format(context.parsed.y);\n              \n              } else\n                return context.parsed.y;\n            }\n          }\n        }\n      }\n\n      if (this.config.type == 'Bar') {\n        const barChartConfig = chartData as ChartData<'bar'>;\n\n        /*for (const dataSet of barChartConfig.datasets) {\n          dataSet.backgroundColor = ChartsColors.fillColors;\n        }*/\n      } else if (this.config.type == 'Pie') {\n        const pieChartConfig = chartData as ChartData<'pie'>;\n\n        for (const dataSet of pieChartConfig.datasets) {\n          //dataSet.backgroundColor = ChartsColors.fillColors;\n          dataSet.hoverOffset = 20;\n        }\n\n      } else if (this.config.type == 'Line') {\n        const lineChartConfig = chartData as ChartData<'line'>;\n\n        /*let position = 0;\n        for (const dataSet of lineChartConfig.datasets) {\n          dataSet.borderColor = ChartsColors.fillColors[position];\n          position++;\n        }*/\n      }\n      this.data.next(chartData);\n      this.option.next(chartOption);\n    }\n  }\n\n  setLabelFieldName(fieldName: string) {\n    this.labelFieldName = fieldName;\n  }\n\n  private translateDateValue(eltElement: any) {\n    if (eltElement instanceof Date) {\n      return (eltElement as Date).valueOf();\n    }else return eltElement;\n  }\n}\n\n/* class ChartsColors {\n  public static fillColors=[\n    '#42A5F5',\n    '#7E57C2',\n    '#66BB6A',\n    '#FFCA28',\n    '#26A69A',\n    '#EC407A',\n    '#AB47BC'\n  ]\n}*/\n\n","import {Component, TemplateRef, ViewChild,} from '@angular/core';\nimport {\n  AbstractDynamicComponent,\n  EntityListManager,\n  PossibleTemplateList,\n  TemplateList,\n} from '@dontcode/plugin-common';\nimport {\n  Change,\n  ChangeType,\n  CommandProviderInterface,\n  DontCodeModel,\n  DontCodeModelManager,\n  DontCodeModelPointer,\n  DontCodeReportDisplayType,\n  DontCodeSchemaManager, DontCodeStorePreparedEntities,\n  PreviewHandler\n} from \"@dontcode/core\";\nimport {GraphDataTransformer} from \"../graph-data-transformer\";\nimport {Observable} from \"rxjs\";\nimport {ChartData, ChartOptions, ChartType, DefaultDataPoint} from \"chart.js\";\n\n@Component({\n  selector: 'dontcode-report-field',\n  templateUrl: './report-display.component.html',\n  styleUrls: ['./report-display.component.scss'],\n})\nexport class ReportDisplayComponent extends AbstractDynamicComponent implements PreviewHandler {\n  @ViewChild('fullView', {static: true})\n  private fullView!: TemplateRef<any>;\n\n  type?: string;\n  title=\"\";\n\n  provider: CommandProviderInterface | null = null;\n  graphModelPointer: DontCodeModelPointer | null = null;\n  protected dataTransformer:GraphDataTransformer;\n  chartData$: Observable<ChartData<ChartType, DefaultDataPoint<ChartType>>>;\n  chartOption$: Observable<ChartOptions<ChartType>>;\n\n  entityNamePropertyName?:string|null;\n\n  constructor(protected modelMgr:DontCodeModelManager, protected schemaMgr:DontCodeSchemaManager) {\n    super();\n    this.dataTransformer = new GraphDataTransformer(modelMgr);\n    this.chartData$ = this.dataTransformer.dataObservable();\n    this.chartOption$ = this.dataTransformer.optionObservable ();\n  }\n\n  providesTemplates(): TemplateList {\n    return new TemplateList(null, this.fullView, this.fullView);\n  }\n\n  canProvide(key?: string): PossibleTemplateList {\n    return new PossibleTemplateList(false, true, true);\n  }\n\n  override setValue(val: EntityListManager) {\n    super.setValue(val);\n    // We can directly receive the store instead of the array of values\n/*    if( (val!=null) && (val.entities!=null)) {\n      val = val.entities;\n    }*/\n    this.dataTransformer.updateSourceData(val);\n\n  }\n\n  initCommandFlow(provider: CommandProviderInterface, pointer: DontCodeModelPointer): void {\n    this.provider=provider;\n    this.graphModelPointer=pointer;\n\n    const json = this.provider.getJsonAt(pointer.position) as DontCodeReportDisplayType;\n    this.dataTransformer.setConfig(json);\n    this.type = this.dataTransformer.translatedGraphType ();\n    this.title = json.title;\n\n      // Try to guess the field of the target entity of the report that represents the name of the entity\n    const reportPosition = DontCodeModelPointer.parentPosition(this.graphModelPointer.containerPosition);\n    if (reportPosition  != null) {\n      const entity = this.modelMgr.findTargetOfProperty(DontCodeModel.APP_REPORTS_FOR_NODE, reportPosition);\n      if( (entity!=null) && (entity.value!=null)) {\n        this.entityNamePropertyName = this.modelMgr.guessNamePropertyOfElement(null, entity.value.fields);\n        // Gets the type information of the target field\n        if (json.of!=null) {\n          for (const field of Object.values<any>(entity.value.fields)) {\n            if( field[DontCodeModel.APP_FIELDS_NAME_NODE]==json.of) {\n              this.dataTransformer.setTargetType (field[DontCodeModel.APP_FIELDS_TYPE_NODE]);\n              break;\n            }\n          }\n        }\n      }\n      else {\n        this.entityNamePropertyName = null;\n      }\n    }\n    if( this.entityNamePropertyName!=null)\n      this.dataTransformer.setLabelFieldName (this.entityNamePropertyName);\n  }\n\n  handleChange(change: Change): void {\n      // We are changing the config\n    if (change.position==this.graphModelPointer?.position) {\n      if (change.type===ChangeType.DELETE) {\n        this.dataTransformer.setConfig();\n        this.type=undefined;\n      }else {\n        this.dataTransformer.setConfig(change.value as DontCodeReportDisplayType);\n        this.type = this.dataTransformer.translatedGraphType();\n      }\n    } else if (change.position==this.graphModelPointer?.position+'/'+DontCodeModel.APP_REPORTS_DISPLAY_TYPE_NODE) {\n      if (change.type===ChangeType.DELETE) {\n        this.dataTransformer.setConfig();\n        this.type=undefined;\n      }else {\n        this.dataTransformer.changeGraphType(change.value as string);\n        this.type = this.dataTransformer.translatedGraphType();\n      }\n    }\n  }\n\n}\n","<ng-template #fullView>\n  <p-chart *ngIf=\"type!==undefined\" [data]=\"chartData$ | async\" [options]=\"chartOption$ | async\" [type]=\"type!\" ></p-chart>\n  <ng-container *ngIf=\"type===undefined\">Please define a graph type</ng-container>\n</ng-template>\n","import {AfterViewInit, ChangeDetectorRef, Component, Injector, Optional, TemplateRef, ViewChild} from '@angular/core';\nimport {\n    ComponentLoaderService,\n    EntityListManager,\n    EntityStoreService,\n    PluginBaseComponent,\n    PossibleTemplateList,\n    SubFieldInfo,\n    TemplateList,\n    ValueService,\n} from '@dontcode/plugin-common';\nimport {\n    Change,\n    ChangeType,\n    CommandProviderInterface,\n    DontCodeEntityType,\n    DontCodeFieldType,\n    DontCodeModel,\n    DontCodeModelManager,\n    DontCodeModelPointer,\n    DontCodeReportGroupType,\n    DontCodeReportType,\n    DontCodeStorePreparedEntities,\n    dtcde\n} from '@dontcode/core';\nimport {CrossDataTransformer} from \"../cross-data-transformer\";\nimport formatters from \"chart.js/dist/core/core.ticks\";\n\n@Component({\n  selector: 'dontcode-report-entity',\n  templateUrl: './report-entity.component.html',\n  styleUrls: ['./report-entity.component.scss'],\n})\nexport class ReportEntityComponent extends PluginBaseComponent implements AfterViewInit {\n\n  @ViewChild('defaultdisplay')\n  private defaultTemplate!: TemplateRef<any>;\n\n  title=\"No Title\";\n\n  store:EntityListManager|null=null;\n  dataLoading = false;\n  reportDescription:DontCodeReportType|null=null;\n  reportEntityData = new DontCodeStorePreparedEntities<never> ([]);\n  targetEntityPointer: DontCodeModelPointer|null=null;\n  fieldTypeTransformer: CrossDataTransformer|null=null;\n\n  constructor(loader: ComponentLoaderService, protected entityService:EntityStoreService, protected valueService: ValueService, injector: Injector, ref: ChangeDetectorRef\n    ,@Optional() protected modelMgr:DontCodeModelManager) {\n    super(loader, injector, ref);\n    if (this.modelMgr==null)  // Sometimes it's not injected...\n      this.modelMgr=dtcde.getModelManager();\n  }\n\n  override initCommandFlow(\n    provider: CommandProviderInterface,\n    pointer: DontCodeModelPointer\n  ): any {\n    super.initCommandFlow(provider, pointer);\n\n    if (!this.entityPointer)\n      throw new Error(\n        'Cannot listen to changes without knowing a base position'\n      );\n    this.reportDescription=provider.getJsonAt(this.entityPointer.position) as DontCodeReportType;\n    this.initTargetEntity ();\n    this.decomposeJsonToMultipleChanges(\n      this.entityPointer,\n      this.reportDescription\n    ); // Dont provide a special handling for initial json, but emulate a list of changes\n    this.initChangeListening(true); // Listen to all changes made in the report definition\n  }\n\n  protected initTargetEntity ():void {\n    if( this.entityPointer==null)\n      return;\n    const targetInfo = this.valueService.findTargetOfProperty(\"for\", this.entityPointer.position);\n\n    if ((targetInfo!=null)&& (this.provider!=null)) {\n      this.targetEntityPointer=this.provider.getSchemaManager().generateSchemaPointer(targetInfo.pointer);\n      this.store = this.entityService.retrieveListManager(this.targetEntityPointer, this.valueService.findAtPosition(targetInfo.pointer, false));\n      this.pluginHelper.initOtherChangeListening(true, this.targetEntityPointer);\n    }\n\n  }\n\n  override ngAfterViewInit(): void {\n    super.ngAfterViewInit();\n    // When testing entityPointer is not defined\n    this.loadTargetEntities();\n  }\n\n  private loadTargetEntities() {\n    if ((this.entityPointer) && (this.provider)) {\n      if (this.store != null) {\n        this.dataLoading = true;\n        this.calculateTransformer ();\n        this.store.searchAndPrepareEntities(this.reportDescription?.sortedBy, this.reportDescription?.groupedBy, this.fieldTypeTransformer??undefined).then(() => {\n          // eslint-disable-next-line no-restricted-syntax\n          console.debug(\"Loaded entities\");\n          this.reportEntityData = this.store?.prepared ?? new DontCodeStorePreparedEntities<never>([]);\n          this.dataLoading = false;\n          this.updateSubFieldsValues();\n          this.ref.markForCheck();\n          this.ref.detectChanges();\n        }, reason => {\n          this.dataLoading = false;\n        });\n      }\n    } else {\n      throw new Error('Cannot create subcomponents before initCommandFlow is called');\n    }\n  }\n\n  protected updateSubFieldsValues (): void {\n    for (const field of this.fields) {\n      if( field.component!=null) {\n        field.component.setValue(this.store);\n      }\n    }\n  }\n\n  providesTemplates(key?: string): TemplateList {\n    throw new Error('Method not implemented.');\n  }\n  canProvide(key?: string): PossibleTemplateList {\n    throw new Error('Method not implemented.');\n  }\n\n  override setValue(val: any) {\n    // Just ignore it\n    // eslint-disable-next-line no-restricted-syntax\n    console.debug(\"setValue() called for ReportEntity\");\n  }\n\n  override getValue(): any {\n    // Just ignore as well\n    // eslint-disable-next-line no-restricted-syntax\n    console.debug(\"getValue() called for ReportEntity\");\n    return undefined;\n  }\n\n\n  handleChange(change: Change): void {\n    if (change?.pointer?.positionInSchema === DontCodeModel.APP_REPORTS_DISPLAY) {\n      this.updateSubFieldsWithChange(change, DontCodeModel.APP_REPORTS_DISPLAY_NODE).then(value => {\n        if (value != null) {\n          this.updateSubFieldsValues();\n          this.ref.markForCheck();\n          this.ref.detectChanges();\n        }\n      }).catch(reason => {\n        console.error(reason);\n      })\n    } else if (change?.pointer?.positionInSchema === DontCodeModel.APP_REPORTS_TITLE) {\n      switch (change.type) {\n        case ChangeType.DELETE:\n          this.title='';\n          break;\n        default:\n          this.title = change.value;\n      }\n    } else if ((this.targetEntityPointer!=null) && (change?.pointer?.isSubItemOf(this.targetEntityPointer)!=null)) {\n      // A change has been made in the entity itself\n      this.loadTargetEntities();\n    }\n  }\n\n  override subFieldFullViewTemplate(subField: string | SubFieldInfo): TemplateRef<any> | null {\n    let ret = super.subFieldFullViewTemplate(subField);\n    if( ret==null)\n      ret = this.defaultTemplate;\n    return ret;\n  }\n\n  /**\n   * Some reports are based on columns instead of rows. So we must recalculate the loaded values\n   */\n  calculateTransformer (): void {\n    this.fieldTypeTransformer=null;\n    if ((this.reportDescription!=null)&& (this.targetEntityPointer!=null) && (this.provider!=null)) {\n        // Is the report based on type of columns ?\n      if (this.reportDescription.groupedBy!=null) {\n        const groupByColumn = Object.values(this.reportDescription.groupedBy)[0]?.of;\n        if( groupByColumn!=null) {\n          // Is it an existing entity property or a column type name ?\n          const entityDesc = this.valueService.findAtPosition(this.targetEntityPointer.position, false) as DontCodeEntityType;\n          if (entityDesc.fields!=null) {\n            const columnNames=new Array<string>();\n            for (const field of Object.values(entityDesc.fields) as DontCodeFieldType[]) {\n              if (field.name == groupByColumn) {\n                // We found the column for the groupby, so nothing to do\n                return;\n              } else {\n                if (field.type == groupByColumn) {\n                  columnNames.push(field.name);\n                }\n              }\n            }\n\n            // Did we find columns ?\n            if (columnNames.length!=0) {\n              // Yes ! Let's groupBy these columns then\n              this.fieldTypeTransformer=new CrossDataTransformer<never>(\n                this.modelMgr, columnNames,\n                Object.values(this.reportDescription.groupedBy)[0] as DontCodeReportGroupType, this.targetEntityPointer);\n            }\n\n          }\n        }\n      }\n    }\n  }\n\n}\n\n","<dtcde-dynamic></dtcde-dynamic>\n<h1>Report {{title}}</h1>\n<div class=\"p-fluid\">\n  <div class=\"field grid\" *ngFor=\"let field of getSubFields()\">\n    <div *ngIf=\"field.type==='Table'\" class=\"col-12\">\n      <ng-container *ngTemplateOutlet=\"subFieldFullViewTemplate(field); context:{ fieldType:field.type}\"></ng-container>\n    </div>\n    <div *ngIf=\"field.type!=='Table'\" class=\"col-12 md:col-6\">\n      <ng-container *ngTemplateOutlet=\"subFieldFullViewTemplate(field); context:{ fieldType:field.type}\"></ng-container>\n    </div>\n  </div>\n</div>\n\n<ng-template #defaultdisplay let-type=\"fieldType\">\n  <div class=\"col-12 md:col-10\">\n    No components for {{type}}\n  </div>\n</ng-template>\n","import {ChangeDetectorRef, Component, Injector, TemplateRef, ViewChild} from '@angular/core';\nimport {\n  Change,\n  ChangeType,\n  CommandProviderInterface,\n  DontCodeGroupOperationType,\n  DontCodeModel,\n  DontCodeModelPointer,\n  DontCodeSchemaManager,\n  DontCodeStoreGroupedByValues,\n  dtcde\n} from \"@dontcode/core\";\nimport {\n  ComponentLoaderService,\n  DynamicComponent,\n  EntityListManager,\n  PluginBaseComponent,\n  PossibleTemplateList,\n  TemplateList,\n  ValueService\n} from \"@dontcode/plugin-common\";\n\n@Component({\n  selector: 'dontcode-report-table',\n  templateUrl: './report-table.component.html',\n  styleUrls: ['./report-table.component.scss'],\n})\nexport class ReportTableComponent extends PluginBaseComponent {\n  @ViewChild('fullView', {static: true})\n  private fullView!: TemplateRef<any>;\n\n  cols = new Array<PrimeColumn>();\n  colsMap = new Map<string, number>();\n\n  title=\"\";\n\n  override value: EntityListManager<any>|null = null;\n\n  targetEntityPointer: DontCodeModelPointer | null = null;\n  reportPointer:DontCodeModelPointer|null=null;\n  cleanedTableData: any[]=[];\n\n  entityNamePropertyName?:string|null;\n  groupRowsBy: string | undefined;\n  groupedValuesByField= new Map<any, Map<any, DontCodeStoreGroupedByValues[]>>();\n\n  constructor(protected valueService:ValueService, protected schemaMgr:DontCodeSchemaManager, protected loader:ComponentLoaderService, protected ref:ChangeDetectorRef, protected injector:Injector) {\n    super(loader, injector, ref);\n    if (this.schemaMgr==null)\n      this.schemaMgr=dtcde.getSchemaManager();\n  }\n\n  providesTemplates(): TemplateList {\n    return new TemplateList(null, this.fullView, this.fullView);\n  }\n\n  canProvide(key?: string): PossibleTemplateList {\n    return new PossibleTemplateList(false, true, true);\n  }\n\n  override initCommandFlow(\n    provider: CommandProviderInterface,\n    pointer: DontCodeModelPointer\n  ): any {\n\n    super.initCommandFlow(provider, pointer);\n    if (!this.entityPointer)\n      throw new Error(\n        'Cannot listen to changes without knowing a base position'\n      );\n\n    this.reportPointer=this.entityPointer.parentPointer(this.schemaMgr)?.parentPointer(this.schemaMgr)??null;\n    if (this.reportPointer!=null) {\n      const targetInfo = this.valueService.findTargetOfProperty(\"for\", this.reportPointer.position);\n\n      if (targetInfo!=null) {\n        this.targetEntityPointer=this.schemaMgr.generateSchemaPointer(targetInfo.pointer);\n        this.pluginHelper.initOtherChangeListening(true, this.targetEntityPointer.subPropertyPointer(DontCodeModel.APP_FIELDS_NODE));\n        this.decomposeJsonToMultipleChanges(\n          this.targetEntityPointer,\n          targetInfo.value\n        ); // Dont provide a special handling for initial json, but emulate a list of changes\n      }\n    }\n\n    this.initChangeListening(true); // Listen to all changes occuring after report display definition\n    this.decomposeJsonToMultipleChanges(\n      this.entityPointer,\n      this.provider?.getJsonAt(this.entityPointer.position)\n    ); // Dont provide a special handling for initial json, but emulate a list of changes\n  }\n\n  templateOf(col: PrimeColumn, value: any): TemplateRef<any> {\n    if (col.component!=null) {\n      col.component.setValue(value);\n      const ref = col.component.providesTemplates(col.type).forInlineView;\n      if (ref) return ref;\n    }\n    throw new Error('No component or template to display ' + col.type);\n  }\n\n  override setValue(val: EntityListManager<any>) {\n    super.setValue(val);\n    if( val.entities!=null)\n      this.cleanedTableData=val.entities;\n    else\n      this.cleanedTableData=[];\n    this.calculateGroupedValuesByField ();\n  }\n    /**\n   * Make the appropriate display updates whenever a change is received\n   * @param change\n   */\n  override handleChange(change: Change) {\n    //console.log(\"Changed Entity\",change.position);\n\n        // We only care when a field has been modified\n    if (this.targetEntityPointer?.subPropertyPointer(DontCodeModel.APP_FIELDS_NODE).isParentOf(change.position, true)) {\n      // Columns have been changed\n      this.applyUpdatesToArrayAsync(\n        this.cols,\n        this.colsMap,\n        change,\n        null,\n        (position, value) => {\n          return this.loadSubComponent(position, value.type, value.name).then((component) => {\n            const ret = new PrimeColumn(value.name, value.name, value.type);\n            if (component) {\n              // Keep the component only if it provides the view template\n              if (component.canProvide(value.type).forInlineView) {\n                ret.component = component;\n                this.applyComponentToSubField(component, value.type, value.name);\n              }\n            }\n            return ret;\n          });\n        },\n        this.targetEntityPointer?.subPropertyPointer(DontCodeModel.APP_FIELDS_NODE).position\n      ).then((updatedColumns) => {\n\n        this.cols = updatedColumns;\n        //  this.reloadData ();\n        this.ref.markForCheck();\n        this.ref.detectChanges();\n      });\n    } else if (this.entityPointer!=null) {\n\n        // The user changed the table values itself\n      if (change.pointer?.isSubItemOf(this.entityPointer)==='title') {\n        // We have changed the grouping\n        if( change.type==ChangeType.DELETE) {\n          this.title='';\n        }else {\n          this.title=change.value;\n        }\n\n\n      }\n    }\n  }\n\n  /**\n   * Ease the display of grouped values by mapping them per column\n   */\n  calculateGroupedValuesByField () {\n    this.groupedValuesByField.clear();\n    if (this.value?.prepared?.groupedByEntities?.values!=null) {\n      this.groupRowsBy=this.value?.prepared.groupedByEntities.groupInfo.of;\n        // In case of special column is created to enable filtering\n      if (this.value?.prepared.groupedByEntities.groupInfo.show!=null) {\n        this.groupRowsBy=this.value?.prepared.groupedByEntities.groupInfo.show.valueOf();\n      }\n\n      for (const groupKey of this.value.prepared.groupedByEntities.values.keys()) {\n        const values=this.value.prepared.groupedByEntities.values.get(groupKey)??[];\n        for (const value of values) {\n          let listOfValues = this.groupedValuesByField.get(groupKey)?.get(value.forAggregate.of);\n          if( listOfValues==null) {\n            listOfValues=new Array <DontCodeStoreGroupedByValues>();\n            let groupDelimiter=this.groupedValuesByField.get(groupKey);\n            if (groupDelimiter==null) {\n              groupDelimiter = new Map<any, DontCodeStoreGroupedByValues[]>();\n              this.groupedValuesByField.set(groupKey, groupDelimiter);\n            }\n            groupDelimiter.set(value.forAggregate.of, listOfValues);\n          }\n        listOfValues.push(value);\n        }\n      }\n    }\n  }\n\n  retrieveGroupedByValuesFor(groupingValue: any, field:string): DontCodeStoreGroupedByValues[] {\n    const ret= this.groupedValuesByField.get(groupingValue)?.get(field);\n    if (ret!=null)\n      return ret;\n    else\n      return [];\n  }\n\n  isTemplate(col: PrimeColumn, operation: DontCodeGroupOperationType):boolean {\n    if( (col.component==null) || (operation==DontCodeGroupOperationType.Count))\n      return false;\n    else\n      return true;\n  }\n\n  areGroupsDefined():boolean {\n    return (this.groupRowsBy!=null);\n  }\n}\n\n\nclass PrimeColumn {\n  field: string;\n  header: string;\n  type: string;\n  component: DynamicComponent | null;\n\n  constructor(field: string, header: string, type: string) {\n    this.field = field;\n    this.header = header;\n    this.type = type;\n    this.component = null;\n  }\n}\n","<dtcde-dynamic></dtcde-dynamic>\n<ng-template #fullView>\n  <p-table [value]=\"cleanedTableData\" [columns]=\"cols\" rowGroupMode=\"subheader\" [groupRowsBy]=\"groupRowsBy\">\n    <ng-template pTemplate=\"header\" let-columns>\n      <tr>\n        <th id=\"header-{{col.header}}\" *ngFor=\"let col of columns\" [pSortableColumn]=\"col.field\">\n          {{col.header}} <p-sortIcon [field]=\"col.field\"></p-sortIcon>\n        </th>\n      </tr>\n    </ng-template>\n    <ng-template pTemplate=\"body\" let-rowData let-columns=\"columns\">\n      <tr>\n        <td *ngFor=\"let col of columns\">\n          <ng-container *ngIf=\"col.component\">\n            <ng-container *ngTemplateOutlet=\"templateOf(col, rowData[col.field])\"></ng-container>\n          </ng-container>\n          <ng-container *ngIf=\"!col.component\"><span pTooltip=\"{{rowData[col.field] | beautifier}}\">{{rowData[col.field] | beautifier : 50}}</span></ng-container>\n        </td>\n      </tr>\n    </ng-template>\n    <ng-template pTemplate=\"groupheader\" let-rowData let-columns=\"columns\">\n      <tr *ngIf=\"areGroupsDefined()\" pRowGroupHeader class=\"rowgroup-header font-bold\">\n        <td [colSpan]=\"columns.length\" ><span>{{rowData[groupRowsBy!]}}</span></td>\n      </tr>\n    </ng-template>\n    <ng-template pTemplate=\"groupfooter\" let-rowData let-columns=\"columns\">\n      <tr *ngIf=\"areGroupsDefined()\" class=\"rowgroup-footer font-italic\">\n        <td *ngFor=\"let col of columns\">\n          <ng-container *ngFor=\"let value of retrieveGroupedByValuesFor (rowData[groupRowsBy!], col.field)\">\n            <ng-container *ngIf=\"isTemplate(col, value.forAggregate.operation)\">\n              <div>{{value.forAggregate.operation.toString()}}:&nbsp;<ng-container *ngTemplateOutlet=\"templateOf(col, value.value)\"></ng-container></div>\n            </ng-container>\n            <ng-container *ngIf=\"!isTemplate(col, value.forAggregate.operation)\">\n              <div pTooltip=\"{{value.forAggregate.operation.toString()}}:&nbsp;{{value.value | beautifier}}\">{{value.forAggregate.operation.toString()}}:&nbsp;{{value.value | beautifier : 50}}</div>\n             </ng-container>\n          </ng-container>\n        </td>\n      </tr>\n    </ng-template>\n  </p-table>\n</ng-template>\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {ReportDisplayComponent} from './preview/report-display/report-display.component';\nimport {ReportEntityComponent} from './preview/report-entity/report-entity.component';\nimport {ReportPlugin} from './declaration/report-plugin';\nimport {dtcde} from '@dontcode/core';\nimport {PluginCommonModule} from '@dontcode/plugin-common';\nimport {ReactiveFormsModule} from '@angular/forms';\nimport {DropdownModule} from 'primeng/dropdown';\nimport {ChartModule} from 'primeng/chart';\nimport {TableModule} from 'primeng/table';\nimport {ReportTableComponent} from './preview/report-table/report-table.component';\nimport {TooltipModule} from \"primeng/tooltip\";\n\n@NgModule({\n  imports: [\n    CommonModule,\n    ReactiveFormsModule,\n    DropdownModule,\n    ChartModule,\n    PluginCommonModule.forRoot(),\n    TableModule,\n    TooltipModule\n  ],\n  declarations: [\n    ReportDisplayComponent,\n    ReportEntityComponent,\n    ReportTableComponent,\n  ],\n  id: 'dontcode-plugin/report', // A module containing previewer components must have an id to be found by the dont-code platform.\n})\nexport class ReportModule {\n  constructor() {\n    console.log('Report Plugin registering'); // Look for this log to make sure your plugin has been loaded\n    dtcde.registerPlugin(new ReportPlugin()); // When created a module must register to the platform.\n  }\n\n  // We declare the components referenced by the ReportPlugin configuration\n  exposedPreviewHandlers(): Map<string, any> {\n    return new Map<string, any>([\n      ['ReportEntityComponent', ReportEntityComponent],\n      ['ReportDisplayComponent', ReportDisplayComponent],\n      ['ReportTableComponent', ReportTableComponent],\n    ]);\n  }\n}\n\nexport * from './preview/report-display/report-display.component';\nexport * from './preview/report-table/report-table.component';\nexport * from './preview/report-entity/report-entity.component';\n","import {Plugin, DontCodeModel, PluginConfig, Core} from '@dontcode/core';\n\n/**\n * This plugin enables loading / saving entities from any rest services.\n */\nexport class RestPlugin implements Plugin\n{\n  getConfiguration(): PluginConfig {\n    return {\n      plugin: {\n        id: 'RestPlugin',\n        'display-name': 'A plugin for entities managed through Rest APIs .',\n        version: '1.0.0'\n      },\n      'schema-updates': [{\n        id: 'rest-source',\n        description: 'Add rest type of source',\n        changes: [{\n          location: {\n            parent: '#/$defs/source',\n            id: 'type'\n          },\n          update: {\n            enum: [\n              'Rest'\n            ]\n          },\n          props: {\n            url: {\n              type: 'string'\n            }\n          },\n          replace: false\n        }]\n      }],\n      'global-handlers': [\n        {\n          location: {\n            parent: DontCodeModel.ROOT+'/sources',\n            id: 'type',\n            values: ['Rest']\n          },\n          class: {\n            name: 'SourceHandler',\n            source: 'rest'\n          }\n        }\n        ]\n\n    }\n  }\n\n  pluginInit(dontCode: Core): void {\n    // Nothing to do\n  }\n}\n","import {\n  AbstractDontCodeStoreProvider,\n  DontCodeModel,\n  DontCodeModelManager,\n  DontCodeStoreCriteria,\n  dtcde,\n  StoreProviderHelper,\n  UploadedDocumentInfo\n} from \"@dontcode/core\";\nimport {lastValueFrom, Observable, throwError} from \"rxjs\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {map} from \"rxjs/operators\";\n\n\nexport class RestStoreProvider<T=never> extends AbstractDontCodeStoreProvider<T>{\n  modelMgr: DontCodeModelManager;\n\n  constructor(protected http:HttpClient) {\n    super();\n    this.modelMgr = dtcde.getModelManager();\n  }\n\n  override deleteEntity(position: string, key: any): Promise<boolean> {\n    return Promise.resolve(false);\n  }\n\n  override loadEntity(position: string, key: any): Promise<T | undefined> {\n    const entity = this.modelMgr.findAtPosition(position, false);\n    if (entity === null)  {\n      return Promise.reject(\"No entity found at position \"+position);\n    }\n\n    const config = this.modelMgr.findTargetOfProperty(DontCodeModel.APP_ENTITIES_FROM_NODE, position)?.value;\n\n    let loadUrl = config.url;\n    if (key!=null) {\n      try {\n        const targetUrl = new URL (config.url);\n        targetUrl.pathname=targetUrl.pathname+'/'+key;\n        loadUrl=targetUrl.toString();\n      } catch (wrongUrl) {\n        console.error(\"The url for loading the entity is incorrect\", config.url);\n        return Promise.reject(\"The url for loading the entity is incorrect:\"+ config.url);\n      }\n    }\n\n    const obs = this.http.get<T>(loadUrl, {observe:\"body\", responseType:\"json\"}).pipe(\n      map (value => {\n        if (Array.isArray(value)) {\n            throw new Error (\"When loading an entity, the returned value should be one element\");\n        } // Should be unique value\n        return value;\n      }),\n      map (value => {\n        StoreProviderHelper.cleanUpLoadedData([value], StoreProviderHelper.findSpecialFields(position, entity));\n        return value;\n      }))\n    return lastValueFrom(obs);\n  }\n\n  override searchEntities(position: string, ...criteria: DontCodeStoreCriteria[]): Observable<Array<T>> {\n    const entity = this.modelMgr.findAtPosition(position, false);\n    if (entity === null)  {\n      return throwError(() => {\n        return new Error (\"No entity found at position \"+position)\n      });\n    }\n\n    // Search for all the date fields as we will need to convert them:\n    const specialFields = StoreProviderHelper.findSpecialFields(position, entity);\n\n    const config = this.modelMgr.findTargetOfProperty(DontCodeModel.APP_ENTITIES_FROM_NODE, position)?.value;\n\n    return this.http.get(config.url, {observe:\"body\", responseType:\"json\"}).pipe(map(value => {\n      let ret:T[]=[];\n        // Check if the result is an array, otherwise try to find an array embedded in the result\n        if (Array.isArray(value)) {\n          ret= value as Array<T>;\n        } else {\n          let prop: keyof typeof value;\n          for (prop in value) {\n            if (Array.isArray(value[prop])) {\n              ret= (value[prop] as unknown as Array<T>);\n            }\n          }\n        }\n        return StoreProviderHelper.applyFilters(ret, ...criteria);\n      }\n    ),\n      map (result => {\n        StoreProviderHelper.cleanUpLoadedData(result, specialFields);\n        return result;\n      }));\n  }\n\n  storeEntity(position: string, entity: T): Promise<T> {\n    return Promise.reject(\"RestStoreProvider cannot store elements\");\n  }\n\n  canStoreDocument(position?: string): boolean {\n    return false;\n  }\n\n  storeDocuments(toStore: File[], position?: string): Observable<UploadedDocumentInfo> {\n    return throwError(() => {\n      return new Error ('Document storage is unsupported.');\n    });\n  }\n\n}\n","import {\n  Change,\n  ChangeType,\n  DontCodeModelManager,\n  DontCodeStoreManager,\n  dtcde,\n  StoreProviderHelper\n} from \"@dontcode/core\";\nimport {AbstractPluginHandler} from \"@dontcode/plugin-common\";\nimport {Injectable} from \"@angular/core\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {RestStoreProvider} from \"./rest-store-provider\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SourceHandler extends AbstractPluginHandler {\n\n  protected storeMgr:DontCodeStoreManager;\n  protected modelMgr:DontCodeModelManager;\n\n  constructor(protected httpClient:HttpClient) {\n    super();\n    this.storeMgr = dtcde.getStoreManager();\n    this.modelMgr = dtcde.getModelManager();\n    this.storeMgr.setProviderForSourceType(new RestStoreProvider(this.httpClient), 'Rest');\n  }\n\n  /**\n   * Update storeMgr with any changes done to Rest sources\n   * @param change\n   */\n  handleChange (change: Change ) : void {\n\n      // Clear the cache anytime the rest configuration changes\n    StoreProviderHelper.clearConfigCache();\n/*    if (change.pointer==null) {\n      console.log('Cannot handle source event ', change.position+' without the pointer');\n      return;\n    }\n    const  val = this.modelMgr.findAtPosition(change.getSafeParentPosition());\n    switch (change.type) {\n      case ChangeType.DELETE:\n        this.storeMgr.removeProviderForSourceType(val.name);\n        break;\n      case ChangeType.ADD:\n      case ChangeType.RESET:\n        this.storeMgr.setProviderForSourceType(new RestStoreProvider(val.url, this.httpClient), val.name);\n        break;\n      case ChangeType.MOVE:\n      case ChangeType.UPDATE:\n        this.storeMgr.setProviderForSourceType(new RestStoreProvider(val.url, this.httpClient ), val.name);\n        break;\n      default:\n        break;\n    }*/\n  }\n}\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {RestPlugin} from \"./declaration/rest-plugin\";\nimport {dtcde} from '@dontcode/core';\nimport {SourceHandler} from \"./preview/source/source-handler\";\n\n@NgModule({\n    imports: [CommonModule],\n  declarations: [],\n  id:'dontcode-plugin/rest' // A module containing previewer components must have an id to be found by the dont-code platform.\n})\nexport class RestModule {\n  constructor() {\n    console.log('Rest Plugin registering');   // Look for this log to make sure your plugin has been loaded\n    dtcde.registerPlugin(new RestPlugin());  // When created a module must register to the platform.\n  }\n\n  exposedPreviewHandlers(): Map<string, any> | null {\n    return new Map<string, any> ([['SourceHandler', SourceHandler]\n      ]);\n  }\n}\n\nexport * from './preview/source/rest-store-provider';\nexport * from './preview/source/source-handler';\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {dtcde, PluginModuleInterface} from \"@dontcode/core\";\nimport {BasicPlugin} from \"./declaration/basic-plugin\";\nimport {BasicEntityComponent} from './preview/entity/basic-entity.component';\nimport {TableModule} from \"primeng/table\";\nimport {ListEntityComponent} from './preview/entity/list-entity.component';\nimport {EditEntityComponent} from './preview/entity/edit-entity.component';\nimport {TabViewModule} from \"primeng/tabview\";\nimport {CheckboxModule} from \"primeng/checkbox\";\nimport {FormsModule, ReactiveFormsModule} from \"@angular/forms\";\nimport {InputNumberModule} from \"primeng/inputnumber\";\nimport {InputTextModule} from \"primeng/inputtext\";\nimport {ToolbarModule} from \"primeng/toolbar\";\nimport {ButtonModule} from \"primeng/button\";\nimport {BeautifierPipe, PluginCommonModule} from \"@dontcode/plugin-common\";\nimport {BasicFieldsComponent} from './preview/fields/basic-fields.component';\nimport {DontCodeApiStoreProvider} from \"./store/dont-code-api-store-provider\";\nimport {TimeFieldsComponent} from \"./preview/time/time-fields.component\";\nimport {WebFieldsComponent} from \"./preview/web/web-fields.component\";\nimport {CalendarModule} from \"primeng/calendar\";\nimport {TooltipModule} from \"primeng/tooltip\";\nimport {FileUploadModule} from \"primeng/fileupload\";\nimport {ConfirmDialogModule} from \"primeng/confirmdialog\";\nimport {InputTextareaModule} from \"primeng/inputtextarea\";\n\n@NgModule({\n  imports: [CommonModule, TableModule, TabViewModule, CheckboxModule, FormsModule, InputNumberModule, InputTextModule, ToolbarModule, ButtonModule, ReactiveFormsModule, CalendarModule, TooltipModule, FileUploadModule, ConfirmDialogModule,\n    PluginCommonModule.forRoot(), InputTextareaModule],\n  declarations: [BasicEntityComponent, ListEntityComponent, EditEntityComponent, BasicFieldsComponent, TimeFieldsComponent, WebFieldsComponent],\n  providers: [DontCodeApiStoreProvider],\n  id:'dontcode-plugin/basic'\n})\nexport class BasicModule implements PluginModuleInterface {\n  constructor() {\n    console.log(\"Basic Plugin registering\");\n    dtcde.registerPlugin(new BasicPlugin ());\n  }\n\n  // We declare the components\n  exposedPreviewHandlers(): Map<string, any> {\n        return new Map<string, any> ([['BasicEntityComponent', BasicEntityComponent],\n          ['BasicFieldsComponent', BasicFieldsComponent],\n          ['TimeFieldsComponent', TimeFieldsComponent],\n          ['WebFieldsComponent', WebFieldsComponent],\n          ['DontCodeApiStoreProvider', DontCodeApiStoreProvider]]);\n    }\n\n}\n\nexport * from './preview/entity/basic-entity.component';\nexport * from './preview/fields/basic-fields.component';\nexport * from './preview/time/time-fields.component';\nexport * from './preview/web/web-fields.component';\nexport * from './store/dont-code-api-store-provider';\n","import {Plugin, DontCodeModel, PluginConfig, Core} from \"@dontcode/core\";\n\nexport class BasicPlugin implements Plugin {\n  getConfiguration(): PluginConfig {\n    return {\n      \"plugin\": {\n        \"id\": \"BasicPlugin\",\n        \"display-name\": \"Dont code plugin for all base elements\",\n        \"version\": \"1.0.0\"\n      },\n      \"schema-updates\": [{\n        \"id\": \"entity-all\",\n        \"description\": \"Screens to directly list, edit, remove entities\",\n        \"changes\": [{\n          \"location\": {\n            \"parent\": \"#/$defs\",\n            \"id\":\"entity\"\n          },\n          \"replace\": false\n        }]\n      },\n        {\n          \"id\": \"dont-code-storage\",\n          \"description\": \"Stores application data in Dont-code project storage\",\n          \"changes\": [{\n            \"location\": {\n              \"parent\": \"#/$defs/sharing\",\n              \"id\":\"with\"\n            },\n            \"replace\": false,\n            \"update\": {\n              \"enum\": [\n                \"Dont-code users\"\n              ]\n            }\n          }]\n        }],\n      \"preview-handlers\": [\n        {\n          location: {\n            parent: DontCodeModel.APP_ENTITIES,\n            id:''\n          },\n          class: {\n            name:\"BasicEntityComponent\",\n            source:\"basic\"\n          }\n        },\n        {\n          location: {\n            parent: DontCodeModel.APP_FIELDS,\n            id: 'type',\n            values: ['String', 'Number', 'Boolean']\n          },\n          class: {\n            name:'BasicFieldsComponent',\n            source:'basic'\n          }\n        },\n        {\n          location: {\n            parent: DontCodeModel.APP_FIELDS,\n            id: 'type',\n            values: ['Date', 'Date & Time', 'Time']\n          },\n          class: {\n            name:'TimeFieldsComponent',\n            source:'basic'\n          }\n        },\n        {\n          location: {\n            parent: DontCodeModel.APP_FIELDS,\n            id: 'type',\n            values: ['Website (url)', 'Image']\n          },\n          class: {\n            name:'WebFieldsComponent',\n            source:'basic'\n          }\n        },\n        {\n          location: {\n            parent: DontCodeModel.APP_SHARING,\n            id: 'with',\n            values: ['Dont-code users']\n          },\n          class: {\n            name:'DontCodeApiStoreProvider',\n            source:'basic'\n          }\n        }\n      ]\n    }\n  }\n\n  pluginInit(dontCode: Core): void {\n    // Nothing to do here\n  }\n\n}\n","import {Plugin, DontCodeModel, PluginConfig, Core} from '@dontcode/core';\n\nexport class FieldsPlugin implements Plugin\n{\n  getConfiguration(): PluginConfig {\n    return {\n      plugin: {\n        id: 'FieldsPlugin',\n        'display-name': 'Dont code plugin for specific fields like country, currency',\n        version: '1.0.0'\n      },\n      'schema-updates': [{\n        id: 'country-type',\n        description: 'Add Country as a type of field',\n        changes: [{\n          location: {\n            parent: '#/$defs/field',\n            id: 'type'\n          },\n          update: {\n            enum: [{\n              Social: {\n                enum: [\n                  'Rating'\n                  ]\n              }\n            }\n            ]\n          },\n          replace: false\n        }]\n      }],\n      'preview-handlers': [\n        {\n          location: {\n            parent: DontCodeModel.APP_FIELDS,\n            id: 'type',\n            values: [{\n              Social: {\n                enum: [\n                  'Rating'\n                ]\n              }\n            }]\n          },\n          class: {\n            name:'RatingComponent',\n            source:'fields'\n          }\n        },\n        {\n          location: {\n            parent: DontCodeModel.APP_FIELDS,\n            id: 'type',\n            values: [{\n              International: {\n                enum: [\n                  'Country'\n                ]\n              }\n            }]\n          },\n          class: {\n            name:'CountryComponent',\n            source:'fields'\n          }\n        },\n        {\n          location: {\n            parent: DontCodeModel.APP_FIELDS,\n            id: 'type',\n            values: [{\n              International: {\n                enum: [\n                  'Currency'\n                ]\n              }\n            }]\n          },\n          class: {\n            name:'CurrencyComponent',\n            source:'fields'\n          }\n        },\n        {\n          location: {\n            parent: DontCodeModel.APP_FIELDS,\n            id: 'type',\n            values: [{\n              Money: {\n                enum: [\n                  'Euro',\n                  'Dollar'\n                ]\n              }\n            }]\n          },\n          class: {\n            name:'EuroDollarComponent',\n            source:'fields'\n          }\n        },\n        {\n          location: {\n            parent: DontCodeModel.APP_FIELDS,\n            id: 'type',\n            values: [{\n              Money: {\n                enum: [\n                  'Other currency'\n                ]\n              }\n            }]\n          },\n          class: {\n            name:'MoneyComponent',\n            source:'fields'\n          }\n        }\n\n      ]\n    }\n  }\n\n  pluginInit(dontCode: Core): void {\n    // Nothing to do here\n  }\n\n}\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {dtcde, PluginModuleInterface} from '@dontcode/core';\nimport {FieldsPlugin} from './declaration/fields-plugin';\nimport { CountryComponent } from './preview/country/country.component';\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\nimport {DropdownModule} from 'primeng/dropdown';\nimport {PluginCommonModule} from '@dontcode/plugin-common';\nimport {CurrencyComponent} from './preview/currency/currency.component';\nimport {EuroDollarComponent} from './preview/money/euro-dollar.component';\nimport {MoneyComponent} from './preview/money/money.component';\nimport {InputNumberModule} from 'primeng/inputnumber';\nimport {RatingComponent} from \"./preview/rating/rating.component\";\nimport {RatingModule} from \"primeng/rating\";\nimport {HttpClientModule} from \"@angular/common/http\";\n\n@NgModule({\n  imports: [CommonModule,HttpClientModule,\n    ReactiveFormsModule, DropdownModule, PluginCommonModule, InputNumberModule, FormsModule, RatingModule],\n  declarations: [CountryComponent, CurrencyComponent, EuroDollarComponent, MoneyComponent, RatingComponent],\n  id:'dontcode-plugin/fields'\n})\nexport class FieldsModule implements PluginModuleInterface{\n  constructor() {\n    console.log('Fields Plugin registering');\n    dtcde.registerPlugin(new FieldsPlugin ());\n  }\n\n  // We declare the components\n  exposedPreviewHandlers(): Map<string, any> {\n    return new Map<string, any> ([\n      ['CountryComponent', CountryComponent],\n      ['CurrencyComponent', CurrencyComponent],\n      ['EuroDollarComponent', EuroDollarComponent],\n      ['MoneyComponent', MoneyComponent],\n      ['RatingComponent', RatingComponent]]);\n  }\n\n}\n\nexport * from './preview/country/country.component';\nexport * from './preview/currency/currency.component';\nexport * from './preview/money/money.component';\nexport * from './preview/money/euro-dollar.component';\nexport * from './preview/rating/rating.component';\n","import {Component, OnInit, TemplateRef, ViewChild} from '@angular/core';\nimport {AbstractDynamicComponent, PossibleTemplateList, TemplateList} from '@dontcode/plugin-common';\nimport * as i18nCountries from 'i18n-iso-countries';\nimport countryDataEn from 'i18n-iso-countries/langs/en.json'\n\n/**\n * Display or edit a country value\n */\n@Component({\n  selector: 'dontcode-fields-country',\n  templateUrl: './country.component.html',\n  styleUrls: ['./country.component.css']\n})\nexport class CountryComponent extends AbstractDynamicComponent implements OnInit{\n  @ViewChild('inlineView',{static:true})\n  private inlineView!: TemplateRef<any>;\n\n  @ViewChild('fullEditView',{static:true})\n  private fullEditView!: TemplateRef<any>;\n\n  countries = new Array<{ name:string, alpha2code:string }>();\n//  selectedCountry;\n\n  ngOnInit(): void {\n    i18nCountries.registerLocale(countryDataEn);\n\n    for (const alpha2 in i18nCountries.getAlpha2Codes()) {\n      this.countries.push({name:i18nCountries.getName(alpha2,'en')||alpha2, alpha2code: alpha2});\n    }\n  }\n\n  providesTemplates (): TemplateList {\n    return new TemplateList(this.inlineView, null, this.fullEditView);\n  }\n\n  canProvide(key?: string): PossibleTemplateList {\n    return new PossibleTemplateList(true, false, true);\n  }\n\n}\n","<ng-template #inlineView ><span class=\"flag-icon\" [ngClass]=\"'flag-icon-'+value?.toLowerCase()\"></span>{{value}}</ng-template>\n<ng-template #fullEditView>\n  <ng-container [formGroup]=\"form\">\n    <p-dropdown [options]=\"countries\" [formControlName]=\"name\" optionLabel=\"name\" optionValue=\"alpha2code\" [filter]=\"true\" filterBy=\"name\" [showClear]=\"true\" placeholder=\"Select a Country\">\n      <ng-template pTemplate=\"selectedItem\">\n        <div *ngIf=\"form.controls[name].value\">\n          <span class=\"flag-icon\" [ngClass]=\"'flag-icon-'+form.controls[name].value?.toLowerCase()\"></span>\n          {{form.controls[name].value}}\n        </div>\n      </ng-template>\n      <ng-template let-country pTemplate=\"item\">\n        <span class=\"flag-icon\" [ngClass]=\"'flag-icon-'+country?.alpha2code.toLowerCase()\"></span>\n        {{country.name}}\n      </ng-template>\n    </p-dropdown>\n  </ng-container></ng-template>\n","import {Component, TemplateRef, ViewChild} from '@angular/core';\nimport {AbstractDynamicComponent, PossibleTemplateList, TemplateList} from '@dontcode/plugin-common';\nimport country from 'all-country-data';\n\n/**\n * Display or edit a country value\n */\n@Component({\n  selector: 'dontcode-fields-currency',\n  templateUrl: './currency.component.html',\n  styleUrls: ['./currency.component.css']\n})\nexport class CurrencyComponent extends  AbstractDynamicComponent{\n  @ViewChild('inlineView',{static:true})\n  private inlineView!: TemplateRef<any>;\n\n  @ViewChild('fullEditView',{static:true})\n  private fullEditView!: TemplateRef<any>;\n\n  currencies = new Array<{ currency:string, currencyCode:string }>();\n\n  constructor() {\n    super();\n      // Prepare the list of currencies\n    const currencySet = new Map<string, string>();\n    country.countryCurrencyList().forEach((country: { currency: string; currency_code: string; }) => {\n      if ((country.currency && country.currency_code)) {\n        currencySet.set(country.currency, country.currency_code);\n      }\n    }); // Remove duplicates\n\n    this.currencies=[];\n    currencySet.forEach((code, key) => {\n      this.currencies.push({currency: key, currencyCode:code});\n    });\n\n    this.currencies = this.currencies.sort((a, b) => {\n      return a.currency.localeCompare( b.currency);\n    })\n  }\n\n  providesTemplates (): TemplateList {\n    return new TemplateList(this.inlineView, null, this.fullEditView);\n  }\n\n  canProvide(key?: string): PossibleTemplateList {\n    return new PossibleTemplateList(true, false, true);\n  }\n\n}\n","<ng-template #inlineView >{{value}}</ng-template>\n<ng-template #fullEditView>\n  <ng-container *ngIf=\"form\" [formGroup]=\"form\">\n    <p-dropdown [options]=\"currencies\" [formControlName]=\"name\" optionValue=\"currencyCode\" [filter]=\"true\" filterBy=\"currency\" [showClear]=\"true\" placeholder=\"Select a Currency\">\n      <ng-template pTemplate=\"selectedItem\">\n        <div *ngIf=\"form.controls[name].value\">\n          {{form.controls[name].value}}\n        </div>\n      </ng-template>\n      <ng-template let-currency pTemplate=\"item\">\n        {{currency.currency}} - {{currency.currencyCode}}\n      </ng-template>\n    </p-dropdown>\n  </ng-container></ng-template>\n","import {AfterViewInit, ChangeDetectionStrategy, ChangeDetectorRef, Component, Injector, ViewChild} from \"@angular/core\";\nimport {\n  Action,\n  ActionContextType,\n  ActionType,\n  Change,\n  CommandProviderInterface,\n  DontCodeModel,\n  DontCodeModelPointer,\n  PreviewHandler\n} from \"@dontcode/core\";\nimport {\n  ComponentLoaderService,\n  EntityListManager,\n  EntityStoreService,\n  PluginBaseComponent,\n  PossibleTemplateList,\n  TemplateList\n} from \"@dontcode/plugin-common\";\nimport {map} from \"rxjs/operators\";\nimport {ListEntityComponent} from \"./list-entity.component\";\nimport {EditEntityComponent} from \"./edit-entity.component\";\n\n\n@Component({\n  selector: 'dontcode-basic-entity',\n  templateUrl: './basic-entity.component.html',\n  styleUrls: ['./basic-entity.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class BasicEntityComponent extends PluginBaseComponent implements PreviewHandler, AfterViewInit {\n\n  entityName:string='';\n  selectedItem: any;\n  canSave = false;\n\n  store:EntityListManager<any>|null=null;\n\n  tabIndex = 0;\n\n  dataLoading = false;\n\n  @ViewChild(ListEntityComponent)\n  list!: ListEntityComponent;\n\n  @ViewChild(EditEntityComponent)\n  edit!: EditEntityComponent;\n\n  static readonly baseRefreshIcons='pi pi-refresh';\n  refreshIcon = BasicEntityComponent.baseRefreshIcons;\n\n  constructor(protected entityService:EntityStoreService, ref:ChangeDetectorRef, componentLoader: ComponentLoaderService, injector:Injector) {\n    super(componentLoader, injector, ref);\n  }\n\n\n  override initCommandFlow(provider: CommandProviderInterface, pointer: DontCodeModelPointer): any {\n    super.initCommandFlow(provider, pointer);\n    if( this.entityPointer) {\n      const json=provider.getJsonAt(this.entityPointer.position);\n      this.store = this.entityService.retrieveListManager(this.entityPointer, json);\n      this.decomposeJsonToMultipleChanges (this.entityPointer, json);\n    }\n    this.initChangeListening (); // Listen to name changes of this Entity\n  }\n\n  override ngAfterViewInit(): void {\n    // When testing entityPointer is not defined\n    if ((this.entityPointer)&&(this.provider)) {\n      this.list.initCommandFlow(this.provider, this.entityPointer.subPropertyPointer(DontCodeModel.APP_FIELDS_NODE));\n      this.edit.initCommandFlow(this.provider, this.entityPointer.subPropertyPointer(DontCodeModel.APP_FIELDS_NODE));\n      if( this.store!=null) {\n        //this.dataLoading=true;\n        this.store.loadAll().then (() => {\n          console.debug (\"Loaded entities\");\n          try {\n            this.list.dataIsLoaded();\n          } catch (e) {\n            console.debug(\"Just ignore errors when calling dataIsloaded\")\n          }\n          //this.dataLoading=false;\n          this.ref.markForCheck();\n          this.ref.detectChanges();\n        }, reason => {\n          //this.dataLoading=false;\n          this.ref.markForCheck();\n          this.ref.detectChanges();\n        });\n      }\n    } else {\n      throw new Error ('Cannot create subcomponents before initCommandFlow is called');\n    }\n    super.ngAfterViewInit();\n  }\n\n  protected override initChangeListening() {\n    super.initChangeListening();\n    if( this.provider) {\n      this.subscriptions.add(this.provider.receiveCommands(DontCodeModel.APP_SHARING_WITH).pipe(\n        map(change => {\n          if (this.store) {\n          console.debug(\"Reloading data due to change of StoreManager\");\n//          this.dataLoading=true;\n          this.store.reset();\n          this.store.loadAll().then (() => {\n            try {\n                this.list.dataIsLoaded();\n              } catch (e) {\n                  console.debug(\"Just ignore errors when calling dataIsloaded\")\n              }\n            //this.dataLoading=false;\n            this.ref.markForCheck();\n            this.ref.detectChanges();\n          }, reason => {\n            //           this.dataLoading=false;\n            this.ref.markForCheck();\n            this.ref.detectChanges();\n          })\n        } else {\n          console.error ('Cannot reload data because store is not set');\n          }\n        })).subscribe()\n      );\n    } else {\n      throw new Error('Cannot create subcomponents before initCommandFlow is called');\n    }\n  }\n\n  /**\n   * Make the appropriate display updates whenever a change is received\n   * @param change\n   * @protected\n   */\n  override handleChange (change: Change ) {\n    //console.log(\"Changed Entity\",change.position);\n    if( !change.pointer) {\n      if(this.provider) {\n        change.pointer=this.provider.calculatePointerFor(change.position);\n      }else {\n        throw new Error ('Cannot handle change with no pointer for position'+ change.position);\n      }\n    }\n    if( this.entityPointer) {\n      const prop = change.pointer.isUnderSubItemOf(this.entityPointer);\n      if( prop ) {\n        switch (prop) {\n          case     DontCodeModel.APP_ENTITIES_NAME_NODE:\n            this.entityName = change.value;\n            break;\n          default:\n            return;\n        }\n      }\n      this.ref.markForCheck();\n      this.ref.detectChanges();\n    } else {\n      throw new Error ('Need an entityPointer to handle change @'+change.position);\n    }\n  }\n\n  async selectChange($event: any) {\n//    console.log(\"Event:\", $event);\n    if ($event) {\n      // Load the details of the selected element\n      if( this.store!=null) {\n        await this.store.loadDetailOf ($event).then(newValue => {\n          if( newValue!=null) {\n            this.selectedItem=newValue;\n          }\n        }).catch(reason => {\n          console.error(\"Ignoring the failed loading of \"+$event._id+\" due to \", reason);\n        })\n      }\n      this.canSave=true;\n      this.tabIndex = 1;  // Automatically move to edit when selection is made\n    } else {\n      this.canSave=false;\n    }\n    this.ref.markForCheck();\n    this.ref.detectChanges();\n  }\n\n  async deleteEntity() {\n    if( (this.selectedItem) && (this.store)) {\n      await this.store.remove(this.selectedItem).then(deleted => {\n        this.selectedItem = null;\n        this.canSave=false;\n        this.tabIndex=0;\n        this.ref.markForCheck();\n        this.ref.detectChanges();\n      })\n    }\n  }\n\n  newEntity() {\n    const newEntity = {};\n    this.store?.push(newEntity);\n    this.selectedItem = newEntity;\n    this.canSave=true;\n    this.tabIndex = 1;\n  }\n\n  async saveEntity() {\n\n    if( this.selectedItem) {\n      this.canSave=false;\n      try {\n          // Ensure all fields are ok\n        //this.edit.form.updateValueAndValidity({onlySelf:true, emitEvent:false});\n        this.edit.getValue();\n        await this.store?.store (this.selectedItem).then(value => {\n          console.debug(\"Entity named \", this.entityName+\" with value \"+value, \" stored at position \"+this.entityPointer?.position);\n          this.selectedItem = value;\n          this.tabIndex=0;\n        }).catch(reason => {\n          console.error(\"Entity named \", this.entityName, \" not saved because of \",reason);\n        });\n      } finally {\n        this.canSave=true;\n        this.ref.markForCheck();\n        this.ref.detectChanges();\n      }\n    }\n  }\n\n  providesTemplates(): TemplateList {\n    return new TemplateList(null,null,null);\n  }\n\n  canProvide(key?: string): PossibleTemplateList {\n    return new PossibleTemplateList(false,false,false);\n  }\n\n  async refreshScreen():Promise<void> {\n    console.debug(\"Refresh called\");\n    if (this.entityPointer!=null) {\n      if (this.tabIndex==0) { // List\n        try {\n          this.refreshIcon=BasicEntityComponent.baseRefreshIcons+' pi-spin';\n          console.debug(\"Performing action\");\n          await this.pluginHelper.performAction (\n            new Action (this.entityPointer?.position,null, ActionContextType.LIST, ActionType.EXTRACT, this.entityPointer)\n          );\n\n          console.debug(\"Marking for Check\");\n          this.ref.markForCheck();\n          this.ref.detectChanges();\n\n          console.debug(\"Storing Changed values\");\n          await this.store?.storeAllChanged ();\n          console.debug(\"Stored values changed\");\n        } catch(reason) {\n          console.error (\"Error \",reason,\" performing refresh action on \",this.entityName, this.entityPointer);\n        } finally {\n          this.refreshIcon=BasicEntityComponent.baseRefreshIcons;\n          this.ref.markForCheck();\n          this.ref.detectChanges();\n        }\n      } else return Promise.reject('Not displaying the list');\n    } else return Promise.reject('No entityPointer');\n  }\n\n}\n","<h1>List of {{entityName}}</h1>\n<p-toolbar>\n  <ng-template pTemplate=\"left\">\n    <button name=\"new\" pButton icon=\"pi pi-plus\" class=\"p-button-rounded p-button-success p-mr-2\" (click)=\"newEntity()\" pTooltip=\"Create a new {{entityName}}.\" [disabled]=\"dataLoading\"></button>\n    <button name=\"delete\" pButton icon=\"pi pi-trash\" class=\"p-button-rounded p-button-warning\" (click)=\"deleteEntity()\"  pTooltip=\"Remove permanently the selected {{entityName}}.\" [disabled]=\"!selectedItem\"></button>\n    <i class=\"pi pi-minus p-mx-2\" style=\"font-size: 0.5rem\"></i>\n    <button name=\"refresh\" pButton [icon]=\"refreshIcon\" class=\"p-button-rounded p-button-warning\" (click)=\"refreshScreen()\" pTooltip=\"Refresh values of all {{entityName}}.\" [disabled]=\"dataLoading\"></button>\n    <button name=\"save\" pButton icon=\"pi pi-save\" class=\"p-button-rounded p-button-warning\" (click)=\"saveEntity()\" pTooltip=\"Saves permanently the selected {{entityName}}.\" [disabled]=\"!canSave\"></button>\n  </ng-template>\n</p-toolbar>\n<p-tabView [(activeIndex)]=\"tabIndex\">\n  <p-tabPanel header=\"List\">\n      <!-- Display an array of elements -->\n    <dontcode-list-entity [entities]=\"store?.entities??[]\" [(selectedItem)]=\"selectedItem\" (selectedItemChange)=\"selectChange($event)\" ></dontcode-list-entity>\n  </p-tabPanel>\n  <p-tabPanel header=\"Edit\" [disabled]=\"!selectedItem\">\n      <dontcode-edit-entity [value]=\"selectedItem\"></dontcode-edit-entity>\n  </p-tabPanel>\n</p-tabView>\n<p-toolbar>\n  <ng-template pTemplate=\"left\">\n    <button name=\"new-bottom\" pButton icon=\"pi pi-plus\" class=\"p-button-rounded p-button-success p-mr-2\" (click)=\"newEntity()\" pTooltip=\"Create a new {{entityName}}.\" [disabled]=\"dataLoading\"></button>\n    <button name=\"delete-bottom\" pButton icon=\"pi pi-trash\" class=\"p-button-rounded p-button-warning\" (click)=\"deleteEntity()\" pTooltip=\"Remove permanently the selected {{entityName}}.\" [disabled]=\"!selectedItem\"></button>\n    <i class=\"pi pi-minus p-mx-2\" style=\"font-size: 0.5rem\"></i>\n    <button name=\"refresh-bottom\" pButton [icon]=\"refreshIcon\" class=\"p-button-rounded p-button-warning\" (click)=\"refreshScreen()\" pTooltip=\"Refresh values of all {{entityName}}.\" [disabled]=\"dataLoading\"></button>\n    <button name=\"save-bottom\" pButton icon=\"pi pi-save\" class=\"p-button-rounded p-button-warning\" (click)=\"saveEntity()\" pTooltip=\"Saves permanently the selected {{entityName}}.\" [disabled]=\"!canSave\"></button>\n  </ng-template>\n</p-toolbar>\n","import {ChangeDetectorRef, Component, Injector, Input, OnInit, TemplateRef, ViewChild,} from '@angular/core';\nimport {Change, CommandProviderInterface, DontCodeModelPointer,} from '@dontcode/core';\nimport {\n  ComponentLoaderService,\n  PluginBaseComponent,\n  PossibleTemplateList, SubFieldInfo,\n  TemplateList,\n} from '@dontcode/plugin-common';\nimport {FormBuilder, FormGroup,} from '@angular/forms';\n\n@Component({\n  selector: 'dontcode-edit-entity',\n  templateUrl: './edit-entity.component.html',\n  styleUrls: ['./edit-entity.component.scss'],\n})\nexport class EditEntityComponent extends PluginBaseComponent implements OnInit {\n  @Input('value') set _value(newVal: any) {\n    this.setValue(newVal);\n  }\n\n  @ViewChild('defaulteditor')\n  private defaultTemplate!: TemplateRef<any>;\n\n  //initing = false;\n  //formConfig = {};\n\n  constructor(\n    ref: ChangeDetectorRef,\n    protected fb: FormBuilder,\n    injector: Injector,\n    componentLoader: ComponentLoaderService\n  ) {\n    super(componentLoader, injector, ref);\n  }\n\n  ngOnInit(): void {\n    this.form = this.fb.group({}, { updateOn: 'blur' });\n    this.updateValueOnFormChanges ();\n  }\n\n  override initCommandFlow(\n    provider: CommandProviderInterface,\n    pointer: DontCodeModelPointer\n  ): any {\n    //this.initing=true;\n    super.initCommandFlow(provider, pointer);\n\n    if (!this.entityPointer)\n      throw new Error(\n        'Cannot listen to changes without knowing a base position'\n      );\n    this.decomposeJsonToMultipleChanges(\n      this.entityPointer,\n      provider.getJsonAt(this.entityPointer.position)\n    ); // Dont provide a special handling for initial json, but emulate a list of changes\n    this.initChangeListening(true); // Listen to all changes occuring after entityPointer\n    //this.initing=false;\n    this.rebuildForm();\n  }\n\n  /**\n   * Updates the edit form whenever the fields of the entity are changed\n   * @param change\n   * @protected\n   */\n  override handleChange(change: Change) {\n    if (change.position !== this.entityPointer?.position) {\n      this.updateSubFieldsWithChange(change, null).then(value => {\n        if (value != null) {\n          this.ref.markForCheck();\n          this.ref.detectChanges();\n        }\n      })\n    }\n  }\n\n  providesTemplates(): TemplateList {\n    return new TemplateList(null, null, null);\n  }\n\n  canProvide(key?: string): PossibleTemplateList {\n    return new PossibleTemplateList(false, false, false);\n  }\n\n  templateOf(field: SubFieldInfo): TemplateRef<any> {\n    let ref = field.component?.providesTemplates(field.type).forFullEdit;\n    if (!ref) ref = this.defaultTemplate;\n\n    return ref;\n  }\n\n  override setForm(form: FormGroup) {\n    // Just ignore any form set\n    if (form) {\n      throw new Error(\n        'Trying to set a form to the Edit Entity component who already has one'\n      );\n    }\n  }\n\n  isShortText(fieldName: string): boolean {\n    const val = this.form.get(fieldName)?.value as string;\n    if( val!=null)\n      return val.length<50;\n    else\n      return true;\n  }\n\n  override getValue(): any {\n    return super.getValue();\n  }\n}\n","  <dtcde-dynamic></dtcde-dynamic>\n  <ng-container *ngIf=\"value\">\n    <form [formGroup]=\"form\">\n      <div class=\"formgrid grid\" *ngFor=\"let field of getSubFields()\">\n        <div class=\"field col-12\">\n          <label [for]=\"field.name\">{{field.name}}</label>\n          <div>\n            <ng-container *ngTemplateOutlet=\"templateOf(field); context:{ fieldName:field.name}\"></ng-container>\n          </div>\n        </div>\n    </div>\n    </form>\n</ng-container>\n\n<ng-template #defaulteditor let-name=\"fieldName\">\n  <ng-container [formGroup]=\"form\">\n    <ng-container *ngIf=\"isShortText(name); else smallText\"><input [name]=\"name\" [formControlName]=\"name\" pInputText class=\"w-full\" /></ng-container>\n    <ng-template #smallText><textarea [name]=\"name\" [formControlName]=\"name\" pInputTextarea [autoResize]=\"true\"></textarea> </ng-template>\n  </ng-container>\n</ng-template>\n","import {\n  ChangeDetectorRef,\n  Component,\n  EventEmitter,\n  Inject,\n  Injector,\n  Input,\n  OnInit,\n  Output,\n  TemplateRef,\n} from '@angular/core';\nimport {Action,\n  ActionHandler,\n  Change,\n  CommandProviderInterface,\n  DontCodeModelManager,\n  DontCodeModelPointer,\n  PreviewHandler,\n  dtcde,\n} from '@dontcode/core';\nimport {\n  ComponentLoaderService,\n  DynamicComponent,\n  EntityListManager,\n  PluginBaseComponent,\n  PossibleTemplateList,\n  TemplateList,\n} from '@dontcode/plugin-common';\nimport { SortEvent } from 'primeng/api';\n\n/**\n * Displays a read-only list of entity in a table.\n * Each field of the entity is a column and managed by one component only (we call setValue for each row we display)\n */\n@Component({\n  selector: 'dontcode-list-entity',\n  templateUrl: './list-entity.component.html',\n  styleUrls: ['./list-entity.component.scss'],\n})\nexport class ListEntityComponent\n  extends PluginBaseComponent\n  implements PreviewHandler, ActionHandler {\n  @Input()\n  selectedItem: any;\n\n  @Output()\n  selectedItemChange = new EventEmitter<any>();\n\n  cols = new Array<PrimeColumn>();\n  colsMap = new Map<string, number>();\n\n  @Input()\n  entities:any[] = [] ;\n\n  constructor(\n    ref: ChangeDetectorRef,\n    injector: Injector,\n    @Inject(ComponentLoaderService) componentLoader: ComponentLoaderService,\n    protected modelMgr: DontCodeModelManager\n  ) {\n    super(componentLoader, injector, ref);\n    if( this.modelMgr==null) this.modelMgr=dtcde.getModelManager(); // In case the injext did not work\n  }\n\n  selectionChange(event: any): void {\n    this.selectedItemChange.emit(event);\n  }\n\n  override initCommandFlow(\n    provider: CommandProviderInterface,\n    pointer: DontCodeModelPointer\n  ): any {\n    super.initCommandFlow(provider, pointer);\n\n    if (!this.entityPointer)\n      throw new Error(\n        'Cannot listen to changes without knowing a base position'\n      );\n    this.decomposeJsonToMultipleChanges(\n      this.entityPointer,\n      provider.getJsonAt(this.entityPointer.position)\n    ); // Dont provide a special handling for initial json, but emulate a list of changes\n    this.initChangeListening(true); // Listen to all changes occuring after entityPointer\n  }\n\n  /**\n   * Make the appropriate display updates whenever a change is received\n   * @param change\n   */\n  override handleChange(change: Change) {\n    //console.log(\"Changed Entity\",change.position);\n\n    if (change.position !== this.entityPointer?.position) {\n      // Columns have been changed\n      this.applyUpdatesToArrayAsync(\n        this.cols,\n        this.colsMap,\n        change,\n        null,\n        (position, value) => {\n          return this.loadSubComponent(position, value.type, value.name, this.provider?.getJsonAt(position.position)).then((component) => {\n            const ret = new PrimeColumn(value.name, value.name, value.type);\n            if (component) {\n              // Keep the component only if it provides the view template\n              if (component.canProvide(value.type).forInlineView) {\n                ret.component = component;\n                this.applyComponentToSubField(component, value.type, value.name);\n              }\n            }\n            return ret;\n          });\n        }\n      ).then((updatedColumns) => {\n\n        this.cols = updatedColumns;\n        //  this.reloadData ();\n        this.ref.markForCheck();\n        this.ref.detectChanges();\n      });\n    }\n  }\n\n  /**\n   * Runs the action on the subcomponents\n   * @param action\n   */\n  async performAction(action: Action): Promise<void> {\n    if (action.pointer==null)\n      return Promise.reject(\"No pointer for Action with position \"+action.position);\n      // It must point directly to the element\n    if (action.position == this.entityPointer?.position) {\n        // Update all columns\n      if (this.entities!=null) {\n        for (const colInfo of this.cols)\n          if ((colInfo.component as unknown as ActionHandler)?.performAction != null) {\n            for (const entity of this.entities) {\n              colInfo.component?.setValue(entity[colInfo.field]);\n              await (colInfo.component as unknown as ActionHandler).performAction (action);\n              }\n            }\n        }\n    }\n  }\n\n  retrieveColumnInfo (colName:string): PrimeColumn {\n    const index=this.colsMap.get(colName);\n    if( index!=null) {\n      return this.cols[index];\n    }else {\n      throw new Error (\"Cannot find column with name \"+colName);\n    }\n  }\n  providesTemplates(): TemplateList {\n    return new TemplateList(null, null, null);\n  }\n\n  canProvide(key?: string): PossibleTemplateList {\n    return new PossibleTemplateList(false, false, false);\n  }\n\n  templateOf(col: PrimeColumn, value: any): TemplateRef<any> {\n    if (col.component!=null) {\n      col.component.setValue(value);\n      const ref = col.component.providesTemplates(col.type).forInlineView;\n      if (ref) return ref;\n    }\n    throw new Error('No component or template to display ' + col.type);\n  }\n\n  getStoreEntities(): any[] {\n    if (this.entities != null) return this.entities;\n    else return [];\n  }\n\n  dataIsLoaded():void {\n    // Try to reduce the number of columns if some of them don't have values\n\n      let data = this.getStoreEntities();\n      if( data?.length > 0) {\n        const toRemove = new Array<string>();\n        toRemove.push(...this.cols.map(value => value.field));\n        let row=0;\n        while((toRemove.length>0) && (row<data.length)) {\n          for (let i=0;i<toRemove.length;i++) {\n            const fieldName = toRemove[i];\n            if (data[row][fieldName]!=null) {\n              toRemove.splice(i, 1);\n              i--;\n            }\n          }\n          row++;\n        }\n        // Let's remove some columns\n        if ((toRemove.length>0) && (toRemove.length<this.cols.length)) {\n          for (let colPos=0; colPos < this.cols.length;colPos++) {\n            let colName = this.cols[colPos].field;\n            if (toRemove.indexOf(colName) >=0) {\n              this.cols.splice(colPos, 1);\n              for (let entry of this.colsMap.entries()) {\n                if (entry[1]===colPos) {\n                  this.colsMap.delete(entry[0]);\n                  break;\n                }\n              }\n            }\n          }\n        }\n      }\n\n    }\n\n  customSort(event: SortEvent) {\n    if ((event.field!=null) && (event.data!=null)) {\n      this.modelMgr.sortValues (event.data, event.order, event.field);\n    }\n  }\n}\n\nclass PrimeColumn {\n  field: string;\n  header: string;\n  type: string;\n  component: DynamicComponent | null;\n\n  constructor(field: string, header: string, type: string) {\n    this.field = field;\n    this.header = header;\n    this.type = type;\n    this.component = null;\n  }\n}\n","<dtcde-dynamic></dtcde-dynamic>\n<p-table [columns]=\"cols\" [value]=\"getStoreEntities()\"\n         styleClass=\"p-datatable-striped\" responsiveLayout=\"scroll\"\n         selectionMode=\"single\" [(selection)]=\"selectedItem\" (selectionChange)=\"selectionChange($event)\"\n         (sortFunction)=\"customSort($event)\" [customSort]=\"true\">\n  <ng-template pTemplate=\"header\" let-columns>\n    <tr>\n      <th id=\"header-{{col.header}}\" *ngFor=\"let col of columns\" [pSortableColumn]=\"col.field\">\n        {{col.header}} <p-sortIcon [field]=\"col.field\"></p-sortIcon>\n      </th>\n    </tr>\n  </ng-template>\n  <ng-template pTemplate=\"body\" let-rowData let-columns=\"columns\">\n    <tr [pSelectableRow]=\"rowData\">\n      <td *ngFor=\"let col of columns\">\n        <ng-container *ngIf=\"col.component\">\n          <ng-container *ngTemplateOutlet=\"templateOf(col, rowData[col.field])\"></ng-container>\n        </ng-container>\n        <ng-container *ngIf=\"!col.component\"><span pTooltip=\"{{rowData[col.field] | beautifier}}\">{{rowData[col.field] | beautifier : 50}}</span></ng-container>\n      </td>\n    </tr>\n  </ng-template>\n</p-table>\n","import {Component, TemplateRef, ViewChild} from '@angular/core';\nimport {AbstractDynamicComponent, PossibleTemplateList, TemplateList} from \"@dontcode/plugin-common\";\nimport {FormControl, FormGroup} from \"@angular/forms\";\n\n@Component({\n  selector: 'plugins-basic-fields',\n  templateUrl: './basic-fields.component.html',\n  styleUrls: ['./basic-fields.component.css']\n})\nexport class BasicFieldsComponent extends AbstractDynamicComponent {\n\n  @ViewChild('INPUT')\n  private inputTemplate!: TemplateRef<any>;\n  @ViewChild('NUMERIC')\n  private numericTemplate!: TemplateRef<any>;\n  @ViewChild('CHECK')\n  private checkTemplate!: TemplateRef<any>;\n  @ViewChild('LIST_CHECK')\n  private listCheckTemplate!: TemplateRef<any>;\n\n  control = new FormControl(null, {updateOn:\"blur\"});\n\n  isJson=false;\n  type?:string;\n\n  override setForm(form: FormGroup) {\n    super.setForm(form);\n    this.form.registerControl(this.name, this.control);\n  }\n\n  providesTemplates(type:string): TemplateList {\n    if( this.type!=type) {\n      console.warn(\"BasicField Type is changed from \"+this.type+\" to \"+type);\n      this.type=type;\n    }\n    switch (type) {\n      case 'Number':\n        return new TemplateList(null, null,this.numericTemplate);\n      case 'Boolean':\n        return new TemplateList(this.listCheckTemplate, null, this.checkTemplate);\n      default:\n        return new TemplateList(null,null,this.inputTemplate);\n    }\n  }\n\n  canProvide(type?: string): PossibleTemplateList {\n    this.type=type;\n    return new PossibleTemplateList((type==='Boolean')?true:false, false, true);\n  }\n\n  override transformToFormGroupValue(val: any): any {\n    if( this.type==='Text') {\n      if( typeof val !== 'string') {\n        this.isJson=true;\n        return (val!=null)?JSON.stringify(val,null,2):val;\n      }\n    }\n    return super.transformToFormGroupValue(val);\n  }\n\n  override transformFromFormGroupValue(val: any): any {\n    if( this.isJson) {\n      try {\n        const ret=JSON.parse(val);\n        return ret;\n      } catch (error) {\n        console.error(\"Cannot convert field with name \"+this.name+\" from text String to an object\");\n      }\n    } else\n      return val;\n  }\n}\n","<ng-template #INPUT ><ng-container [formGroup]=\"form\"><input [name]=\"name\" [formControlName]=\"name\" pInputText /></ng-container></ng-template>\n<ng-template #NUMERIC ><ng-container [formGroup]=\"form\"><p-inputNumber [name]=\"name\" [formControlName]=\"name\" [showButtons]=\"true\"></p-inputNumber></ng-container></ng-template>\n<ng-template #CHECK ><ng-container [formGroup]=\"form\"><p-checkbox [name]=\"name\" [formControlName]=\"name\" [binary]=\"true\"></p-checkbox></ng-container></ng-template>\n<ng-template #LIST_CHECK><p-checkbox [readonly]=\"true\" [binary]=\"true\" [ngModel]=\"value\"></p-checkbox></ng-template>\n","import {MoneyAmount} from '@dontcode/core';\nimport {Component, TemplateRef, ViewChild} from '@angular/core';\nimport {AbstractDynamicComponent, PossibleTemplateList, TemplateList} from '@dontcode/plugin-common';\nimport {FormControl, FormGroup} from \"@angular/forms\";\n\n/**\n * EuroDollarComponent is just a specialized MoneyComponent to display only EUR or USD\n */\n@Component({\n  selector: 'dontcode-fields-eurodollar',\n  templateUrl: './euro-dollar.component.html',\n  styleUrls: ['./euro-dollar.component.css']\n})\nexport class EuroDollarComponent extends AbstractDynamicComponent{\n  @ViewChild('inlineView',{static:true})\n  private inlineView!: TemplateRef<any>;\n\n  @ViewChild('fullEditView',{static:true})\n  private fullEditView!: TemplateRef<any>;\n\n  override value = new MoneyAmount();\n\n  converter = Intl.NumberFormat(navigator.language, { style:'currency', currency:'EUR'});\n\n  constructor() {\n    super();\n  }\n\n  providesTemplates (key?:string): TemplateList {\n    switch (key) {\n      case 'Euro':\n      case 'Dollar':\n        this.value.currencyCode=(key==='Euro')?'EUR':'USD';\n        this.updateConverter ();\n        return new TemplateList (this.inlineView, null, this.fullEditView);\n      default:\n        return new TemplateList(null, null, null);\n    }\n  }\n\n  override setValue(val: any):void {\n    if (val==null) {\n      val = new MoneyAmount();\n      val.currencyCode=this.value.currencyCode;\n    } else {\n      if ((val.currencyCode!=this.value.currencyCode) && (this.value.currencyCode!=null)) {\n        console.warn (\"Setting currencyCode to \"+val.currencyCode+\" that is different from the component one (\"+this.value.currencyCode+\")\");\n      }\n    }\n    super.setValue(val);\n  }\n\n  canProvide(key?: string): PossibleTemplateList {\n    switch (key) {\n      case 'Euro':\n      case 'Dollar':\n        this.value.currencyCode=(key==='Euro')?'EUR':'USD';\n        this.updateConverter();\n        return new PossibleTemplateList(true, false, true);\n    }\n\n    return new PossibleTemplateList(false, false, false);\n  }\n\n  updateConverter (): void {\n    if (this.value?.currencyCode!=null)\n      this.converter =Intl.NumberFormat(navigator.language, { style:'currency', currency:this.value.currencyCode});\n  }\n\n  localizedAmount (amount?:number): string {\n    if( amount==null)\n      return this.value.currencyCode??\"\";\n    const ret= this.converter.format(amount);\n\n    /*const chars=[];\n    for (let i=0;i<ret.length;i++) {\n      chars.push(ret.charCodeAt(i));\n    }\n    console.log(\"Generated:\",ret, ...chars);\n*/\n    return ret;\n  }\n\n  override transformToFormGroupValue(val: any): any {\n    if (val?.amount==null) {\n      return null;\n    } else {\n      return val.amount;\n    }\n  }\n\n  override transformFromFormGroupValue(val: any): any {\n    this.value.amount=val;\n    return this.value;\n  }\n\n}\n","<ng-template #inlineView><span *ngIf=\"value?.amount\" class=\"numeric\">{{localizedAmount(value.amount)}}</span></ng-template>\n<ng-template #fullEditView>\n  <ng-container *ngIf=\"form\" [formGroup]=\"form!\">\n    <p-inputNumber *ngIf=\"value?.currencyCode\" mode=\"currency\" [currency]=\"value.currencyCode!\" [name]=\"name\" [formControlName]=\"name\"></p-inputNumber>\n  </ng-container>\n</ng-template>\n","import {ChangeDetectorRef, Component, Injector, TemplateRef, ViewChild} from '@angular/core';\nimport {MoneyAmount} from '@dontcode/core';\nimport {\n  AbstractDynamicLoaderComponent,\n  ComponentLoaderService, DynamicComponent,\n  PossibleTemplateList, SubFieldInfo,\n  TemplateList,\n} from '@dontcode/plugin-common';\nimport {FormControl} from '@angular/forms';\n\n/**\n * Display or edit a country value\n */\n@Component({\n  selector: 'dontcode-fields-money',\n  templateUrl: './money.component.html',\n  styleUrls: ['./money.component.css'],\n})\nexport class MoneyComponent extends AbstractDynamicLoaderComponent {\n  @ViewChild('inlineView', { static: true })\n  protected inlineView!: TemplateRef<any>;\n\n  @ViewChild('fullEditView', { static: true })\n  protected fullEditView!: TemplateRef<any>;\n\n  override value: MoneyAmount = new MoneyAmount();\n\n  converter: Intl.NumberFormat | null = null;\n\n  constructor(loaderService: ComponentLoaderService, injector: Injector, ref: ChangeDetectorRef ) {\n    super(loaderService, injector, ref);\n    // We use Dont-code framework to find the component that will manage the currency selection\n    this.defineSubField ('currencyCode', 'Currency');\n  }\n\n  override providesTemplates(key?: string): TemplateList {\n    return new TemplateList(this.inlineView, null, this.fullEditView);\n  }\n\n  override canProvide(key?: string): PossibleTemplateList {\n    return new PossibleTemplateList(true, false, true);\n  }\n\n  override createAndRegisterFormControls (): void {\n    this.form.registerControl('amount', new FormControl(null, {updateOn:\"blur\"}));\n  }\n\n  override loadSubField(subField: string | SubFieldInfo, type: string, subValue: any): Promise<DynamicComponent | null> {\n//    console.debug (\"Loading SubField \", subField);\n    return super.loadSubField(subField, type, subValue);\n  }\n\n  getAmountSafe(): number | undefined {\n    return this.value?.amount;\n  }\n\n  override setValue(val: any) {\n    if( val==null) {\n      val = new MoneyAmount();\n    }\n    super.setValue(val);\n    this.updateConverter();\n  }\n\n  updateConverter (): void {\n    if (this.value?.currencyCode!=null)\n      this.converter =Intl.NumberFormat(navigator.language, { style:'currency', currency:this.value.currencyCode});\n    else\n      this.converter = null;\n  }\n\n  localizedAmount (amount:number|undefined): string {\n    if( amount==null)\n      return this.value?.currencyCode??\"\";\n    if (this.converter!=null)\n      return this.converter?.format(amount);\n    else\n      return amount.toString();\n  }\n\n  override subFieldFullEditTemplate(subField: string | SubFieldInfo): TemplateRef<any> | null {\n    const ret= super.subFieldFullEditTemplate(subField);\n    return ret;\n  }\n\n}\n","<dtcde-dynamic></dtcde-dynamic>\n<ng-template #inlineView><span *ngIf=\"value?.currencyCode\" class=\"numeric\">{{localizedAmount(value.amount)}}</span></ng-template>\n<ng-template #fullEditView>\n  <ng-container *ngIf=\"form\" [formGroup]=\"form\">\n    <div class=\"grid\">\n      <div class=\"col-12 md:col-8\">\n        <p-inputNumber [name]=\"this.name\" formControlName=\"amount\" [minFractionDigits]=\"2\"></p-inputNumber>\n      </div>\n      <div class=\"col-12 md:col-4\">\n        <ng-container *ngTemplateOutlet=\"subFieldFullEditTemplate('currencyCode')\"></ng-container>\n      </div>\n    </div>\n  </ng-container>\n</ng-template>\n","import {Component, TemplateRef, ViewChild} from '@angular/core';\nimport {AbstractDynamicComponent, PossibleTemplateList, TemplateList} from '@dontcode/plugin-common';\n\n/**\n * Display or edit a country value\n */\n@Component({\n  selector: 'dontcode-fields-rating',\n  templateUrl: './rating.component.html',\n  styleUrls: ['./rating.component.css']\n})\nexport class RatingComponent extends AbstractDynamicComponent {\n  @ViewChild('inlineView',{static:true})\n  private inlineView!: TemplateRef<any>;\n\n  @ViewChild('fullEditView',{static:true})\n  private fullEditView!: TemplateRef<any>;\n\n  providesTemplates (): TemplateList {\n    return new TemplateList(this.inlineView, null, this.fullEditView);\n  }\n\n  canProvide(key?: string): PossibleTemplateList {\n    return new PossibleTemplateList(true, false, true);\n  }\n\n}\n","<ng-template #inlineView ><p-rating *ngIf=\"value\" [readonly]=\"true\" [ngModel]=\"value\" [cancel]=\"false\" iconOnClass=\"pi pi-star-fill\" iconOffClass=\"pi pi-star\"></p-rating></ng-template>\n<ng-template #fullEditView>\n  <ng-container *ngIf=\"form\" [formGroup]=\"form\">\n    <p-rating [readonly]=\"false\" [formControlName]=\"name\" iconOnClass=\"pi pi-star-fill\" iconOffClass=\"pi pi-star\"></p-rating>\n  </ng-container>\n</ng-template>\n","import {Component, TemplateRef, ViewChild} from '@angular/core';\nimport {AbstractDynamicComponent, PossibleTemplateList, TemplateList,} from '@dontcode/plugin-common';\nimport {FormGroup} from '@angular/forms';\n\n@Component({\n  selector: 'plugins-time-fields',\n  templateUrl: './time-fields.component.html',\n  styleUrls: ['./time-fields.component.css'],\n})\nexport class TimeFieldsComponent extends AbstractDynamicComponent {\n  @ViewChild('EDIT_DATE', { static: true })\n  private editDateTemplate!: TemplateRef<any>;\n  @ViewChild('READ_DATE', { static: true })\n  private readDateTemplate!: TemplateRef<any>;\n  @ViewChild('EDIT_DATE_TIME', { static: true })\n  private editDateTimeTemplate!: TemplateRef<any>;\n  @ViewChild('READ_DATE_TIME', { static: true })\n  private readDateTimeTemplate!: TemplateRef<any>;\n  @ViewChild('EDIT_TIME', { static: true })\n  private editTimeTemplate!: TemplateRef<any>;\n  @ViewChild('READ_TIME', { static: true })\n  private readTimeTemplate!: TemplateRef<any>;\n\n  longConverter = Intl.DateTimeFormat(navigator.language, { weekday:'long', day:'numeric', month:'long', year:'numeric', hour:'2-digit', minute:'2-digit', second:'2-digit', timeZoneName:'long'});\n  shortConverter = Intl.DateTimeFormat(navigator.language, { day:'2-digit', month:'2-digit', year:'numeric', hour:'2-digit', minute:'2-digit', second:'2-digit', timeZoneName:'short'});\n\n  providesTemplates(type: string): TemplateList {\n    this.updateConverters(type);\n    switch (type) {\n      case 'Date':\n        return new TemplateList(\n          this.readDateTemplate,\n          null,\n          this.editDateTemplate\n        );\n      case 'Date & Time':\n        return new TemplateList(\n          this.readDateTimeTemplate,\n          null,\n          this.editDateTimeTemplate\n        );\n      case 'Time':\n      default:\n        return new TemplateList(\n          this.readTimeTemplate,\n          null,\n          this.editTimeTemplate\n        );\n    }\n  }\n\n  updateConverters (type:string):void {\n    switch (type) {\n      case 'Date':\n        this.longConverter = Intl.DateTimeFormat(navigator.language, { weekday:'long', day:'numeric', month:'long', year:'numeric'});\n        this.shortConverter = Intl.DateTimeFormat(navigator.language, { day:'2-digit', month:'2-digit', year:'numeric'});\n        break;\n      case 'Date & Time':\n        this.longConverter = Intl.DateTimeFormat(navigator.language, { weekday:'long', day:'numeric', month:'long', year:'numeric', hour:'2-digit', minute:'2-digit', second:'2-digit', timeZoneName:'long'});\n        this.shortConverter = Intl.DateTimeFormat(navigator.language, { day:'2-digit', month:'2-digit', year:'numeric', hour:'2-digit', minute:'2-digit', second:'2-digit', timeZoneName:'short'});\n        break;\n      case 'Time':\n      default:\n        this.longConverter = Intl.DateTimeFormat(navigator.language, { hour:'2-digit', minute:'2-digit', second:'2-digit', timeZoneName:'long'});\n        this.shortConverter = Intl.DateTimeFormat(navigator.language, {hour:'2-digit', minute:'2-digit', second:'2-digit', timeZoneName:'short'});\n\n    }\n  }\n\n  localizeLongDate (value:Date): string {\n    return this.longConverter.format(value);\n  }\n\n  localizeShortDate (value:Date): string {\n    return this.shortConverter.format(value);\n  }\n\n  canProvide(type?: string): PossibleTemplateList {\n    switch (type) {\n      case 'Date':\n      case 'Date & Time':\n      case 'Time':\n        return new PossibleTemplateList(true, false, true);\n      default:\n        return new PossibleTemplateList(false, false, false);\n    }\n  }\n\n  /**\n   * By default, when you select a date in the dropdown, it won't update the reactive form. So we do it manually\n   * @param form\n   * @param event\n   */\n  dateSelected(form: FormGroup, event: any) {\n    // One have to trigger onBlur event as it's the only one listened to by the form...\n    console.log('Selection:', event);\n    const value: { [key: string]: any } = {};\n    const control = form.get(this.name);\n    if (control!=null) {\n      control.setValue(event);\n      control.markAsDirty();\n    } else {\n      console.error(\"Cannot set date of unknown form control with name \"+this.name);\n    }\n  }\n}\n","<ng-template #EDIT_DATE><ng-container [formGroup]=\"form\"><p-calendar [name]=\"name\" [formControlName]=\"name\" (onSelect)=\"dateSelected(form, $event)\"></p-calendar></ng-container></ng-template>\n<ng-template #EDIT_DATE_TIME><ng-container [formGroup]=\"form\"><p-calendar [name]=\"name\" [formControlName]=\"name\" (onSelect)=\"dateSelected(form, $event)\" [showTime]=\"true\"></p-calendar></ng-container></ng-template>\n<ng-template #EDIT_TIME><ng-container [formGroup]=\"form\"><p-calendar [name]=\"name\" [formControlName]=\"name\" (onSelect)=\"dateSelected(form, $event)\" [timeOnly]=\"true\"></p-calendar></ng-container></ng-template>\n<ng-template #READ_DATE><span pTooltip=\"{{this.localizeLongDate(value)}}\">{{this.localizeShortDate(value)}}</span></ng-template>\n<ng-template #READ_DATE_TIME><span pTooltip=\"{{this.localizeLongDate(value)}}\">{{this.localizeShortDate(value)}}</span></ng-template>\n<ng-template #READ_TIME><span pTooltip=\"{{this.localizeLongDate(value)}}\">{{this.localizeShortDate(value)}}</span></ng-template>\n","import {ChangeDetectorRef, Component, OnDestroy, Optional, TemplateRef, ViewChild} from '@angular/core';\nimport {AbstractDynamicComponent, PossibleTemplateList, TemplateList} from \"@dontcode/plugin-common\";\nimport {DontCodeStoreManager, dtcde} from \"@dontcode/core\";\nimport {map} from \"rxjs/operators\";\nimport {ConfirmationService} from \"primeng/api\";\nimport {FileUpload} from \"primeng/fileupload\";\n\n@Component({\n  selector: 'plugins-web-fields',\n  templateUrl: './web-fields.component.html',\n  styleUrls: ['./web-fields.component.css'],\n  providers: [ConfirmationService]\n})\nexport class WebFieldsComponent extends AbstractDynamicComponent implements OnDestroy{\n\n  @ViewChild('EDIT_URL',{static:true})\n  private editUrlTemplate!: TemplateRef<any>;\n  @ViewChild('READ_URL',{static:true})\n  private readUrlTemplate!: TemplateRef<any>;\n  @ViewChild('EDIT_IMAGE',{static:true})\n  private editImageTemplate!: TemplateRef<any>;\n  @ViewChild('READ_IMAGE',{static:true})\n  private readImageTemplate!: TemplateRef<any>;\n\n  @ViewChild(FileUpload)\n  private fileUpload!:FileUpload;\n\n  constructor(protected confirm:ConfirmationService, @Optional() protected storeMgr: DontCodeStoreManager, protected ref:ChangeDetectorRef) {\n    super();\n      // Hack for when DI doesn't find the storemanager due to mfe stuff\n    if (this.storeMgr==null) {\n      this.storeMgr = dtcde.getStoreManager();\n      console.warn(\"DontCodeStoreManager not found by Angular's Injector\");\n    }\n  }\n\n  providesTemplates(type:string): TemplateList {\n    switch (type) {\n      case 'Website (url)':\n        return new TemplateList(this.readUrlTemplate, null,this.editUrlTemplate);\n      case 'Image':\n      default:\n        return new TemplateList(this.readImageTemplate, null, this.editImageTemplate);\n    }\n  }\n\n  canProvide(type?: string): PossibleTemplateList {\n    switch (type) {\n      case 'Website (url)':\n      case 'Image':\n        return new PossibleTemplateList(true, false, true);\n      default:\n        return new PossibleTemplateList(false, false, false);\n    }\n  }\n\n  calculateUrl(url: string): string {\n    if (!url) return url;\n\n    if (url.includes('//')) {\n      url = url.substring(url.indexOf('//')+2);\n    }\n\n    if (url.length>20)\n      return url.substring(0, 17)+'...';\n    else\n      return url;\n  }\n\n  supportsImageUpload (): boolean{\n    return this.storeMgr.canStoreDocument (this.parentPosition||undefined);\n  }\n\n  uploadImage(event: any) {\n  /*  this.confirm.confirm({\n      header:'Confirm',\n      message: 'Uploading:'+JSON.stringify(event, null, 4),\n      accept: ()=>{*/\n        console.info(\"Uploading image\", event);\n        this.form.get(this.name)?.setValue(undefined);\n        this.value=null;\n        this.subscriptions.add(this.storeMgr.storeDocuments (event.files,this.parentPosition||undefined).pipe(map (loaded => {\n            console.debug(\"File uploaded:\", loaded.documentId);\n            this.form.get(this.name)?.setValue(loaded.documentId);\n            this.value=loaded.documentId;\n            return loaded;\n          })\n        ).subscribe({\n          /*next: (value) => {\n            this.confirm.confirm({\n              header: 'Uploaded',\n              message: 'Uploaded:'+JSON.stringify(value, null, 4)\n            });\n          },*/\n          error: (error)=> {\n            this.fileUpload.clear();\n            this.ref.markForCheck();\n            this.ref.detectChanges();\n            this.confirm.confirm({\n              header: 'Error',\n              message: 'Error:'+JSON.stringify(error, null, 4)\n            });\n          },\n          complete: () => {\n            this.fileUpload.clear();\n            this.ref.markForCheck();\n            this.ref.detectChanges();\n          }\n        }));\n\n //     }\n //   });\n  }\n\n}\n","<p-confirmDialog header=\"Error\" icon=\"pi pi-exclamation-triangle\"></p-confirmDialog>\n<ng-template #EDIT_URL><ng-container [formGroup]=\"form\"><input [name]=\"name\" [formControlName]=\"name\" pInputText class=\"w-full\"/></ng-container></ng-template>\n<ng-template #EDIT_IMAGE>\n  <ng-container [formGroup]=\"form\">\n    <div class=\"grid\">\n      <div class=\"col-2\">\n        <p-fileUpload *ngIf=\"supportsImageUpload()\" mode=\"basic\" chooseLabel=\"Browse\" [name]=\"name+'-img'\" [auto]=\"true\" [multiple]=\"false\" accept=\"image/*\" [customUpload]=\"true\" (uploadHandler)=\"uploadImage ($event)\"></p-fileUpload>\n      </div>\n      <div class=\"col-10\">\n        <input [name]=\"name\" [formControlName]=\"name\" pInputText class=\"w-full\" />\n      </div>\n    </div>\n  </ng-container>\n</ng-template>\n<ng-template #READ_URL><a [pTooltip]=\"value\" [href]=\"value\" target=\"_blank\">{{calculateUrl (value)}}</a></ng-template>\n<ng-template #READ_IMAGE><img class=\"inline-image\" [src]=\"value\" /></ng-template>\n","import {\n  AbstractDontCodeStoreProvider,\n  DontCodeModelManager,\n  DontCodeStoreCriteria,\n  dtcde,\n  StoreProviderHelper,\n  UploadedDocumentInfo\n} from \"@dontcode/core\";\nimport {lastValueFrom, Observable, Subscription, throwError} from \"rxjs\";\nimport {HttpClient, HttpHeaders} from \"@angular/common/http\";\nimport {Injectable, OnDestroy, Optional} from \"@angular/core\";\nimport {map, mergeAll} from \"rxjs/operators\";\nimport {CommonConfigService, CommonLibConfig} from \"@dontcode/plugin-common\";\n\n/**\n * A Store Provider that uses the DontCode API to store / read application data\n */\n@Injectable({\n  providedIn: 'root'\n})\nexport class DontCodeApiStoreProvider<T=never> extends AbstractDontCodeStoreProvider<T> implements OnDestroy {\n\n  apiUrl: string;\n  docUrl: string;\n  subscriptions = new Subscription();\n\n  constructor(protected http: HttpClient, @Optional() protected override modelMgr: DontCodeModelManager, protected configService: CommonConfigService) {\n    super();\n    this.apiUrl = 'https://test.dont-code.net/data';\n    this.docUrl = 'https://test.dont-code.net/documents';\n\n    this.updateConfig (this.configService.getConfig());\n    this.subscriptions.add (this.configService.getUpdates ().pipe (map ((updatedConfig) => {\n      this.updateConfig (updatedConfig);\n    })).subscribe());\n\n      // Hack for when DI cannot provide the ModelManager due to some weird stuff\n    if (this.modelMgr==null) {\n      this.modelMgr = dtcde.getModelManager();\n      console.warn(\"DontCodeModelManager not found by Angular's DI\");\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n\n  updateConfig(newConfig: Readonly<CommonLibConfig>) {\n    if (newConfig.storeApiUrl!=null)\n      this.apiUrl = newConfig.storeApiUrl;\n    if (newConfig.documentApiUrl!=null)\n      this.docUrl = newConfig.documentApiUrl;\n  }\n\n  storeEntity(position: string, data: T): Promise<T> {\n    const entity = this.modelMgr.findAtPosition(position, false);\n    if (entity === null)  {\n      return Promise.reject(\"No entity found at position \"+position);\n    }\n\n    const id=(data as any)._id;\n    if( id != undefined) {\n      return lastValueFrom(this.http.put<T>(this.apiUrl+'/'+entity.name+'/'+id, data, {observe:\"body\", responseType:\"json\"}));\n    } else {\n      return lastValueFrom(this.http.post<T>(this.apiUrl+'/'+entity.name, data, {observe:\"body\", responseType:\"json\"}));\n    }\n  }\n\n  loadEntity(position: string, key: any): Promise<T|undefined> {\n    const entity = this.modelMgr.findAtPosition(position, false);\n    if (entity === null)  {\n      return Promise.reject(\"No entity found at position \"+position);\n    }\n\n    const obs = this.http.get<T>(this.apiUrl+'/'+entity.name+'/'+key, {observe:\"body\", responseType:\"json\"});\n    return lastValueFrom(obs);\n  }\n\n  deleteEntity(position: string, key: any): Promise<boolean> {\n    const entity = this.modelMgr.findAtPosition(position, false);\n    if (entity === null)  {\n      return Promise.reject(\"No entity found at position \"+position);\n    }\n\n    return this.http.delete(this.apiUrl+'/'+entity.name+'/'+key, {observe:\"body\", responseType:\"json\"}).toPromise().then(value => {\n      return true;\n    });\n    }\n\n  override searchEntities(position: string, ...criteria: DontCodeStoreCriteria[]): Observable<T[]> {\n    const entity = this.modelMgr.findAtPosition(position, false);\n    if (entity === null)  {\n      return throwError(()=> new Error (\"No entity found at position \"+position));\n    }\n\n    return this.http.get(this.apiUrl+'/'+entity.name, {observe:\"body\", responseType:\"json\"}).pipe(map(value => {\n            return StoreProviderHelper.applyFilters( value as Array<any>, ...criteria);\n          }\n        ));\n    }\n\n  canStoreDocument(position?: string): boolean {\n    return true;\n  }\n\n  storeDocuments(toStore: File[], position?: string): Observable<UploadedDocumentInfo> {\n    const myFormData = new FormData();\n    const headers = new HttpHeaders();\n    headers.append('Content-Type', 'multipart/form-data');\n    headers.append('Accept', 'application/json');\n    let count=0;\n    // store files details into formdata\n    toStore.forEach( file => {\n      myFormData.append('document#'+count, file);\n      count++;\n    });\n    //HTTP Angular service, which will send call to Laravel API With headers and myformdata\n    return this.http.post<UploadedDocumentInfo[]>(this.docUrl, myFormData, { headers: headers }).pipe(\n      mergeAll ()\n    );\n  }\n\n}\n"],"names":["HttpClient","ChangeDetectorRef","Injector","Change","ChangeType","DontCodeModel","dtcde","CommonConfigService","DONT_CODE_CORE","LightAppComponent","environment","ChangeUpdateService","ProjectService","TextService","i0","elementStart","element","elementEnd","elementContainerStart","elementContainerEnd","AppComponent","constructor","configService","service","updateService","projectService","httpClient","injector","ref","dontCodeCore","title","defaultRepositoryUrl","runtimeConfig","window","dontCodeConfig","repositoryUrl","mainTab","location","hash","indexOf","afterInitialization","config","repoUrl","resetSchema","readSchema","getSchemaManager","getSchema","pushChange","RESET","ROOT","then","newCurrentProject","reason","console","error","_","directiveInject","i1","i2","i3","i4","i5","_2","selectors","features","InheritDefinitionFeature","decls","vars","consts","template","AppComponent_Template","rf","ctx","template","AppComponent_ide_ui_main_0_Template","AppComponent_ng_container_1_Template","property","advance","BrowserModule","BrowserAnimationsModule","LayoutModule","EditorModule","RouterModule","MainEditorComponent","HttpClientModule","ListChangesComponent","DevModule","WelcomeModule","WelcomeComponent","BasicModule","FieldsModule","ConfirmationService","RestModule","PluginCommonModule","ReportModule","CommerceModule","appRoutes","path","component","loadChildren","m","ProjectModule","AppModule","bootstrap","_3","imports","forRoot","enableTracing","useHash","declarations","CommonModule","MainComponent","MenuModule","ButtonModule","ToolbarModule","SidebarModule","MenuComponent","TooltipModule","OverlayPanelModule","exports","combineLatest","Subscription","map","text","textInterpolate","ctx_r3","serverUrl","ctx_r1","sessionId","listener","MainComponent_div_0_Template_button_click_4_listener","restoreView","_r6","ctx_r5","nextContext","resetView","sidePanelVisible","MainComponent_div_0_Template_button_click_8_listener","ctx_r7","loadSchema","MainComponent_div_0_Template_button_click_9_listener","ctx_r8","openDevUrl","MainComponent_div_0_Template_button_click_10_listener","ctx_r9","openPreview","MainComponent_div_0_Template_button_mouseenter_11_listener","$event","_r2","reference","show","MainComponent_div_0_ng_template_14_Template","MainComponent_div_0_Template_p_sidebar_visibleChange_16_listener","ctx_r11","ctx_r0","connectedClass","styleMap","pureFunction0","_c0","_c1","subscriptions","context$","add","getUpdates","subscribe","next","newConfig","changed","ideWebSocketUrl","markForCheck","detectChanges","ngOnInit","getConnectionStatus","getSessionId","pipe","status","logoClicked","sidePanelVisibleChanged","target","visible","open","previewUrl","ngOnDestroy","unsubscribe","MainComponent_Template","MainComponent_div_0_Template","pipeBind1","menuItems","Array","label","items","icon","routerLink","MenuComponent_Template","TableModule","ChangeListenService","change_r2","type","position","value","changeService","listOfChanges","getListOfChanges","getChangeEvents","inputs","ListChangesComponent_Template","ListChangesComponent_ng_template_3_Template","ListChangesComponent_ng_template_4_Template","AbstractSchemaItem","DontCodeModelManager","DontCodeSchemaRef","EditorElement","id","schemaItem","schemaPosition","values","childrenToDisplay","allChildren","Map","forceRead","parent","asArray","schemaModel","split","join","createNew","listValues","initialValue","ret","editedValue","getParent","setParent","newParent","isAsArray","isHidden","isReadonly","getItemIdIfExists","EditorElementType","array","substring","lastIndexOf","getChildrenToDisplay","length","readSubSchema","undefined","isObject","isArray","model","mergeStartPosition","mergePosition","cache","children","itemKey","hasOwnProperty","push","getNextId","childModel","getChildren","propKey","forEach","resolveRefs","propName","child","childPosition","schemaChildPosition","newElement","get","isValue","input","isEnum","asEnum","list","getValues","object","setEditedValue","mergeElement","hasActiveProperties","toAddProps","getActiveProperties","propValue","getRelativeId","isReplacementActive","entity","isReference","toFind","getReference","found","goto","calculateRootSchema","childrenKeys","Set","keys","generateNextKey","addSubElement","removeElement","item","index","parentList","splice","upElement","downElement","getEditedValue","newVal","oldValue","props","getProperties","oldProp","delete","isReplace","after","key","i","Error","set","foundAt","alreadyThere","getChild","getChildInHierarchy","beforeAName","propNames","current","ArrayAction","TextHandlerComponent","TextElementComponent","SelectElementComponent","SharedModule","InputElementComponent","SubTextElementComponent","AccordionModule","DropdownModule","InputTextModule","FormsModule","ReactiveFormsModule","AutoCompleteModule","NgForOf","NgIf","Accordion","AccordionTab","PrimeTemplate","ButtonDirective","LocalePipe","i6","LocaleDescPipe","FormControl","control","disabled","updateOn","updateView","valueChanges","onChange","element","setValue","emitModelToViewChange","emitEvent","newValue","UPDATE","InputElementComponent_Template","rootElement","changeListener","textService","unsubscriber","getRootElement","debug","err","change","creation","MainEditorComponent_Template","MainEditorComponent_ide_ui_text_handler_0_Template","EventEmitter","group_r2","textInterpolate1","option_r3","refresh","filteredElements","calculateOptionValue","option","emit","filterGroupedElements","event","filteredGroups","defaultGroup","selectItem","selectedCount","query","toLowerCase","optgroup","getLabel","filter","getValue","outputs","SelectElementComponent_Template","SelectElementComponent_Template_p_autoComplete_completeMethod_3_listener","SelectElementComponent_Template_p_autoComplete_onSelect_3_listener","SelectElementComponent_ng_template_4_Template","SelectElementComponent_ng_template_5_Template","SimpleChanges","SubTextElementComponent_ng_template_6_ng_container_1_ng_container_1_button_5_Template_button_click_0_listener","_r11","ctx_r10","item_r4","$implicit","i_r5","SubTextElementComponent_ng_template_6_ng_container_1_ng_container_1_button_6_Template_button_click_0_listener","_r15","ctx_r14","ctx_r13","SubTextElementComponent_ng_template_6_ng_container_1_ng_container_1_Template_button_click_3_listener","_r18","ctx_r17","addElement","SubTextElementComponent_ng_template_6_ng_container_1_ng_container_1_Template_button_click_4_listener","ctx_r20","ctx_r19","SubTextElementComponent_ng_template_6_ng_container_1_ng_container_1_button_5_Template","SubTextElementComponent_ng_template_6_ng_container_1_ng_container_1_button_6_Template","ctx_r6","SubTextElementComponent_ng_template_6_ng_container_1_ng_container_1_Template","SubTextElementComponent_ng_template_6_ng_container_2_Template_button_click_1_listener","_r23","ctx_r22","SubTextElementComponent_ng_template_6_ng_container_1_Template","SubTextElementComponent_ng_template_6_ng_container_2_Template","removed","DELETE","oldPos","nextElement","nextKey","MOVE","ngOnChanges","changes","NgOnChangesFeature","SubTextElementComponent_Template","SubTextElementComponent_ng_template_5_Template","SubTextElementComponent_ng_template_6_Template","TextElementComponent_Template","element_r1","TextHandlerComponent_ng_container_1_ng_container_1_ide_ui_select_element_6_Template_ide_ui_select_element_refresh_0_listener","_r13","ctx_r12","TextHandlerComponent_ng_container_1_ng_container_1_br_2_Template","TextHandlerComponent_ng_container_1_ng_container_1_ide_ui_text_element_3_Template","TextHandlerComponent_ng_container_1_ng_container_1_ng_container_4_Template","TextHandlerComponent_ng_container_1_ng_container_1_ide_ui_sub_text_element_5_Template","TextHandlerComponent_ng_container_1_ng_container_1_ide_ui_select_element_6_Template","TextHandlerComponent_ng_container_1_ng_container_1_ide_ui_input_element_7_Template","TextHandlerComponent_ng_container_1_ng_container_1_Template","listOfElements","TextHandlerComponent_Template","TextHandlerComponent_ng_container_1_Template","i7","styles","WelcomeComponent_Template","CardModule","BadgeModule","ChangeModule","BroadcastChannel","DontCodeChangeManager","Observable","Subject","changeMgr","changeEmitter","channel","CHANNEL_CHANGE_NAME","log","onmessage","msg","resetEmitter","inject","factory","fac","providedIn","Message","MessageType","webSocket","ReplaySubject","ideServicesWebSocket","connectionStatus","sessionIdSubject","currentSocketUrl","socketChanged","closed","complete","openWebSocket","Promise","resolve","socketUrl","reject","url","closeObserver","openObserver","asObservable","newId","newChange","all","postMessage","updateSocket","CHANGE","socket","LocaleService","locale","transform","args","toText","pure","TypeOfPipe","DontCodeProject","IdeProject","firstValueFrom","throwError","http","projects","projectApiUrl","currentProject","loadListOfProjects","newProjects","placeCurrentProject","findIndex","_id","saveCurrentProject","toSave","getModelManager","getContent","content","put","name","responseType","post","loadProject","prj","setCurrentProject","loadAndSetCurrentProject","getCurrentProject","isCurrentProject","TextModule","texts","APP_TYPE","APP_NAME","APP_ENTITIES","APP_ENTITIES_FROM","APP_ENTITIES_NAME","APP_FIELDS","APP_FIELDS_NAME","APP_FIELDS_TYPE","APP_REPORTS","APP_REPORTS_TITLE","APP_REPORTS_FOR","APP_REPORTS_GROUP","APP_REPORTS_GROUP_OF","APP_REPORTS_GROUP_SHOW","APP_REPORTS_GROUP_LABEL","APP_REPORTS_GROUP_AGGREGATE","APP_REPORTS_GROUP_AGGREGATE_OPERATION","APP_REPORTS_GROUP_AGGREGATE_OF","APP_REPORTS_GROUP_AGGREGATE_LABEL","APP_REPORTS_SORT","APP_REPORTS_SORT_BY","APP_REPORTS_SORT_DIRECTION","APP_REPORTS_DISPLAY","APP_REPORTS_DISPLAY_TYPE","APP_REPORTS_DISPLAY_OF","APP_REPORTS_DISPLAY_BY","APP_REPORTS_DISPLAY_TITLE","APP_SHARING","APP_SHARING_WITH","APP_SOURCES","APP_SOURCES_NAME","APP_SOURCES_TYPE","APP_SOURCES_URL","APP_SCREENS","APP_SCREENS_NAME","APP_SCREENS_LAYOUT","APP_COMPONENTS","APP_COMPONENTS_TYPE","APP_COMPONENTS_ENTITY","context","DontCodeSchemaItem","jsonSchema","schemaAsJson","rootSchema","production","enableProdMode","__NgCli_bootstrap_1","platformBrowser","bootstrapModule","catch","relativeId","readOnly","hidden","setArray","val","isRoot","setHidden","setReadonly","generateItem","json","itemId","DontCodeSchemaObject","DontCodeSchemaValue","DontCodeSchemaEnum","to","upsertWith","entries","updateWith","update","allProperties","code","hasProperties","setRelativeId","getTargetPath","targetPath","setTargetPath","newPath","isPossibleDynamicProperty","childProps","childProp","getAllPossibleDynamicProperties","childChildProp","has","warn","getChildrenAndPossibleProperties","concatIterable","iterators","Symbol","iterator","f","done","readJson","existsOrNot","exists","newMap","DontCodeSchemaRoot","$defs","properties","updateValues","destination","from","find","dest","DontCodeSchemaEnumValue","DontCodeSchemaProperty","isEmpty","subKey","enumValue","setChildren","enum","_children","_value","_label","setLabel","getType","resolvedRef","resolveReference","resolved","replace","posAfter","size","getPosAfter","APP_NAME_NODE","APP_TYPE_NODE","APP_ENTITIES_NODE","APP_ENTITIES_FROM_NODE","APP_ENTITIES_NAME_NODE","APP_FIELDS_NODE","APP_FIELDS_NAME_NODE","APP_FIELDS_TYPE_NODE","APP_SHARING_NODE","APP_SHARING_WITH_NODE","APP_REPORTS_NODE","APP_REPORTS_TITLE_NODE","APP_REPORTS_FOR_NODE","APP_REPORTS_GROUP_NODE","APP_REPORTS_SORT_NODE","APP_REPORTS_DISPLAY_NODE","APP_REPORTS_GROUP_LABEL_NODE","APP_REPORTS_GROUP_OF_NODE","APP_REPORTS_GROUP_SHOW_NODE","APP_REPORTS_GROUP_AGGREGATE_NODE","APP_REPORTS_GROUP_AGGREGATE_LABEL_NODE","APP_REPORTS_GROUP_AGGREGATE_OPERATION_NODE","APP_REPORTS_GROUP_AGGREGATE_OF_NODE","APP_REPORTS_SORT_BY_NODE","APP_REPORTS_SORT_DIRECTION_NODE","APP_REPORTS_DISPLAY_TITLE_NODE","APP_REPORTS_DISPLAY_TYPE_NODE","APP_REPORTS_DISPLAY_OF_NODE","APP_REPORTS_DISPLAY_BY_NODE","APP_SOURCES_NODE","APP_SOURCES_NAME_NODE","APP_SOURCES_TYPE_NODE","APP_SOURCES_URL_NODE","APP_SCREENS_NODE","APP_SCREENS_NAME_NODE","APP_SCREENS_LAYOUT_NODE","APP_COMPONENTS_NODE","APP_COMPONENTS_TYPE_NODE","APP_COMPONENTS_ENTITY_NODE","DontCodeSchema","defaultv1","DontCodeModelPointer","containerPosition","containerSchemaPosition","lastElement","isProperty","positionInSchema","containerPositionInSchema","fillMissingElements","optionalSchemaMgr","_a","parentPosition","_b","_c","lastElementOf","locateItem","nextItemAndPosition","posSlash","pos","calculateKeyOrContainer","calculateItemIdOrContainer","isSubItemOf","pointer","isUnderSubItemOf","startsWith","keyPos","subItemOrPropertyPointer","subElement","isItem","subPropertyPointer","subItemPointer","subProp","newPointer","subItem","safeParentPointer","parentPointer","isParentOf","directOnly","lastSlash","splitPosition","DontCodeSchemaManager","reset","currentSchema","convertSchemaToMap","registerChanges","plugin","version","updates","cur","generateParentPointer","generateSchemaPointer","queriedPosition","posElems","parentItem","ignoreNext","nextItem","generateSubSchemaPointer","propOrItemName","DontCodePluginManager","plugins","registerPlugin","schemaManager","previewManager","getConfiguration","fullId","registerHandlers","PluginInfo","initPlugins","core","initCalled","defs","getChangeManager","applyPluginConfigUpdates","pluginInit","clear","DontCodePreviewManager","handlersPerLocations","globalHandlersPerLocations","actionHandlersPerLocation","globalHandlers","getGlobalHandlers","receiveGlobalHandlers","retrieveHandlerConfig","modelContent","contentNeeded","configuration","jsonValue","extractValuesAsArray","targetValue","endsWith","parentValue","retrieveActionHandlers","extractValuesToArray","res","DontCodeReportGroupShowType","DontCodeGroupOperationType","DontCodeSortDirectionType","ActionContextType","ActionType","DontCodeStoreManager","modelMgr","provider","providerByPosition","providerByType","_default","getProvider","srcDefinition","findTargetOfProperty","getProviderSafe","getDefaultProvider","getDefaultProviderSafe","setProvider","setProviderForSourceType","srcType","setDefaultProvider","removeProvider","removeProviderForSourceType","removeDefaultProvider","storeEntity","loadEntity","safeLoadEntity","deleteEntity","searchEntities","criteria","searchAndPrepareEntities","sort","groupBy","dataTransformer","canStoreDocument","storeDocuments","toStore","DontCodeStoreCriteriaOperator","DontCodeStoreCriteria","operator","EQUALS","DontCodeStoreSort","by","direction","subSort","None","DontCodeStoreGroupby","of","display","atLeastOneGroupIsRequested","Object","getRequiredListOfFields","aggregate","DontCodeStoreAggregate","operation","beforeKey","oldPosition","getSafeParentPosition","getParentPosition","Action","actionType","running","changeType","ACTION","schemaMgr","resetContent","newContent","$hidden","$readOnly","applyChange","toApply","subElem","atomicChanges","AtomicChange","lastChange","findAtPosition","basePosition","subChanges","isAnUpdate","applyChangeRecursive","generateChanges","srcChange","oldContent","oldSubContent","curAtomicChange","createSubChange","compareRecursiveIfNeeded","ADD","isTheSameForParent","subProperty","getOwnPropertyNames","insertProperty","splittedPosition","parentContent","oldKeys","newKeys","every","src","alreadyChecked","oldSubProperty","subPointer","subPosition","srcAction","newSubProperty","result","generateNextKeyForPosition","create","tentative","modulo","POSSIBLE_CHARS_FOR_ARRAY_KEYS_LENGTH","quotient","Math","trunc","rest","POSSIBLE_CHARS_FOR_ARRAY_KEYS","concat","added","currentPath","queryModelToArray","root","JSONPath","resultType","wrap","flatten","queryModelToSingle","parentProperty","findAllPossibleTargetsOfProperty","property","ptr","lastDotPos","filteredQuery","beforeProp","copy","convertToChange","definition","guessNamePropertyOfElement","modelAsJson","fields","curScore","score","field","scoreFieldAsName","guessNamePropertyOfObject","obj","prop","guessNamePropertyFromList","NAME_PROPERTY_NAMES","foundScore","includes","extractValue","metaData","parsed","extractMetaData","direct","subValue","subValues","applyValue","valueObj","curObj","curValueObj","valueProp","structuredClone","sortValues","sortOrder","metaInfo","DataTransformationInfo","extractField","first","second","firstValue","secondValue","localeCompare","Date","amount","cost","firstKey","modifyValues","firstElement","secondElement","calculatedValue","elementName","ModelQuerySingleResult","modelManager","listeners","listenerCachePerPosition","receivedChanges","isInterestedIn","onlyLevel","nextPosition","createNewListener","clearEmptyListeners","observed","cleanedPosition","cleanPosition","existing","chg","addToListenerCache","who","interesteds","getJsonAt","manageChangeInternally","subChange","otherRet","calculatePointerFor","findAndNotify","alreadyCalled","affected","subject","canCall","positions","receiveCommands","close","toRemove","listener","remove","DontCodeCore","pluginManager","changeManager","storeManager","getSchemaUri","getPreviewManager","getStoreManager","self","MoneyAmount","AbstractActionHandler","performAction","action","performSynchronousAction","valueOf","StoreProviderHelper","clearConfigCache","specialFieldsCache","applyFilters","criterium","toTest","LESS_THAN","LESS_THAN_EQUAL","findSpecialFields","specialFields","SpecialFields","addDateField","scoreIdFieldFromEntityField","idField","findSpecialFieldsFromData","data","existingFields","scoreIdFieldFromProperty","test","floor","cleanUpDataBeforeSaving","listToConvert","cleanUpLoadedData","dateFields","toConvert","timeEpoch","parse","isNaN","tzDescIndex","multiSortArray","toSort","sortOptions","calculateGroupedByValues","fieldToGroupBy","counters","lastGroupDelimiter","oneGroupOfCounters","fieldsRequired","storedGroupOfCounters","counter","Counters","valSrc","sum","minimum","minAsValue","minValue","maximum","maxAsValue","maxValue","count","getTime","DontCodeStoreGroupedByEntities","groupKey","group","Count","Sum","Average","Minimum","Maximum","listOfValues","DontCodeStoreGroupedByValues","DontCodeStorePreparedEntities","sortedData","sortInfo","groupedByEntities","groupInfo","forAggregate","AbstractDontCodeStoreProvider","listEntities","transformer","postLoadingTransformation","groupedByValues","calculateSortHierarchy","rootSort","DontCodeTestManager","createDeleteChange","containerSchema","containerItemId","schema","createAnyChange","createMoveChange","beforeIdOrProperty","createTestChange","addDummyProviderFromContent","toReturn","DummyStoreProvider","waitUntilTrue","tester","interval","maxTry","waitUntilTrueAndEmit","ok","timer","take","defaultValue","calcContainerItemId","calcItemId","calcSchema","calcProperty","calcPropertySchemaItem","calcPropertySchema","TestProviderInterface","toRet","lastItem","sendCommand","description","Inject","Injectable","Optional","DONT_CODE_COMMON_CONFIG","getConfig","updateConfig","batchUpdateConfig","newValues","assign","InjectionToken","SANDBOX_MENUS","createNgModule","getNgModuleById","COMMAND_PROVIDER","Mutex","ComponentLoaderService","previewMgr","moduleMap","mutex","getOrCreatePluginModuleRef","moduleSource","acquire","release","moduleRef","loadPluginModule","handlerConfig","class","source","insertComponentForFieldType","insertPoint","insertComponent","currentJson","schemaPos","isPointer","componentClass","instance","exposedPreviewHandlers","createComponent","componentRef","ngModuleRef","initCommandFlow","registerModuleForTest","module","PluginHandlerHelper","AbstractPluginHandler","pluginHelper","entityPointer","initChangeListening","decomposeJsonToMultipleChanges","applyUpdatesToArray","targetMap","applyProperty","applyUpdatesToArrayAsync","catchError","takeLast","changeHandler","actionPerformer","propType","handleChange","initOtherChangeListening","runExclusive","propertyId","futureTarget","newTarget","targetPos","fullValue","_this","_asyncToGenerator","EntityStoreService","storeMgr","listsByPosition","retrieveListManager","newOne","EntityListManager","entities","prepared","updateWithDetailedEntity","elementId","updated","valueId","deleted","message","store","storeAllChanged","loadAll","sortStore","groupByStore","sortedValues","groupedValues","loadDetailFromKey","loaded","loadDetailOf","toLoad","Component","AbstractDynamicComponent","setName","form","updateValueFromForm","hydrateValueToForm","setParentPosition","setForm","createAndRegisterFormControls","getForm","registerControl","transformToFormGroupValue","transformFromFormGroupValue","formValue","dirty","markAsPristine","onlySelf","toBeautifyString","maxLength","toLocaleDateString","JSON","stringify","toLocaleString","listEventSources","selectEventSourceFor","sources","AbstractDynamicComponent_Template","encapsulation","Directive","ViewChild","ViewContainerRef","FormGroup","DynamicInsertPoint","selector","AbstractDynamicLoaderComponent","loader","fieldsMap","parentForm","componentInited","defineSubField","propertyAndFormName","newSubField","SubFieldInfo","addSubField","getSubField","toAdd","getSubFields","formGroup","preloadSubFields","controls","isChanged","setSubFieldValue","subFieldValue","getSubFieldValue","subFieldFullEditTemplate","subField","subInfo","providesTemplates","forFullEdit","subFieldInlineViewTemplate","forInlineView","subFieldFullViewTemplate","forFullView","loadSubField","dynamicInsertPoint","prepareComponent","singleVal","updatedValue","patchValue","loadSubComponent","formName","applyComponentToSubField","info","ngAfterViewInit","detectCheckDone","valueSafe","viewQuery","AbstractDynamicLoaderComponent_Query","_t","read","static","comp","ChangeDetectionStrategy","Output","PossibleTemplateList","TemplateList","BaseDynamicEvent","BaseDynamicEventSource","DynamicEventType","AbstractReferenceComponent_ng_template_0_Template","AbstractReferenceComponent_ng_template_2_ng_container_0_ng_template_2_div_0_Template","AbstractReferenceComponent_ng_template_2_ng_container_0_ng_template_2_Template","AbstractReferenceComponent_ng_template_2_ng_container_0_ng_template_3_Template","reference_r8","AbstractReferenceComponent_ng_template_2_ng_container_0_Template","_r10","valueChanged","ctx_r4","AbstractReferenceComponent_ng_template_2_Template","AbstractReferenceComponent","valueChange","targetEntitiesPos","targetEntitiesProperty","options","canProvide","inlineView","fullEditView","setTargetEntitiesWithName","entityName","propertyName","queryResult","possibleValues","models","loadedModels","VALUE_CHANGE","toString","AbstractReferenceComponent_Query","dependencies","Dropdown","NgControlStatus","NgControlStatusGroup","FormGroupDirective","FormControlName","changeDetection","OnPush","eventSource","Pipe","PluginBaseComponent","BeautifierPipe","Validators","updateValueOnFormChanges","decodeStringField","updateSubFieldsWithChange","elt","updatedFields","rebuildForm","formKey","required","removeControl","ValueService","NgModule","ngModule","providers","provide","useValue","subscription","DontCodeRuntimeConfig","observe","documentApiUrl","storeApiUrl","webSocketUrl","LightAppComponent_Template","runtime","forceRepositoryLoading","PriceComponent","CommercePlugin","PriceCompareComponent","ShopHandlerComponent","RippleModule","ProductSelectionComponent","DataViewModule","ShopTypeHandlerComponent","MessageModule","MessagesModule","Commerce","dontCode","SHOP_ENTITY_NAME","AbstractOnlineShopScrapper","PriceComponent_ng_template_1_ng_container_0_ng_container_2_ng_container_2_Template","PriceComponent_ng_template_1_ng_container_0_ng_container_2_Template","PriceComponent_ng_template_1_ng_container_0_ng_container_3_ng_container_1_Template","PriceComponent_ng_template_1_ng_container_0_ng_container_3_Template","PriceComponent_ng_template_1_ng_container_0_Template","PriceComponent_ng_template_1_Template","PriceComponent_ng_template_3_button_0_Template","PriceComponent_ng_template_3_ng_container_1_Template","PriceComponent_ng_template_3_Template","PriceComponent_ng_template_5_ng_container_0_ng_container_8_Template","PriceComponent_ng_template_5_ng_container_0_button_11_Template","PriceComponent_ng_template_5_ng_container_0_ng_container_15_Template","PriceComponent_ng_template_5_ng_container_0_ng_container_18_Template","PriceComponent_ng_template_5_ng_container_0_ng_container_24_Template","PriceComponent_ng_template_5_ng_container_0_ng_container_25_ng_template_2_a_1_Template","PriceComponent_ng_template_5_ng_container_0_ng_container_25_ng_template_2_Template","ctx_r21","PriceComponent_ng_template_5_ng_container_0_ng_container_25_Template","PriceComponent_ng_template_5_ng_container_0_ng_container_26_Template","_r24","ctx_r23","selectedProduct","PriceComponent_ng_template_5_ng_container_0_Template","_r26","ctx_r25","productNameChanged","ctx_r27","updatePrice","cannotUpdatePrice","PriceComponent_ng_template_5_Template","priceFinder","updatePriceIcon","baseUpdatePriceIcons","parsingError","productSelectionMode","productNameLinked","listOfSelectableProducts","enableProductNameLookup","shop","nameInShop","idInShop","searchProducts","translateToError","findPrice","newPrice","inError","product","productId","toMoneyAmount","productUrl","priceDate","urlInShop","clearProduct","parentNameControl","guessProductParentComponent","nameInShopControl","nameProp","statusText","_this2","EXTRACT","updatePriceIfPossible","isInError","errorMessage","PriceFinderService","PriceComponent_Query","NgTemplateOutlet","DefaultValueAccessor","InputText","Ripple","i8","i9","Tooltip","i10","Messages","i11","ShopHandlerComponent_ng_template_0_Template","ShopHandlerComponent_ng_template_2_ng_container_0_ng_template_2_div_0_Template","ShopHandlerComponent_ng_template_2_ng_container_0_ng_template_2_Template","ShopHandlerComponent_ng_template_2_ng_container_0_ng_template_3_Template","ShopHandlerComponent_ng_template_2_ng_container_0_Template","ShopHandlerComponent_ng_template_2_Template","controlKey","ShopTypeHandlerComponent_ng_template_2_ng_container_0_Template","ShopTypeHandlerComponent_ng_template_2_Template","shopTypes","getListOfShopTypes","displayableValue","ShopTypeHandlerComponent_Query","DynamicProxyScrapper","searchProductsForNameOrId","nameOrId","isId","callUrlWithProxy","engine","proxyEngine","requestWithProxy","HttpHeaders","ScrappedProduct","productName","outOfStock","scrappedProduct","productPrice","currencyCode","onlineShopName","getOnlineShopName","getShopTypeName","method","request","encodeUrlForCors","updateOptionsForCors","ProxyEngine","CORSPROXY_IO","CORS_PROXY_URL","encodeURIComponent","CORSPROXY_ORG","CORS_PROXY_ORG_URL","CHROME_ENGINE","DONT_CODE","CORS_DONTCODE_PROXY_URL","WEBSCRAPING_IA","WEBSCRAPING_PROXY_URL","withCredentials","addToHttpParams","proxy","js","api_key","WEBSCRAPING_PROXY_API_KEY","prod","useProductName","productToFind","listOfAllElements","standardHeaders","checkScrappedProduct","productSearch","checkStringPosition","itemPos","limitPos","htmlResult","startPos","endIndex","safeIndexOf","params","appendAll","AmazonScrapper","SEARCH_ONLINE_URL","headers","Accept","completeHtml","PRODUCT_START_STRING","endPos","newProduct","middlePos","charAt","urlPos","BASE_URL","productImageUrl","productDescription","extractPrice","price","Number","parseFloat","BoulangerScrapper","normalize","analysePageResult","CDiscountScrapper","nextStartPos","commaPos","parseInt","cents","DartyScrapper","httpHeaders","postContent","JSON_QUERY","body","jsonResult","results","hits","aResult","reference","codic","pictures","BASE_IMAGE_URL","algoliaPict","response","priceSort","dartyExclusivePriceSort","prices","stores","EasyParaScrapper","EUR","default","short_description","ean_code","objectID","image_url","FnacScrapper","words","encodedName","word","marketPlace","supIndex","GreenWeezScrapper","shop_data","pricing","priceIncludedVat","variant","calculateProductUrl","findImageUrl","images","flags","shopData","slug","image","MaxicoffeeScrapper","p","prcn","ttl","lnk","img","avl","NewPharmaScrapper","startPricePos","OnateraScrapper","is_active","brand_name","variants","hasStock","shortDescription","productVariantId","IMAGE_BASE_URL","picture_path","WebEcologieScrapper","startWishlistPos","listOfScrappers","shopTypeNames","addScrapper","newScrapper","shopName","scrapper","getShopTypeNameOf","productValue","priceField","findProductId","lastCheckDate","findProductName","_this3","DONT_UPDATE_UNTIL_DELAY_MS","Type","Input","ctx_r2","notFound","ProductSelectionComponent_ng_template_2_ng_template_2_img_0_Template","product_r4","ProductSelectionComponent_ng_template_2_ng_template_2_Template","ProductSelectionComponent_ng_template_2_ng_template_9_Template","_r12","selectionOf","ProductSelectionComponent_ng_template_2_Template","listOfProducts","selected","localizedAmount","Intl","NumberFormat","globalThis","navigator","language","style","currency","format","ProductSelectionComponent_Template","DataView","Card","_adapters","Chart","StdDateAdapter","autocolorPlugin","ReportPlugin","register","_date","override","chartJsStandardAdapter","CrossDataTransformer","affectedColumns","groupType","entityPosition","fieldMapping","calculateFieldMapping","metadataPerField","srcItem","newItem","calculateRelevantColumn","column","fieldsPosition","metadata","fieldId","valueField","OnlyLowest","entityDesc","GraphDataTransformer","graphConfig","targetType","setConfig","setTargetType","newType","translatedGraphType","changeGraphType","dataObservable","optionObservable","updateSourceData","srcData","isAmount","byDate","labels","isBiDirectional","xFieldName","labelFieldName","translateDateValue","posLabel","x","y","chartData","datasets","chartOption","align","text","scales","autocolors","mode","offset","tooltip","callbacks","raw","barChartConfig","pieChartConfig","dataSet","hoverOffset","lineChartConfig","setLabelFieldName","fieldName","eltElement","TemplateRef","ReportDisplayComponent_ng_template_0_ng_container_1_Template","ReportDisplayComponent_ng_template_0_Template","ReportDisplayComponent","graphModelPointer","chartData$","chartOption$","fullView","reportPosition","entityNamePropertyName","ReportDisplayComponent_Query","UIChart","AsyncPipe","a0","fieldType","ReportEntityComponent_div_4_div_1_Template","field_r3","ReportEntityComponent_div_4_div_2_ng_container_1_Template","ReportEntityComponent_div_4_div_2_Template","ReportEntityComponent_div_4_Template","ReportEntityComponent_ng_template_5_Template","type_r10","ReportEntityComponent","entityService","valueService","dataLoading","reportDescription","reportEntityData","targetEntityPointer","fieldTypeTransformer","initTargetEntity","targetInfo","loadTargetEntities","calculateTransformer","sortedBy","groupedBy","updateSubFieldsValues","defaultTemplate","groupByColumn","columnNames","ReportEntityComponent_Query","col_r8","ReportTableComponent_ng_template_1_ng_template_1_Template","columns_r6","ReportTableComponent_ng_template_1_ng_template_2_td_1_ng_container_1_ng_container_1_Template","ReportTableComponent_ng_template_1_ng_template_2_td_1_ng_container_1_Template","col_r12","ReportTableComponent_ng_template_1_ng_template_2_td_1_ng_container_2_Template","ReportTableComponent_ng_template_1_ng_template_2_td_1_Template","ReportTableComponent_ng_template_1_ng_template_2_Template","columns_r10","columns","ReportTableComponent_ng_template_1_ng_template_3_tr_0_Template","ReportTableComponent_ng_template_1_ng_template_3_Template","ReportTableComponent_ng_template_1_ng_template_4_tr_0_td_1_ng_container_1_ng_container_1_ng_container_3_Template","ReportTableComponent_ng_template_1_ng_template_4_tr_0_td_1_ng_container_1_ng_container_1_Template","value_r30","ReportTableComponent_ng_template_1_ng_template_4_tr_0_td_1_ng_container_1_ng_container_2_Template","ReportTableComponent_ng_template_1_ng_template_4_tr_0_td_1_ng_container_1_Template","col_r28","ReportTableComponent_ng_template_1_ng_template_4_tr_0_td_1_Template","rowData_r24","ReportTableComponent_ng_template_1_ng_template_4_tr_0_Template","columns_r25","ReportTableComponent_ng_template_1_ng_template_4_Template","ReportTableComponent_ng_template_1_Template","cols","groupRowsBy","ReportTableComponent","colsMap","reportPointer","cleanedTableData","groupedValuesByField","templateOf","col","calculateGroupedValuesByField","PrimeColumn","updatedColumns","groupDelimiter","retrieveGroupedByValuesFor","groupingValue","isTemplate","areGroupsDefined","ReportTableComponent_Query","Table","SortableColumn","RowGroupHeader","SortIcon","header","ChartModule","RestPlugin","lastValueFrom","RestStoreProvider","loadUrl","targetUrl","URL","pathname","wrongUrl","obs","SourceHandler","BasicPlugin","BasicEntityComponent","ListEntityComponent","EditEntityComponent","TabViewModule","CheckboxModule","InputNumberModule","BasicFieldsComponent","DontCodeApiStoreProvider","TimeFieldsComponent","WebFieldsComponent","CalendarModule","FileUploadModule","ConfirmDialogModule","InputTextareaModule","FieldsPlugin","Social","International","Money","CountryComponent","CurrencyComponent","EuroDollarComponent","MoneyComponent","RatingComponent","RatingModule","i18nCountries","countryDataEn","CountryComponent_ng_template_0_Template","CountryComponent_ng_template_2_ng_template_2_div_0_Template","CountryComponent_ng_template_2_ng_template_2_Template","CountryComponent_ng_template_2_ng_template_3_Template","country_r7","CountryComponent_ng_template_2_Template","countries","registerLocale","alpha2","getAlpha2Codes","getName","alpha2code","t","CountryComponent_Query","NgClass","country","CurrencyComponent_ng_template_0_Template","CurrencyComponent_ng_template_2_ng_container_0_ng_template_2_div_0_Template","CurrencyComponent_ng_template_2_ng_container_0_ng_template_2_Template","CurrencyComponent_ng_template_2_ng_container_0_ng_template_3_Template","currency_r8","CurrencyComponent_ng_template_2_ng_container_0_Template","CurrencyComponent_ng_template_2_Template","currencies","currencySet","countryCurrencyList","currency_code","a","b","CurrencyComponent_Query","newEntity","refreshScreen","saveEntity","BasicEntityComponent_ng_template_10_Template","_r8","componentLoader","canSave","tabIndex","refreshIcon","baseRefreshIcons","edit","dataIsLoaded","e","selectChange","selectedItem","_this4","LIST","BasicEntityComponent_Query","BasicEntityComponent_Template_dontcode_list_entity_selectedItemChange_6_listener","tmp_2_0","TabView","TabPanel","Toolbar","EditEntityComponent_ng_container_1_div_2_Template","field_r4","EditEntityComponent_ng_container_1_Template","EditEntityComponent_ng_template_2_ng_container_1_Template","name_r6","EditEntityComponent_ng_template_2_ng_template_2_Template","EditEntityComponent_ng_template_2_Template","fb","isShortText","FormBuilder","EditEntityComponent_Query","NgNoValidate","InputTextarea","ListEntityComponent_ng_template_2_th_1_Template","col_r4","ListEntityComponent_ng_template_2_Template","columns_r2","ListEntityComponent_ng_template_3_td_1_ng_container_1_ng_container_1_Template","ListEntityComponent_ng_template_3_td_1_ng_container_1_Template","ListEntityComponent_ng_template_3_td_1_ng_container_2_Template","ListEntityComponent_ng_template_3_td_1_Template","ListEntityComponent_ng_template_3_Template","rowData_r5","selectedItemChange","selectionChange","colInfo","retrieveColumnInfo","colName","getStoreEntities","row","colPos","entry","customSort","order","ListEntityComponent_Template_p_table_selectionChange_1_listener","ListEntityComponent_Template_p_table_sortFunction_1_listener","SelectableRow","BasicFieldsComponent_ng_template_2_Template","BasicFieldsComponent_ng_template_4_Template","BasicFieldsComponent_ng_template_6_Template","isJson","numericTemplate","listCheckTemplate","checkTemplate","inputTemplate","BasicFieldsComponent_Query","Checkbox","NgModel","InputNumber","EuroDollarComponent_ng_template_0_span_0_Template","EuroDollarComponent_ng_template_0_Template","EuroDollarComponent_ng_template_2_ng_container_0_p_inputNumber_1_Template","EuroDollarComponent_ng_template_2_ng_container_0_Template","EuroDollarComponent_ng_template_2_Template","converter","updateConverter","EuroDollarComponent_Query","MoneyComponent_ng_template_1_span_0_Template","MoneyComponent_ng_template_1_Template","MoneyComponent_ng_template_3_ng_container_0_ng_container_5_Template","MoneyComponent_ng_template_3_ng_container_0_Template","MoneyComponent_ng_template_3_Template","loaderService","getAmountSafe","MoneyComponent_Query","RatingComponent_ng_template_0_p_rating_0_Template","RatingComponent_ng_template_0_Template","RatingComponent_ng_template_2_ng_container_0_Template","RatingComponent_ng_template_2_Template","RatingComponent_Query","Rating","dateSelected","TimeFieldsComponent_ng_template_2_Template","TimeFieldsComponent_ng_template_4_Template","_r17","ctx_r16","TimeFieldsComponent_ng_template_6_Template","TimeFieldsComponent_ng_template_8_Template","TimeFieldsComponent_ng_template_10_Template","longConverter","DateTimeFormat","weekday","day","month","year","hour","minute","timeZoneName","shortConverter","updateConverters","readDateTemplate","editDateTemplate","readDateTimeTemplate","editDateTimeTemplate","readTimeTemplate","editTimeTemplate","localizeLongDate","localizeShortDate","markAsDirty","TimeFieldsComponent_Query","Calendar","FileUpload","WebFieldsComponent_ng_template_3_p_fileUpload_3_Template","uploadImage","WebFieldsComponent_ng_template_3_Template","WebFieldsComponent_ng_template_5_Template","WebFieldsComponent_ng_template_7_Template","confirm","readUrlTemplate","editUrlTemplate","readImageTemplate","editImageTemplate","calculateUrl","supportsImageUpload","files","documentId","fileUpload","WebFieldsComponent_Query","ConfirmDialog","mergeAll","apiUrl","docUrl","updatedConfig","toPromise","myFormData","FormData","append","file"],"sourceRoot":"webpack:///","x_google_ignoreList":[42]}